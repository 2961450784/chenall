title: "一键GHOST备份恢复,GHOST安装器设计新思路"
id: 84
date: 2009-08-13 09:41:01
tags: 
- GHOST
- GRUB4DOS
- 还原
categories: 
- 程序设计/综合
---

看起来可能有点乱^_^.实现起来也是挺麻烦的,暂时只是我的一个想法,仅供有兴趣的朋友研究尝试.放在这里做个记录,以后有兴趣再搞个成品.

## 最终的理想效果.
  * 安装/卸载/使用方便简单,(只需改名复制或删除文件就可以了)
  * 进入DOS时无需再加载NTFS等驱动,也不需要查找操作,直接就开始备份或恢复.
  * 完全自定义,或模块化.

## 思路:
  * 首先,启动过程.
    目前网络上的一键还原软件,大都是基于`GRUB4DOS`的,通过在`BOOT.INI`中添加相应菜单项或直接加入到MBR中来启动的.需要修改  
    我的思路是:  
	1. 直接把`GRUB4DOS`的`GRLDR`改名为`NTLDR`放在系统盘代替系统的`NTLDR`来启动.原来的`NTLDR`可以改名为`NTLDR.LDR`或其它名子.(VISTA以上的系统可以改为BOOTMGR),这样的安装方式的优点,安装时不需要做许多修改就可以用,只需把原来的系统启动文件改名,然后用定制的GRLDR代替就好了.
	2. 由`GRUB4DO`S接管系统的启动,然后根据某些标记(某个文件的内容)来自动选择是启动到系统还是进入备份还原操作.
	3. 当然了还可以在启动时通过按某个按键进入恢复备份操作.

  * 执行过程.
	通过在WINDOWS界面下选择备份或恢复操作(把这些操作存在一个特定的文件中)
	启动时通过GRUB4DOS的DD功能把这个文件的内容转到启动IMG里面.
	启动IMG执行定义的操作.

  * 基本文件内容
```
GHOST.ZIP        GHOST主程序文件(方便自定义,由GRUB4DOS启动时自动载入到上面的IMG中)
ADDINS.ZIP        扩展文件,自定义的扩展文件,同样自动载入到上面的IMG中.
config.INI        配置文件,里面定义了所有的操作.同样由GRUB4DOS动态加入到主IMG中.
```

一个主IMG文件(里面只包含启动基本的文件,其它的文件通过GRUB4DOS动态加入)
 
img自动装载以上文件,然后根据config.ini的内容直接进行备份或恢复操作.

## 成品参考:

  [QGHO 快速一键恢复程序](/post/qgho/ "QGHO一键恢复程序")  
  [基于GRUB4DOS的硬盘工具箱](/post/g4d_hd_tools/)  
  [MODBOOT](/post/modboot/ "一个模块化的DOS工具箱")  
  