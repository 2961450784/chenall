<!DOCTYPE HTML>
<html><head>
<meta http-equiv="Cache-Control" content="max-age=7200" />

<!--addons at start of head-->
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>第 13 页 | chenall&#39;s Blog</title>
<meta name="author" content="chenall">

<meta name="description" content="chenall 的搏客,技术,分享,开源.">


<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta property="og:site_name" content="chenall&#39;s Blog"/>

<!--[if IE]><style>.testIE.IE{display:inline;}</style><![endif]-->
<!--[if lte IE 7]><link rel="stylesheet" href="/css/ie7.css" type="text/css">
<![endif]-->
<!--[if (lt IE 9)&(gt IE 7)]><style>.testIE.IE8{display:inline;}</style><![endif]-->
<!--[if gt IE 8]><style>.testIE.IE9{display:inline;}</style><![endif]-->

<link rel="author" href="https://plus.google.com/100700322385676715564" />
<link href="/favicon.png" rel="icon">
<link rel="alternate" href="/atom.xml" title="chenall&#39;s Blog Feed" type="application/atom+xml">

<link rel="stylesheet" href="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/css/bootstrap.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/font-awesome/4.0.3/css/font-awesome.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/prettify/r298/prettify.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" type="text/css">

<link rel="stylesheet" href="/css/style.css" type="text/css">

<!--[if lt IE 9]>
   <style>article,aside,dialog,footer,header,section,footer,nav,figure,menu{display:block}</style>
   <script src="http://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
   <script src="http://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
<link href="http://cdn.staticfile.org/respond.js/1.4.2/respond-proxy.html" id="respond-proxy" rel="respond-proxy" />
<link href="/js/respond.proxy.gif" id="respond-redirect" rel="respond-redirect" />
<script src="/js/respond.proxy.js"></script>
   <script src="http://cdn.bootcss.com/selectivizr/1.0.2/selectivizr-min.js"></script>
<![endif]-->
<script type="text/javascript">var site = {BASE_URI: '/'};var _js2load = [];</script>

<!--addons at end of head-->
</head>
<body>
  <!--addons at start of body-->
    <header id="header" class="container"><nav id="main-nav" class="navbar navbar-default navbar-fixed-top " role="navigation">
  <div class="container">
    <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="/">chenall's Blog</a>
    </div>
    <div class="collapse navbar-collapse">
      <ul class="nav navbar-nav dropdown-hover">
  
        <li item='page/13/' ><a href="/about/" title="关于">关于</a></li>      
        <li item='page/13/' ><a href="/archives/" title="归档">归档</a></li>      
        <li item='page/13/' ><a href="/qzgb-fm/" title="泉州广播">泉州广播</a></li>      
      <li class='dropdown'>
        <a class='dropdown-toggle' data-toggle='dropdown' href='#'>在线电视<b class='caret'></b></a>
        <ul class='dropdown-menu'>
    
          <li><a href="/tv/" title="在线直播">在线直播</a></li>    
          <li><a href="http://tv1.chenall.tk" title="直播线路1">直播线路1</a></li>    
          <li><a href="http://tv2.chenall.tk" title="直播线路2">直播线路2</a></li>    
        </ul>
      </li>
    
        <li item='page/13/' ><a href="/guestbook/" title="留言板">留言板</a></li>      
        <li item='page/13/' ><a href="http://grub4dos.chenall.net" title="GRUB4DOS">GRUB4DOS</a></li>      
        <li item='page/13/' ><a href="http://almrun.chenall.net" title="ALMRUN">ALMRUN</a></li>      
      </ul>
      <ul class="nav navbar-nav navbar-right">
      
        <li><a href="/atom.xml">RSS</a></li>
      
      
        <li><a href="https://twitter.com/chenall">twitter</a></li>
      
      
      
      
        <li><a href="https://github.com/chenall">github</a></li>
      
      </ul>
    </div>
  </div>
</nav>
<div class="clearfix"></div></header>
  <div id='content' class="container">
     <div class="page-header-wrapper">
      <!--[if lt IE 9]><div class="alert alert-warning alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button><strong>提示:</strong>您的浏览器版本太低了,建议升级到 <strong><a href="http://windows.microsoft.com/zh-cn/internet-explorer/download-ie" title="IE9">IE9</a></strong> 以上,本站使用<a href="https://www.google.com/intl/zh-CN/chrome/">Chrome浏览器</a>可以获得最好的显示效果.</div><![endif]-->
      <div class="page-header"><h1>chenall's Blog <small>走自己的路,让别人说去吧</small></h1></div>
     </div>
     <div class="row">
       <div id="main-col" class="alignleft col-sx-12 col-sm-8 col-md-9 col-lg-9">
      <section id='header_widget'></section>
          <div id="wrapper"><article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/post/aspfunc/">ASP函数语法速查表</a></h1>
      
        <span>发表于<time datetime="2009-03-31T16:05:30.000Z"> <a href="/post/aspfunc/">2009-04-01</a></time></span>      
    </header>
    
    
    <div class="entry" >
      
        <p>ASP函数语法速查表</p>
<table class="table table-bordered"><br><tbody><br><tr class="success"><br><td>Abs(数值)</td><br><td>绝对值。一个数字的绝对值是它的正值。空字符串 (null)   的绝对值，也是空字符串。未初始化的变数，其绝对为 0</td><br><td>例子：ABS(-2000) <br><br>  结果：2000</td><br></tr><br><tr class="danger"><br><td>Array(以逗点分隔的数组元素)</td><br><td>Array 函数传回数组元素的值。</td><br><td>例子： <br><br>  A=Array(1,2,3)<br><br>  B=A(2)<br><br>  结果： 2<br><br>  说明：变量B为A数组的第二个元素的值。 </td><br></tr><br><tr class="success"><br><td>Asc(字符串)</td><br><td>将字符串的第一字母转换成 ANSI(美国国家标准符号)字码。</td><br><td>例子：Asc(＂Internet＂)<br><br>  结果：73<br><br>  说明：显示第一字母 I 的 ANSI 字码。 </td><br></tr><br><tr class="danger"><br><td>CBool(表达式)</td><br><td>转换成布尔逻辑值变量型态(True 或False)</td><br><td>例子：CBool(1+2)<br><br>  结果：True </td><br></tr><br><tr class="success"><br><td>CDate(日期表达式)</td><br><td>换成日期变量型态。可先使用 IsDate 函数判断是否可以转换成日 期。</td><br><td>例子： CDate (now( )+2) <br><br>  结果：2000/5/28 10:30:59 </td><br></tr><br><tr class="danger"><br><td>CDbl(表达式)</td><br><td>转换成DOUBLE变量型态。</td><br><td></td><br></tr><br><tr class="success"><br><td>Chr(ANSI 字码)</td><br><td>将ASCII 字码转换成字符。</td><br><td>例子： Chr(72)<br><br>  结果： H </td><br></tr><br><tr class="danger"><br><td>CInt(表达式)</td><br><td>转换成整数变量型态。</td><br><td>例子： CInt (“3.12”) <br><br>  结果： 3 </td><br></tr><br><tr class="success"><br><td>CLng(表达式)</td><br><td>转换成LONG 变量型态。</td><br><td></td><br></tr><br><tr class="danger"><br><td>CSng(表达式)</td><br><td>转换成SINGLE 变量型态。</td><br><td></td><br></tr><br><tr class="success"><br><td>CStr(表达式)</td><br><td>转换成字符串变量型态。</td><br><td></td><br></tr><br><tr class="danger"><br><td>Date()</td><br><td>传回系统的日期。</td><br><td>例子： Date <br><br>  结果： 2000/5/13</td><br></tr><br><tr class="success"><br><td>DateAdd(I , N , D)</td><br><td>将一个日期加上一段期间后的日期。 I ：设定一个日期( Date)所加上的一段期间的单位。譬如 interval=”d” 表示   N的单位为日。 I的设定值如下： <br><br>  yyyy Year 年 <br><br>  q Quarter 季 <br><br>  m Month 月 <br><br>  d Day 日 <br><br>  w   Weekday 星期 <br><br>  h Hour 时 <br><br>  n Minute 分 <br><br>  s Second 秒 <br><br>  N   ：数值表达式，设定一个日期所加上的一段期间，可为正值或负值，正值表示加(结果为 &gt;date 以后的日期)，负值表示减(结果为 &gt;date   以前的日期)。 <br><br>  D ：待加减的日期。</td><br><td>例子： DateAdd(“m” , 1 , “31-Jan-98”) <br><br>  结果： 28-Feb-98 <br><br>  说明：将日期   31-Jan-98 加上一个月，结果为 28-Feb-98 而非 31-Fe-98 。 <br><br>  例子： DateAdd(“d” , 20 ,   “30-Jan-99”) <br><br>  结果： 1999/2/9 <br><br>  说明：将一个日期 30-Jan-99 加上 20 天后的日期。</td><br></tr><br><tr class="danger"><br><td>DateDiff (I , D1 , D2[,FW[,FY]])</td><br><td>计算两个日期之间的期间。 <br><br>  I ：设定两个日期之间的期间计算之单位。譬如 &gt;I=”m” 表示计算的单位为月。   &gt;I 的设定值如： <br><br>  yyyy &gt; Year 年 <br><br>  q Quarter 季 <br><br>  m Month 月 <br><br>  d Day 日 <br><br>  w Weekday 星期 <br><br>  h Hour 时 <br><br>  m Minute 分 <br><br>  s Second 秒 <br><br>  D1   ,D2：计算期间的两个日期表达式，若 &gt;date1 较早，则两个日期之间的期间结果为正值；若 &gt;date2 较早， 则结果为负值。 <br><br>  FW   ：设定每周第一天为星期几， 若未设定表示为星期天。 &gt;FW 的设定值如下： <br><br>  0 使用 &gt;API 的设定值。 <br><br>  1 星期天 <br><br>  2   星期一 <br><br>  3 星期二 <br><br>  4 星期三 <br><br>  5 星期四 <br><br>  6 星期五 <br><br>  7 星期六 <br><br>  FY ：设定一年的第一周，   若未设定则表示一月一日那一周为一年的第一周。 &gt;FY 的设定值如下： <br><br>  0 使用 &gt;API 的设定值。 <br><br>  1   一月一日那一周为一年的第一周 <br><br>  2 至少包括四天的第一周为一年的第一周 <br><br>  3 包括七天的第一周为一年的第一周</td><br><td>例子： DateDiff (“d”,”25-Mar-99 “,”30-Jun-99 “) <br><br>  结果： 97 <br><br>  说明：显示两个日期之间的期间为 97 天。</td><br></tr><br><tr class="success"><br><td>DatePart (I,D,[,FW[,FY]])</td><br><td>传回一个日期的之部份。 <br><br>  &gt;I ：设定传回那一部份。譬如 &gt;I=”d” 表示传回 部份为日。 &gt;I   的设定值如下： <br><br>  yyyy Year 年 <br><br>  q Quarter 季 <br><br>  m Month 月 <br><br>  d Day 日 <br><br>  w Weekday   星期 <br><br>  h Hour 时 <br><br>  m Minute 分 <br><br>  s Second 秒 <br><br>  D ：待计算的日期。 <br><br>  &gt;FW   ：设定每周第一天为星期几， 若未设定则表示为星期天。 &gt;FW 的设定值如下： <br><br>  0 使用 &gt;API 的设定值。 <br><br>  1 星期天 <br><br>  2   星期一&gt;3 星期二 <br><br>  4 星期三 <br><br>  5 星期四 <br><br>  6 星期五 <br><br>  7 星期六 <br><br>  FY ：设定一年的第一周，   若未设定则表示一月一日那一周为一年的第一周。 &gt;FY 的设定值如下： <br><br>  0 使用 &gt;API 的设定值。 <br><br>  1   一月一日那一周为一年的第一周 <br><br>  2 至少包括四天的第一周为一年的第一周 <br><br>  3 包括七天的第一周为一年的第一周</td><br><td>例子： DatePart (“m”,”25-Mar-99 “) <br><br>  结果： 3 <br><br>  说明：显示传回一个日期   的月部份。</td><br></tr><br><tr class="danger"><br><td>Dateserial (year,month,day)</td><br><td>转换(year,month,day) 成日期变量型态。</td><br><td>例子： DateSerial (99,10,1) <br><br>  结果： 1999/10/1</td><br></tr><br><tr class="success"><br><td>DateValue ( 日期的字符串或表达式 )</td><br><td>转换成日期变量型态，日期从 January 1,100 到 December 31,9999 。格式为 month,day,and   year 或 month/day/year 。譬如： December 30,1999 、 Dec 30,1999 、 12/30/1999 、   12/30/99</td><br><td>例子： DateValue (“January 1,2002 “) <br><br>  结果： 2002/1/1</td><br></tr><br><tr class="danger"><br><td>Day( 日期的字符串或表达式 )</td><br><td>传回日期的「日」部份。</td><br><td>例子： Day(“ 12/1/1999 “) <br><br>  结果： 1</td><br></tr><br><tr class="success"><br><td>Fix( 表达式 )</td><br><td>转换字符串成整数数字型态。与 Int 函数相同。若为 null 时传回 null 。 <br><br>  Int (number) 与   Fix(number) 的差别在负数。如 Int (-5.6)=-6 ， Fix(-5.6)=-5 。</td><br><td>例子： Fix(5.6) <br><br>  结果： 5</td><br></tr><br><tr class="danger"><br><td>Hex( 表达式 )</td><br><td>传回数值的十六进制值。若表达式为 null 时 Hex( 表达式 )=null ，若表达式 =Empty 时 Hex( 表达式   )=0 。 16 进位可以加「 &amp;H 」表示，譬如 16 进位 &amp;H10 表示十进制的 16 。</td><br><td>例子： Hex(30) <br><br>  结果： 1E</td><br></tr><br><tr class="success"><br><td>Hour( 时间的字符串或表达式 )</td><br><td>传回时间的「小时」部份。</td><br><td>例子： Hour(“12:30:54 “) <br><br>  结果： 12</td><br></tr><br><tr class="danger"><br><td>InStr   ([start,]string1,string2[,compare]) </td><br><td>将一 个 字符串由左 而右与另一个比较，传回第一个相同的位置。 <br><br>  start 为从第几个字比较起，若省略 start   则从第一个字比较起， string1 为待寻找的字符串表达式， string2 为 待比较的字符串表达式， compare 为比较的方法， compare=0   表二进制比较法， compare=1 表文字比较法，若省略 compare 则为预设的二进制比较法。</td><br><td>例子： InStr(“abc123def123”,”12”) <br><br>  结果： 4</td><br></tr><br><tr class="success"><br><td>InstrRev   ([start,]string1,string2[,compare])</td><br><td>将一 个 字符串 由右而左与另一个比较，传回第一个相同的位置。 <br><br>  start 为从第几个字比较起，若省略 start   则从第一个字比较起， string1 为待寻找的字符串表达式， string2 为 待比较的字符串表达式， compare 为比较的方法， compare=0   表二进制比较法， compare=1 表文字比较法，若省略 compare 则为预设的二进制比较法。</td><br><td>例子： InstrRev (“abc123def123”,”12”) <br><br>  结果： 10</td><br></tr><br><tr class="danger"><br><td>Int ( 表达式 )</td><br><td>传回一个数值的整数部份。与 Fix 函数相同。</td><br><td>例子： Int (5.6) <br><br>  结果： 5</td><br></tr><br><tr class="success"><br><td>IsArray ( 变数 )</td><br><td>测试变量是 (True) 否 (False) 是一个数组。</td><br><td>例子： IsArray (3) <br><br>  结果： False <br><br>  说明：不是一个数组。</td><br></tr><br><tr class="danger"><br><td>IsDate ( 日期或字符串的表达式 )</td><br><td>是否可以转换成日期。日期从 January 1,100 A.D. 到 December 31,9999 A.D 。</td><br><td>例子： IsDate (“December 31,1999 “) <br><br>  结果： True <br><br>  说明：可以转换成日期。</td><br></tr><br><tr class="success"><br><td>IsEmpty ( 变数 )</td><br><td>测试变量是 (True) 否 (False) 已经被初始化</td><br><td>例子： IsEmpty (a) <br><br>  结果： True</td><br></tr><br><tr class="danger"><br><td>IsNull ( 变数 )</td><br><td>测试变数是 (True) 否 (False) 不是有效的数据。</td><br><td>例子： IsNull (“”) <br><br>  结果： False <br><br>  说明：是有效的数据。</td><br></tr><br><tr class="success"><br><td>IsNumeric ( 表达式 )</td><br><td>是 (True) 否 (False) 是数字。</td><br><td>例子： IsNumeric (“abc123”) <br><br>  结果： False <br><br>  说明：不是数字。</td><br></tr><br><tr class="danger"><br><td>LCase ( 字符串表达式 )<a href="#top" target="_blank"> top</a></td><br><td>转换字符串成小写。将大写字母的部份转换成小写。字符串其余的部份不变。</td><br><td>例子： LCase (“ABC123”) <br><br>  结果： abc123</td><br></tr><br><tr class="success"><br><td>Left( 字符串表达式 ,length)</td><br><td>取字符串左边的几个字。 length 为取个字。 Len 函数可得知字符串的长度。</td><br><td>例子： Left(“ABC123”,3) <br><br>  结果： ABC</td><br></tr><br><tr class="danger"><br><td>Len( 字符串表达式 变量 )</td><br><td>取得字符串的长度。</td><br><td>例子： Len(“ABC123”) <br><br>  结果： 6</td><br></tr><br><tr class="success"><br><td>LTrim ( 字符串表达式 )</td><br><td>除去字符串左边的空白字。 RTrim 除去字符串右边的空白字， Trim 函数除去字符串左右两边的空白字。</td><br><td>例子： LTrim (“456+” abc “) <br><br>  结果： 456abc123</td><br></tr><br><tr class="danger"><br><td>Mid( 字符串表达式 ,start[,length]) </td><br><td>取字符串中的几个字。 start 为从第几个 字取起， length 为取几个字， 若略 length 则从 start   取到最右底。由Len 函数可得知字符串的长度。</td><br><td>例子： Mid(“abc123”,2,3) <br><br>  结果： c12</td><br></tr><br><tr class="success"><br><td>Minute( 日期的字符串或表达式 )</td><br><td>传回时间的「分钟」部份。</td><br><td>例子： Minute(“12:30:54”) <br><br>  结果：30</td><br></tr><br><tr class="danger"><br><td>Month(日期的字符串或表达式)</td><br><td>传回日期的「月」部份。</td><br><td>例子：Month(“12/1/2001”) <br><br>  结果：12</td><br></tr><br><tr class="success"><br><td>MonthName(month[,abbreviate])</td><br><td>传回月的名称。 <br><br>  month ：待传回月名称的数字 1~12 。譬如， 1 代表一月， 7 代表七月。 <br><br>  abbreviate: 是 (True) 否 (False) 为缩写，譬如 March ，缩写为 Mar 。默认值为 False   。中文的月名称无缩写。</td><br><td>例子： MonthName (7) <br><br>  结果：七月</td><br></tr><br><tr class="danger"><br><td>Now()</td><br><td>传回系统的日期时间。</td><br><td>例子： Now() <br><br>  结果： 2001/12/30 10:35:59 AM</td><br></tr><br><tr class="success"><br><td>Oct()</td><br><td>传回数值的八进位值。八进位可以加「 &amp;O 」表示，譬如八进位 &amp;O10 表示十进制的 8 。</td><br><td>例子： Oct(10) <br><br>  结果： 12</td><br></tr><br><tr class="danger"><br><td>Replace(   字符串表达式,findnreplacewith[,start[,count[,compare]]]) </td><br><td>将一个字符串取代 部份字。寻找待取代的原字符串 (find) ， 若找到则被取代为新字符串 (replacewith) 。 <br><br>  find ：待寻找取代的原字符串。 <br><br>  replacewith ：取代后的字。 <br><br>  start ：从第几个字开始寻找取代，   若未设定则由第一个字开始寻找。 <br><br>  count ：取代的次数。 若未设定则所有寻找到的字符串取代字符 串全部被取代。 <br><br>  compare   ：寻找比较的方法， compare=0 表示二进制比较法， compare=1 表文字比较法， compare =2 表根据比较的 数据型态而定，若省略   compare 则为预设的二进制比较法。</td><br><td>例子： Replace(“ABCD123ABC”,”AB”,”ab”) <br><br>  结果： abCD123abC</td><br></tr><br><tr class="success"><br><td>Right( 字符串表达式 ,length)</td><br><td>取字符串右边的几个字， length 为取几个字。 Len 函数可得知字符串的长度。</td><br><td>例子： Right(“ABC123”,3) <br><br>  结果： 123</td><br></tr><br><tr class="danger"><br><td>Rnd [(number)]</td><br><td>0~1 的 随机随机数值。 number 是任何有效的数值表达式。若 number 小于 0 表示每次得到相同的 随机随机数值。   number 大于 0 或未提供时表示依序得到下一个 随机随机数值。 &gt;number=0 表示得到最近产生的   随机随机数值。为了避免得到相同的随机随机数顺序，可以于 Rnd 函数前加 Randomize 。</td><br><td>例子： Rnd <br><br>  结果： 0.498498</td><br></tr><br><tr class="success"><br><td>Round( 数值表达式 [,D])</td><br><td>四舍五入。 <br><br>  D ：为四舍五入到第几位小数，若省略则四舍五入到整数。</td><br><td>例子： Round(30635,1) <br><br>  结果： 3.6</td><br></tr><br><tr class="danger"><br><td>RTrim ( 字符串表达式 )</td><br><td>除去字符串右边的空白字。 LTrim 除去字符串左边的空白字， Trim 函数除去字符串左右两边的空白字。</td><br><td>例子： RTrim (“abc123 “)+”456” <br><br>  结果： abc123456</td><br></tr><br><tr class="success"><br><td>Second( 时间的字符串或表达式 )</td><br><td>传回时间的「秒」部份。</td><br><td>例子：Second(“12:30:54”) <br><br>  结果：54</td><br></tr><br><tr class="danger"><br><td>Space( 重复次数 )</td><br><td>得到重复相同的空白字符串。</td><br><td>例子： A”+Space (5)+”B <br><br>  结果： A B <br><br>  说明： A 和 B   中间加入五个空白字。</td><br></tr><br><tr class="success"><br><td>String( 重复次数，待重复的字 )</td><br><td>得到重复相同的字符串。</td><br><td>例子： String(5,71) <br><br>  结果： GGGGG</td><br></tr><br><tr class="danger"><br><td>StrReverse (String(10,71))</td><br><td>将一个字符串顺序颠倒。</td><br><td>例子： StrReverse (“ABC”) <br><br>  结果： CBA</td><br></tr><br><tr class="success"><br><td>Time()</td><br><td>传回系统的时间。</td><br><td>例子： Time <br><br>  结果： 10:35:59 PM</td><br></tr><br><tr class="danger"><br><td>TimeSerial (hour,minute,second)</td><br><td>转换指定的 ( hour,minute,second) 成时间 变量型态。</td><br><td>例子： TimeSerial (10,31,59) <br><br>  结果： 10:31:59</td><br></tr><br><tr class="success"><br><td>TimeValue ( 日期的字符串或表达式 )</td><br><td>转换 成时间变量型态。日期的字符串或表达式从 0:00:00(12:00:00 A.M.) 到 23:59:59(11:59:59   P.M.) 。</td><br><td>例子： TimeValue (“ 11:59:59 “) <br><br>  结果： 11:59:59</td><br></tr><br><tr class="danger"><br><td>Trim( 字符串表达式 )</td><br><td>除去字符串左右两边的空白字。</td><br><td>例子： Trim(“ abc123 “) <br><br>  结果： abc123</td><br></tr><br><tr class="success"><br><td>UCase ()</td><br><td>转换字符串成大写。将小写字母的部份转换成大写，字符串其余部份不变。</td><br><td>例子： UCase (“abc123”) <br><br>  结果： ABC123</td><br></tr><br><tr class="danger"><br><td>VarType ( 变数 )</td><br><td>传回一个变量类型。与 TypeName 函数相同， VarType 传回变量类型的代码， TypeName 传回变量类型的名称。</td><br><td>例子： VarType ( “I love you!”) <br><br>  结果： 8</td><br></tr><br><tr class="success"><br><td>Weekday( 日期表达式 ,[FW]) </td><br><td>传回星期几的数字。 <br><br>  FW ：设定一周的第一天是星期几。若 省略则表 1( 星期日 ) 。 <br><br>  Firstdayfweek 设定值为： 1( 星期日 ),2( 星期一 ),3( 星期二 ),4( 星期三 ),5( 星期四 ),6( 星期五 ),7(   星期六 ) 。</td><br><td>例子： Weekday(“ 1/1/2000”) <br><br>  结果： 7</td><br></tr><br><tr class="danger"><br><td>WeekDayName (W,A,FW)</td><br><td>传回星期几的名称。 <br><br>  W ：是 (True) 否 (False) 为缩写。譬如 March ，缩写为 Mar 。预设为   False 。中文的星期几名称无缩写。 <br><br>  FW ：设定一周的第一天是星期几。 若省略表 1( 星期日 ) 。设定待传回星期几的名称，为一周中的第几天。 <br><br>  A ： 1( 星期日 ),2( 星期一 ),3( 星期二 ),4( 星期三 ),5( 星期四 ),6( 星期五 ),7( 星期六 ) 。</td><br><td>例子： WeekDayName (“1/1/2000”) <br><br>  结果：星期六</td><br></tr><br><tr class="success"><br><td>Year()</td><br><td>传回日期的「年」部份。</td><br><td>例子： Year(“ 12/1/2000 “) <br><br>  结果：   2000</td><br></tr><br></tbody><br></table>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <div class="categories"style="display:inline">归类<span class="breadcrumb fa fa-folder"><li><a href="/categories/程序设计/" itemprop="url"><span itemprop="title" >程序设计</span></a></li><li><a href="/categories/程序设计/ASP/" itemprop="url">ASP</a></li></span></div> | <span class="tags">标签 <a href="/tags/ASP/" class="label label-primary" itemprop="url"><span itemprop="title">ASP</span></a><a href="/tags/函数/" class="label label-success" itemprop="url"><span itemprop="title">函数</span></a><a href="/tags/编程/" class="label label-info" itemprop="url"><span itemprop="title">编程</span></a></span> | <span class="time">最近更新:<time title="2014-02-26 19:52:59"datetime="2014-02-26 19:52:59"> 2014-02-26</time></span> | <span class="comment-link">
<a href="http://chenall.net/post/aspfunc/#comments" class="ds-thread-count comment-link" data-thread-key="51" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/post/minipe_update/">[原创] 无限扩展,多功能PE_更新与下载(2009-05-01)最终版</a></h1>
      
        <span>发表于<time datetime="2009-03-26T15:22:45.000Z"> <a href="/post/minipe_update/">2009-03-26</a></time></span>      
    </header>
    
    
    <div class="entry" >
      
        <p>可以点击链接直接下载，或者进入网络硬盘下载。共享密码是:chenall</p>
<p><a href="http://qiniu.chenall.net/upload/2009/1/外置驱动说明.txt">外置驱动使用说明.txt</a></p>
<p><a href="http://qiniu.chenall.net/upload/2009/1/请先读我.txt">请先读我.txt</a></p>
<p><a href="http://qiniu.chenall.net/upload/2009/1/更新历史.txt">更新历史.txt</a></p>
<p>2009-05-01 修正版ISO下载[2009-05-03]</p>
<p><a href="http://chenall.liondrive.com/MicroPE/MicroPE.rar?action=download/download" target="_blank" rel="external">http://chenall.liondrive.com/MicroPE/MicroPE.rar?action=download/download</a></p>
<p>如果没有看到请</p>
<p>2009-05-01成品ISO下载测试</p>
<p><a href="http://dl.getdropbox.com/u/835279/MicroPE.ISO" target="_blank" rel="external">http://dl.getdropbox.com/u/835279/MicroPE.ISO</a></p>
<p>基本上不会再更新,除非有重大问题.</p>
<p>目前自用,一般也就更新一下驱动或解决一些小BUG,优化之类的.</p>
<p>目前本PE已经传到了我的live mesh网盘,和我的电脑上进行同步.如果有使用live mesh并且需要得到最新版的PE的朋友可以留下live id.</p>
<p>我将把这个共享给你,就可以同步更新了.关于live mesh的资料请上网查找.</p>
<h3 id="2014-01-21_注:_本PE已经早就不更新了,本文只保留作为研究的记录-">2014-01-21 注: 本PE已经早就不更新了,本文只保留作为研究的记录.</h3>
<h3 id="类似的PE推荐使用_pseudo的0PE"><strong>类似的PE推荐使用 <a href="http://bbs.wuyou.com/viewpro.php?uid=195661" target="_blank" rel="external">pseudo</a>的<a href="http://bbs.wuyou.com/forum.php?mod=forumdisplay&amp;fid=82" target="_blank" rel="external">0PE</a></strong></h3>
<h3 id="本PE特色:">本PE特色:</h3>
<ol>
<li>首创支持直接使用ISO启动,而且不影响任何功能. 使用ISO启动可以自动找到ISO里面的外置程序<br>需求: 启动ISO文件必须为 /BOOT/MICROPE.ISO</li>
<li>首创支持外置硬盘控制器(S&amp;R&amp;S)驱动.遇到新的主板进入PE后没有找到硬盘可以方便的添加驱动而不需要重新修改启动镜像内容.</li>
<li>首创支持多重启动,任意启动,想怎么启动都可以.启动加载的IMG只有15MB.</li>
<li>启动核心最小并且保持功能完整.启动后如果缺什么功能都可以通过外置程序来添加.</li>
<li>首创支持iSCSI启动,也是首个支持iSCSI客户端连接的XP PE</li>
<li>首创充许把核心IMG里面的文件直接解开放在U盘或硬盘上进行启动.(不建议使用)</li>
<li>外置程序模块化,傻瓜化添加,基本上只需复制粘贴就可以了.</li>
<li>本地/光盘/iSCSI/网络PXE等,随意启动.</li>
</ol>
<p>2009-01-19 ,具体请看更新历史.txt</p>
<p>PE090115出现失误,请自行修改[PE定制]目录下的批处理把以下语句后面的Micrope.lst改为menu.lst</p>
<pre><code>grubmenu.exe import boot\grldr boot\MicroPE.lst
</code></pre><p>2009-01-16</p>
<p>不再整个ISO文件上传,使用了可定制的方式上传所有需要的文件,加了一些说明.</p>
<p>可根据需要自己生成ISO文件.</p>
<p>其它请查看更新历史页面.</p>
<p>下载地址:</p>
<p><a href="http://www.brsbox.com/chenall" target="_blank" rel="external">http://www.brsbox.com/chenall</a></p>
<p>PE090115.rar</p>
<p>这个版本已经支持ISCSI启动,只要手工内置SYSTEM.WIM和NET.WIM就可以了.</p>
<p>SYSTEM.WIM内置到WXPE\SYSTEM\SYSTEM.WIM</p>
<p>NET.WIM内置到WXPE\NET\NET.WIM.</p>
<p>说明书尚未添加ISCSI启动的资料,.有关ISCSI启动请查看无忧论坛相关贴子.</p>
<p>2009-01-08.</p>
<p>细微调整,整个ISO文件上传146MB.</p>
<p>[MicroPE.iso]</p>
<p>注意:</p>
<ol>
<li><p>如果要解开ISO请使用IsoBuster否则解开的文件不完整.</p>
</li>
<li><p>硬盘控制器驱动直接使用了<a href="http://bbs.wuyou.com/viewpro.php?uid=195661" target="_blank" rel="external">pseudo</a> 的OPE 1230版本的驱动.</p>
</li>
<li><p>因为我是维护用的,内置RADMIN服务端,启动网络后会自动运行.方便进行远程控制.</p>
</li>
<li><p>此版核心支持ISCSI启动,</p>
</li>
</ol>
<p>方法,把NET.WIM和SYSTEM.WIM内置到WINPE.IMG里面即可.</p>
<p>目录限制.内置NET.WIM放在WXPE\NET目录下.SYSTEM.WIM放在WXPE\SYSTEM目录下.否则无效.</p>
<p>然后在WINPE.IMG根目录下新建一个文件夹DRIVERS里面放网卡驱动.</p>
<p>2008-12-03.</p>
<p>由于我没有使用光盘测试而是直接用硬盘启动,所以一直没有发现一个问题.今天用光盘启动才发现.</p>
<p>当使用光盘启动时,驱动目录的设置可能会出错,造成驱动安装失败.</p>
<p>解决方法:</p>
<p>修改MINIPE\AUTORUN.INF文件</p>
<p>把以下语句修改一下即可.</p>
<p>ENVI $Drivers=%curdrv%\minipe\Drivers</p>
<p>改成如下.</p>
<p>ENVI $Drivers=%curdir%\Drivers</p>
<p>说明:虽然两句要表达的意思是一样的,但是用后面那一句通用性比较高..</p>
<p>因为%curdrv%无法识别\\?\cdrom0,所以失败.</p>
<p>2008-11-24.</p>
<ol>
<li>添加了最新版的PECMD.EXE．　</li>
<li>更新了UNIATA驱动到最新版．</li>
<li>更新了启动文件GRLDR到最新版（调整了启动菜单MENU.LST）</li>
<li>内置了EXFAT文件系统驱动．</li>
</ol>
<p>还有一些细微修改，其中某些文件参考了<a href="http://bbs.wuyou.com/space.php?uid=195661" target="_blank" rel="external">pseudo</a> </p>
<p><a href="http://bbs.wuyou.com/viewthread.php?tid=104242" target="_blank" rel="external">【无忧首发】零体积全能可扩展PE(软盘装得下的PE，11.01)</a>的版本进行修改．</p>
<p>2008-05-14</p>
<p>1.新版<a href="/blog/getfile.asp?did=1&amp;fid=1381864">SCSI.IMG</a>测试 带完整驱动。从根据以下贴子的资料整理</p>
<p><a href="http://bbs.wuyou.com/viewthread.php?tid=107172" target="_blank" rel="external">[4月12日]基于毛桃PE的SATA、RAID驱动补充优化1.3修正版(新内核测试4+新问题)</a></p>
<p><a href="http://bbs.wuyou.com/viewthread.php?tid=122156" target="_blank" rel="external">[待测]Intel、SIS、VIA、ULI/ALI、AMD、ATI、NV南桥磁盘驱动BETA版[5月13日]</a></p>
<p>2008-05-11</p>
<p>1.添加了极点中文输入法(带86五笔)精简版(用于PE).<a href="/blog/getfile.asp?did=1&amp;fid=1381812">@1#FreeIme_.WIM</a> 极点6.2CCF专版</p>
<p>2008-05-10</p>
<p>1.<a href="/blog/getfile.asp?did=1&amp;fid=1381799">磁盘分区表医生 PTDD</a> 使用了无忧<a href="http://bbs.wuyou.com/space.php?uid=124412" target="_blank" rel="external">玄天</a>发表的汉化破解版,</p>
<p><a href="http://bbs.wuyou.com/viewthread.php?tid=120397&amp;page=77#pid1390729" target="_blank" rel="external">http://bbs.wuyou.com/viewthread.php?tid=120397&amp;page=77#pid1390729</a></p>
<p>2.<a href="/blog/getfile.asp?did=1&amp;fid=1381798">PE定制包</a>, 更新</p>
<p>GRLDR更新到05-07版,修改了HIDE.TXT内容(隐藏所有启动相关的文件,使得光盘上的文件在WINDOWS下看起来比较整洁)</p>
<p>修改了默认的菜单,</p>
<p>2008-05-05</p>
<p>1.<a href="/blog/getfile.asp?did=1&amp;fid=1381670">SCSI.IMG</a>测试,使用了新的检测方式.</p>
<p>2008-05-04 </p>
<p>1.<a href="/blog/getfil
e.asp?did=1&amp;fid=1381648">WINPE.IMG</a>更新,自动挂载支持自动运行（挂载时运行，方便作一些前期设定文件WIM里面的+AutoRun.cmd）</p>
<p>2008-04-30</p>
<p>1.网络<a href="/blog/getfile.asp?did=1&amp;fid=1381652">@net.wim</a>更新.</p>
<p> 1).支持启动网络后自动运行脚本(启动网络自动运行.cmd,可使用其它批处理或程序来生成,如果文件存在启动网络后会自动运行).</p>
<p> 2).连接后在通知区域显示图标 by pseudo (<a href="http://bbs.wuyou.com/viewthread.php?tid=123874" target="_blank" rel="external">http://bbs.wuyou.com/viewthread.php?tid=123874</a>)</p>
<p>2.<a href="/blog/getfile.asp?did=1&amp;fid=1381653">haneWIN DHCP</a>升级到3.0.20版</p>
<p>3.<a href="/blog/getfile.asp?did=1&amp;fid=1381630">DiskGenius</a>更新为3.0.418 b2版</p>
<p>2008-04-15</p>
<p>外置更新</p>
<p>1.外置驱动SCSI.IMG更新,使用了新版的GRUB.EXE.修改了里面的一些驱动.</p>
<p>注：目前的SCSI.IMG加载驱动时，在有些主板上会检测不到。暂时先用着，下次更新将使用新的检测方法。</p>
<p>2.外置<a href="/blog/getfile.asp?did=1&amp;fid=1381732">SYSTEM.WIM</a>更新:修改了SYSTEM_.CMD批处理的语法错误.</p>
<p>2008-04-14</p>
<p>WINPE.IMG更新</p>
<p>1.替换了XP_TOOLS.WIM为新版.</p>
<p>2.修改了PELOGON.EXE的托盘菜单.直接使用以下贴子文件替换(另修改了热键按CTRL+ALT+A的刷新率为60,原文件没有改这个)</p>
<p>原贴:<a href="http://bbs.wuyou.com/viewthread.php?tid=121168&amp;page=48#pid1373269" target="_blank" rel="external">http://bbs.wuyou.com/viewthread.php?tid=121168&amp;page=48#pid1373269</a></p>
<p>3.加入了VIA PCI潜伏期补丁</p>
<p>原贴:<a href="http://bbs.wuyou.com/viewthread.php?tid=122156&amp;page=2#pid1358101" target="_blank" rel="external">http://bbs.wuyou.com/viewthread.php?tid=122156&amp;page=2#pid1358101</a></p>
<p>4.批处理Bug修正.</p>
<p>2008-03-24</p>
<p>1.修改了PE定制包里面的MENU.LST菜单,加上容错语句.由无忧yiyaxuan发现并解决问题</p>
<p>2008-03-21</p>
<p>1.替换了SCSI.IMG里面的GRUB.EXE为最新版,解决有些电脑启动失败的问题.</p>
<p>2.修改了MENU.LST启动菜单,使用1,2都支持外置的OEM_SCSI.IMG驱动.</p>
<p>3.把WINPE.IMG分别压缩成WINPE.IM_和WINPE.GZ两个文件.</p>
<p>2008-03-19</p>
<p>1.替换内置的RAMDISK为IMDISK.在使用复制SYSTEM.WIM到内存盘时,所需的时间更少</p>
<p>2.加了一个外置SCSI驱动工具(目录SCSI),使用方法内详</p>
<p> 功能:可以把某个SCSI驱动由TXTSETUP.OEM格式转为txtsetup.sif格式,并生成对应的驱动信息文件(可直接复制添加到SCSI.MAP中)</p>
<p> 注:此为方便添加外置SCSI驱动而作,生成的文件不保证完全可靠.完成后请自行检查.</p>
<p>2008-03-18</p>
<p>1.修改了WINPE.IMG,加入了免按F6自动加载S&amp;R&amp;S驱动的支持.</p>
<p>2.修改了启动菜单,使之支持以上方法的外置SCSI驱动(镜像路径为/OEM_SCSI.IMG,有存在的话就自动加载驱动)</p>
<p>用途:</p>
<p> 只需制作一个文件名为OEM_SCSI.IMG(可以用GZIP压缩),放到U盘或硬盘的根目录(只要GRUB4DOS可以找到的都可以)</p>
<p> 启动PE时就会自动加载这个里面的驱动. 驱动文件和传统的按F6加载的软盘的文件一样.</p>
<p>2008-03-17</p>
<p>1.为外置SCSI.IMG加入了ryvius提供的Intel 和 Nvidia 驱动(本人未测试)</p>
<p> 具体请看由无忧ryvius发表的贴子</p>
<p> NVIDIA nForce SATA RAID/AHCI解决方案</p>
<p> <a href="http://bbs.wuyou.com/viewthread.php?tid=11273" target="_blank" rel="external">http://bbs.wuyou.com/viewthread.php?tid=11273</a></p>
<p> Intel芯片组IDE、RAID/AHCI解决方案</p>
<p> <a href="http://bbs.wuyou.com/viewthread.php?tid=116417" target="_blank" rel="external">http://bbs.wuyou.com/viewthread.php?tid=116417</a></p>
<p>2008-03-16</p>
<p>*修改了小错误,还是谢谢pz的提醒</p>
<p>*根据pseudo提供的资料,在IMG里面加入PORTCLS.SYS文件,解决声音问题.顺便修改了一下XP资源利用.</p>
<p>*添加了一些注释,以方便他人YY.</p>
<p>*为了防止恶意修改启动脚本造成启动失败,在AUTORUNS_.CMD内加了简单的校验</p>
<p>修改了这个文件就会进不了PE,启动到CMD后就直接重启.</p>
<p>当然了懂得批处理的人要修改自然是很简单的(知道了也请不要张扬).</p>
<p>如非特殊需要,不建议修改WINPE.IMG的内容,一般来说都可以通过外置的方式来解决.</p>
<p>.不带其它外置,请自备.以后会提供专门的外置程序下载.</p>
<p>2008-03-14,更新</p>
<p>*.修改了GRUB启动菜单,只保留一个RAMDISK启动菜单,默认不显示菜单.5秒后自动使用自动检测SCSI驱动的菜单.</p>
<p>*.SCSI.IMG的GRUB菜单也有相应的修改,同时GRUB换上了新版的0314版. SYSTEM.WIM改了一下,强制开启FBWF和一些文本错误.</p>
<p>*.加入了之前外置工具,完整上传,需要的可下载测试,在将来一段时间内可能不会再更新了.</p>
<p>2008-03-13,更新</p>
<p>*.加入了XP资源利用的NV网卡补丁，由pseudo提供（无忧）</p>
<p>*.再修改了一个自启动的批处理，影响不大</p>
<p>2008-03-12,更新</p>
<p>*去掉RAMDISK的启动菜单,使用单IMG文件来启动.</p>
<p>*修改IMG的启动批处理,之前的版本还是不可以直接使用非RAMDISK来启动(有问题)</p>
<p>*修改SCSI.IMG,改正了一些可能出现的错误.</p>
<p>*不论如何强制开启FBWF</p>
<p>*IMG改为28MB,虚拟机测试80MB可进桌面(用WDSYS)</p>
<p>以下根据pz(无忧)的建议修改.</p>
<p>*修改了一些界面显示的文本错误,</p>
<p>*启动时自动关闭小键盘(方便本本用户).</p>
<p>*改了一些文本错误(无优==&gt;无忧)谢谢qdaijchf(无忧)的提醒</p>
<p>发现我的错别字挺多的,呵呵一直都没有注意这些细节.以后还是仔细一点好.</p>
<p>08-03-11,修改</p>
<p>*修改默认菜单为第5条(自动加载适配的SCSI/RAID驱动)</p>
<p>*修改第5条菜单的内容，如果找不到SCSI.IMG就自动转到第4菜单执行</p>
<p>*修改SCSI.IMG的GRUB启动菜单，启动之前删除多余的映射防止启动蓝屏．</p>
<p>*修改IMG的Autoruns_.cmd批处理,使得适合使用非RAMDISK启动(之前的版本,如果直接用非RAMDISK启动会删除一些启动文件,下次就不能启动了.)</p>
<p>*注:若修改了IMG,这个IMG的卷标必须为MICROPE,否则启动时就不删除像TXTSETUP.SI?之类的文件.(原因同上).</p>
<p>若要使用非RAMDISK启动,则该磁盘磁标不能为MICROPE,否则启动一次后就不能再使用了(因为启动必须的文件会被删).</p>
<p>08-03-10,修改</p>
<p>新增菜单0</p>
<p> 功能:和第2个菜单一样,但是不加载无盘天使驱动(测试,因为有些加了会蓝屏)</p>
<p> 其它:该项不能使用下面的第二种方法来启动,因为没有带天使驱动.只是作为备用菜单</p>
<p>删除了DRIVERS目录下的一些文件(参考无忧uepon 20Mb的Vista美化PE).</p>
<p>相关贴子:<a href="http://bbs.wuyou.com/viewthread.php?tid=121708&amp;extra=page%3D2" target="_blank" rel="external">http://bbs.wuyou.com/viewthread.php?tid=121708&amp;extra=page%3D2</a></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <div class="categories"style="display:inline">归类<span class="breadcrumb fa fa-folder"><li><a href="/categories/系统相关/" itemprop="url"><span itemprop="title" >系统相关</span></a></li></span></div> | <span class="tags">标签 <a href="/tags/GRUB4DOS/" class="label label-primary" itemprop="url"><span itemprop="title">GRUB4DOS</span></a><a href="/tags/MINIPE/" class="label label-success" itemprop="url"><span itemprop="title">MINIPE</span></a><a href="/tags/SCSI/" class="label label-info" itemprop="url"><span itemprop="title">SCSI</span></a><a href="/tags/WXPE/" class="label label-warning" itemprop="url"><span itemprop="title">WXPE</span></a><a href="/tags/外置/" class="label label-primary" itemprop="url"><span itemprop="title">外置</span></a><a href="/tags/原创/" class="label label-success" itemprop="url"><span itemprop="title">原创</span></a></span> | <span class="time">最近更新:<time title="2014-02-26 19:52:59"datetime="2014-02-26 19:52:59"> 2014-02-26</time></span> | <span class="comment-link">
<a href="http://chenall.net/post/minipe_update/#comments" class="ds-thread-count comment-link" data-thread-key="49" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/post/grub4dos_menu/">[grub4dos]在GRLDR中内置超过4KB菜单的方法</a></h1>
      
        <span>发表于<time datetime="2009-03-08T09:14:21.000Z"> <a href="/post/grub4dos_menu/">2009-03-08</a></time></span>      
    </header>
    
    
    <div class="entry" >
      
        <p>大家都知道GRLDR中的内置菜单不能超过4KB,如果超过就会被截断.</p>
<p>如果超过4KB的菜单想要内置怎么办呢?</p>
<p>之前有想过使用GZ压缩,可是内置菜单不支持GZ压缩的格式.</p>
<p>后来得知启动后内置菜单的位置在内存中是固定的0X800处.</p>
<p>所以就想了个折中的办法.在内置的菜单中加入GZ压缩的菜单文件.</p>
<p>原理我就不多说了,贴上代码.</p>
<p>使用方法,</p>
<p>把以下代码另存为批处理文件,把你的菜单文件用GZ压缩(压缩后不能超过3KB)</p>
<p>然后使用批处理加参数执行(或直接把压缩后的菜单文件拖放到批处理文件图标上)</p>
<p>再用GRUBMENU导入生成的menu.lst就可以了.</p>
<p>注意使用grubmenu导入时要加-r参数如下.</p>
<p>grubmenu -r import grldr menu.lst</p>
<pre><code class="bat">@echo off
setlocal
cd /d &quot;%~dp0&quot;
if not exist &quot;%~1&quot; (
  echo.参数错误!!
  pause
  goto :eof
)
for %%i in (%1) do echo.configfile (md)5+7,%%~zi&gt;menu.lst
for %%i in (menu.lst) do set /a ns=512-%%~zi
fsutil file createnew menu_ex.lst %ns%
copy /y /b menu.lst /b + menu_ex.lst /b + %1 /b
del menu_ex.lst
pause 15.
</code></pre>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <div class="categories"style="display:inline">归类<span class="breadcrumb fa fa-folder"><li><a href="/categories/GRUB4DOS/" itemprop="url"><span itemprop="title" >GRUB4DOS</span></a></li></span><span class="breadcrumb"><li><a href="/categories/实用文集/" itemprop="url"><span itemprop="title" >实用文集</span></a></li></span></div> | <span class="tags">标签 <a href="/tags/GRUB4DOS/" class="label label-primary" itemprop="url"><span itemprop="title">GRUB4DOS</span></a><a href="/tags/菜单/" class="label label-success" itemprop="url"><span itemprop="title">菜单</span></a></span> | <span class="time">最近更新:<time title="2014-02-26 19:52:59"datetime="2014-02-26 19:52:59"> 2014-02-26</time></span> | <span class="comment-link">
<a href="http://chenall.net/post/grub4dos_menu/#comments" class="ds-thread-count comment-link" data-thread-key="47" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/post/post45/">[GRUB4DOS] 利用WRITE命令写字符串到内存中</a></h1>
      
        <span>发表于<time datetime="2009-03-02T05:43:03.000Z"> <a href="/post/post45/">2009-03-02</a></time></span>      
    </header>
    
    
    <div class="entry" >
      
        <p>熟悉GRUB4DOS的都知道.</p>
<p><code>write</code> 可以在内存中写入一个数值使用如下命令就可以了</p>
<pre><code>write 0x60000 1
</code></pre><p>在内存地址<code>0x60000中</code>写入<code>1</code>.</p>
<p>如果想写入的是一个字符串呢?用上面的方法肯定行不通.</p>
<p>因为需要我想在内存固定位置中写入一个字符串,在另一个菜单中读取.之前考虑了使用dd命令,虽可以实现但不太方便.</p>
<p>后来突然想到<em>write</em> 只能对文件写入字符串</p>
<p>而<code>grub4dos</code>中可以用<em>(xx)xxxx+n</em>的方式来表达一个文件.是不是可以使用这个来写入呢,后来的测试是成功的.</p>
<p>比如我要在内存<em>0x60000</em>中写入一个字符串<em>/BOOT</em>这时就可以使用以下命令来写入</p>
<pre><code>write (md)0x300+1 /boot
</code></pre><p>其中:0x300*512=0x60000</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <div class="categories"style="display:inline">归类<span class="breadcrumb fa fa-folder"><li><a href="/categories/GRUB4DOS/" itemprop="url"><span itemprop="title" >GRUB4DOS</span></a></li><li><a href="/categories/GRUB4DOS/介绍/" itemprop="url">介绍</a></li></span></div> | <span class="tags">标签 <a href="/tags/GRUB4DOS/" class="label label-primary" itemprop="url"><span itemprop="title">GRUB4DOS</span></a></span> | <span class="time">最近更新:<time title="2014-02-26 19:52:59"datetime="2014-02-26 19:52:59"> 2014-02-26</time></span> | <span class="comment-link">
<a href="http://chenall.net/post/post45/#comments" class="ds-thread-count comment-link" data-thread-key="45" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/post/post44/">[分享]超级解霸V9精简版(用来播放光蝶)</a></h1>
      
        <span>发表于<time datetime="2009-02-26T01:25:02.000Z"> <a href="/post/post44/">2009-02-26</a></time></span>      
    </header>
    
    
    <div class="entry" >
      
        <p>豪杰超级解霸V9 Vsita 增强版<a href="http://www.haojie.cn/" target="_blank" rel="external">http://www.haojie.cn/</a></p>
<hr>
<p>精简版功能.(压缩后只有2.5MB)</p>
<ol>
<li>保留视频功能.</li>
<li>保留自动播放司服器</li>
<li>修正原版自动播放司服器不能正常使用的问题.</li>
<li>添加了V8版和3500版的皮肤(已修改过).(使用V9版皮肤可以点右下角的超级解霸字样进行切换皮肤).</li>
</ol>
<p>精简版下载 <a href="http://ishare.iask.sina.com.cn/cgi-bin/fileid.cgi?fileid=4855424" target="_blank" rel="external">新浪共享</a></p>
<p>附,皮肤截图</p>
<p><img src="http://qiniu.chenall.net/upload/2009/2/20090226093206625.jpg" alt=""><br><img src="http://qiniu.chenall.net/upload/2009/2/20090226093219781.jpg" alt=""><br><img src="http://qiniu.chenall.net/upload/2009/2/20090226093233109.jpg" alt=""><br><img src="http://qiniu.chenall.net/upload/2009/2/20090226093510687.jpg" alt="">  </p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <div class="categories"style="display:inline">归类<span class="breadcrumb fa fa-folder"><li><a href="/categories/软件推荐/" itemprop="url"><span itemprop="title" >软件推荐</span></a></li><li><a href="/categories/软件推荐/影音播放/" itemprop="url">影音播放</a></li></span></div> | <span class="tags">标签 <a href="/tags/超级解霸/" class="label label-primary" itemprop="url"><span itemprop="title">超级解霸</span></a><a href="/tags/软件/" class="label label-success" itemprop="url"><span itemprop="title">软件</span></a></span> | <span class="time">最近更新:<time title="2014-02-26 19:52:59"datetime="2014-02-26 19:52:59"> 2014-02-26</time></span> | <span class="comment-link">
<a href="http://chenall.net/post/post44/#comments" class="ds-thread-count comment-link" data-thread-key="44" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/post/post43/">[转]正则表达式30分钟入门教程</a></h1>
      
        <span>发表于<time datetime="2009-02-07T08:21:01.000Z"> <a href="/post/post43/">2009-02-07</a></time></span>      
    </header>
    
    
    <div class="entry" >
      
        <style type="text/css">
#body{font-size:100%;}#body h1{text-align:center;}#body h2{background-color:#eee;border-bottom:solid 1px gray;border-right:solid 1px gray;clear:both;}#body p{text-indent:2em;line-height:140%;margin:5px 20px;}#body span{margin:3px;}#body table{margin:auto;border-style:solid;border-width:1px 1px 0 0;border-color:gray;background:#eee;}#body td,#body th{border-style:solid;border-width:0 0 1px 1px;border-color:gray;}#body caption{margin:auto;font-weight:bold;}#body dl{margin-left:20px;}#body dt{font-weight:bold;}#body em{font-style:normal;font-weight:bold;}#body .note,#body .ad{float:right;width:300px;padding:5px;background-color:#eee;border:solid 1px gray;clear:right;}#body #meta{text-align:center;}#body .important{color:orange;}#body .name{font-weight:bold;}#body .code{color:blue;}#body .regex{color:red;}#body .part{color:green;}#body .string{font-style:italic;}#body .desc{text-decoration:underline;}#body #clearButton,#body #hideButton{text-decoration:none;border:solid 1px gray;background-color:#eee;}#body #top{background:#eee;line-height:200%;}#body #top a{text-decoration:none;vertical-align:middle;color:Black;display:block;display:inline-block;text-align:center;padding:3px 15px;}#body #top a:hover{background:#ccc;}
</style>
<script type="text/javascript">
//<![CDATA[
function clearFormats(){var spans=document.getElementsByTagName("span");for(var i=0;i<spans.length;i++){spans[i].bakClassName=spans[i].className;spans[i].className="";}
var button=document.getElementById("clearButton");button.innerHTML="恢复格式";button.onclick=setFormats;return false;}
function setFormats(){var spans=document.getElementsByTagName("span");for(var i=0;i<spans.length;i++){spans[i].className=spans[i].bakClassName;}
var button=document.getElementById("clearButton");button.innerHTML="清除格式";button.onclick=clearFormats;return false;}
function hideNotes(){var notes=document.getElementsByClassName('note');for(var i=0;i<notes.length;i++){notes[i].style.display='none';}
var button=document.getElementById("hideButton");button.innerHTML="显示边注";button.onclick=showNotes;return false;}
function showNotes(){var notes=document.getElementsByClassName('note');for(var i=0;i<notes.length;i++){notes[i].style.display='block';}
var button=document.getElementById("hideButton");button.innerHTML="隐藏边注";button.onclick=hideNotes;return false;}
//]]>
</script>
<div id="body">
<div id="top">
    <a href="/">首页</a> | <a href="common.htm">常用正则表达式</a> | <a href="http://deerchao.net/tools/regex_tester/index.htm" target="_blank" rel="external">正则表达式测试工具</a>
</div>
<h1>正则表达式30分钟入门教程</h1>

<p id="meta">版本：v2.33 (2013-1-10) 作者：<a href="http://deerchao.net/" target="_blank" rel="external">deerchao</a>  转载请注明<a href="http://deerchao.net/tutorials/regex/regex.htm" target="_blank" rel="external">来源</a></p>

<h2 id="contents">目录</h2>
<p id="skipContents" class="note"><a href="#mission" title="转到正文内容">跳过目录</a></p>
<ol>
    <li><a href="#mission">本文目标</a></li>

    <li><a href="#howtouse">如何使用本教程</a></li>
    <li><a href="#introduction">正则表达式到底是什么东西？</a></li>
    <li><a href="#getstarted">入门</a></li>
    <li><a href="#testing">测试正则表达式</a></li>
    <li><a href="#metacode">元字符</a></li>
    <li><a href="#escape">字符转义</a></li>

    <li><a href="#repeat">重复</a></li>
    <li><a href="#charclass">字符类</a></li>
    <li><a href="#alternative">分枝条件</a></li>
    <li><a href="#negation">反义</a></li>
    <li><a href="#grouping">分组</a></li>
    <li><a href="#backreference">后向引用</a></li>

    <li><a href="#lookaround">零宽断言</a></li>
    <li><a href="#negativelookaround">负向零宽断言</a></li>
    <li><a href="#commenting">注释</a></li>
    <li><a href="#greedyandlazy">贪婪与懒惰</a></li>
    <li><a href="#regexoptions">处理选项</a></li>
    <li><a href="#balancedgroup">平衡组/递归匹配</a></li>

    <li><a href="#more">还有些什么东西没提到</a></li>
    <li><a href="#contact">联系作者</a></li>
    <li><a href="#resources">网上的资源及本文参考文献</a></li>
    <li><a href="#updatelog">更新纪录</a></li>
</ol>

<h2 id="mission">本文目标</h2>
<p>30分钟内让你明白正则表达式是什么，并对它有一些基本的了解，让你可以在自己的程序或网页里使用它。</p>

<h2 id="howtouse">如何使用本教程</h2>
<p id="giveMe30Minutes" class="important note">最重要的是——请给我<em>30分钟</em>，如果你没有使用正则表达式的经验，请不要试图在30<em>秒</em>内入门——除非你是超人 :)</p>
<p>别被下面那些复杂的表达式吓倒，只要跟着我一步一步来，你会发现正则表达式其实并没有想像中的那么困难。当然，如果你看完了这篇教程之后，发现自己明白了很多，却又几乎什么都记不得，那也是很正常的——我认为，没接触过正则表达式的人在看完这篇教程后，能把提到过的语法记住80%以上的可能性为零。这里只是让你明白基本的原理，以后你还需要多练习，多使用，才能熟练掌握正则表达式。</p>
<p>除了作为入门教程之外，本文还试图成为可以在日常工作中使用的正则表达式语法参考手册。就作者本人的经历来说，这个目标还是完成得不错的——你看，我自己也没能把所有的东西记下来，不是吗？</p>
<p><a href="#" id="clearButton" onclick="return clearFormats();">清除格式</a>&nbsp;文本格式约定：<span class="name">专业术语</span>&nbsp;<span class="code">元字符/语法格式</span>&nbsp;<span class="regex">正则表达式</span>&nbsp;<span class="part">正则表达式中的一部分(用于分析)</span>&nbsp;<span class="string">对其进行匹配的源字符串</span>&nbsp;<span class="desc">对正则表达式或其中一部分的说明</span></p>
<p><a href="#" id="hideButton" onclick="return hideNotes();">隐藏边注</a>&nbsp;本文右边有一些注释，主要是用来提供一些相关信息，或者给没有程序员背景的读者解释一些基本概念，通常可以忽略。</p>

<h2 id="introduction">正则表达式到底是什么东西？</h2>
<p class="note"><span class="name">字符</span>是计算机软件处理文字时最基本的单位，可能是字母，数字，标点符号，空格，换行符，汉字等等。<span class="name">字符串</span>是0个或更多个字符的序列。<span class="name">文本</span>也就是文字，字符串。说某个字符串<span class="name">匹配</span>某个正则表达式，通常是指这个字符串里有一部分（或几部分分别）能满足表达式给出的条件。</p>
<p>在编写处理字符串的程序或网页时，经常会有查找符合某些复杂规则的字符串的需要。<span class="name">正则表达式</span>就是用于描述这些规则的工具。换句话说，正则表达式就是记录文本规则的代码。</p>
<p>很可能你使用过Windows/Dos下用于文件查找的<span class="name">通配符(wildcard)</span>，也就是<span class="code">*</span>和<span class="code">?</span>。如果你想查找某个目录下的所有的Word文档的话，你会搜索<span style="color: red;">*.doc</span>。在这里，<span class="code">*</span>会被解释成任意的字符串。和通配符类似，正则表达式也是用来进行文本匹配的工具，只不过比起通配符，它能更精确地描述你的需求——当然，代价就是更复杂——比如你可以编写一个正则表达式，用来查找<span class="desc">所有以0开头，后面跟着2-3个数字，然后是一个连字号“-”，最后是7或8位数字的字符串</span>(像<span class="string">010-12345678</span>或<span class="string">0376-7654321</span>)。</p>

<h2 id="getstarted">入门</h2>
<p>学习正则表达式的最好方法是从例子开始，理解例子之后再自己对例子进行修改，实验。下面给出了不少简单的例子，并对它们作了详细的说明。</p>
<p>假设你在一篇英文小说里查找<span class="desc">hi</span>，你可以使用正则表达式<span class="regex">hi</span>。</p>
<p>这几乎是最简单的正则表达式了，它可以精确匹配这样的字符串：<span class="desc">由两个字符组成，前一个字符是h,后一个是i</span>。通常，处理正则表达式的工具会提供一个忽略大小写的选项，如果选中了这个选项，它可以匹配<span class="string">hi</span>,<span class="string">HI</span>,<span class="string">Hi</span>,<span class="string">hI</span>这四种情况中的任意一种。</p>
<p>不幸的是，很多单词里包含<span class="string">hi</span>这两个连续的字符，比如<span class="string">him</span>,<span class="string">history</span>,<span class="string">high</span>等等。用<span class="regex">hi</span>来查找的话，这里边的<span class="string">hi</span>也会被找出来。如果要<span class="desc">精确地查找hi这个单词</span>的话，我们应该使用<span class="regex">\bhi\b</span>。</p>
<p><span class="part">\b</span>是正则表达式规定的一个特殊代码（好吧，某些人叫它<span class="name">元字符，metacharacter</span>），代表着<span class="desc">单词的开头或结尾，也就是单词的分界处</span>。虽然通常英文的单词是由空格，标点符号或者换行来分隔的，但是<span class="code">\b</span>并不匹配这些单词分隔字符中的任何一个，它<strong>只匹配一个位置</strong>。</p>
<p class="note">如果需要更精确的说法，<span class="code">\b</span>匹配这样的位置：它的前一个字符和后一个字符不全是(一个是,一个不是或不存在)<span class="code">\w</span>。</p>
<p>假如你要找的是<span class="desc">hi后面不远处跟着一个Lucy</span>，你应该用<span class="regex">\bhi\b.*\bLucy\b</span>。</p>
<p>这里，<span class="part">.</span>是另一个元字符，匹配<span class="desc">除了换行符以外的任意字符</span>。<span class="part">*</span>同样是元字符，不过它代表的不是字符，也不是位置，而是数量——它指定*<span class="desc">前边的内容可以连续重复使用任意次以使整个表达式得到匹配</span>。因此，<span class="part">.*</span>连在一起就意味着<span class="desc">任意数量的不包含换行的字符</span>。现在<span class="regex">\bhi\b.*\bLucy\b</span>的意思就很明显了：<span class="desc">先是一个单词hi,然后是任意个任意字符(但不能是换行)，最后是Lucy这个单词</span>。</p>
<p class="note">换行符就是'\n',ASCII编码为10(十六进制0x0A)的字符。</p>
<p>如果同时使用其它元字符，我们就能构造出功能更强大的正则表达式。比如下面这个例子：</p>
<p><span class="regex">0\d\d-\d\d\d\d\d\d\d\d</span>匹配这样的字符串：<span class="desc">以0开头，然后是两个数字，然后是一个连字号“-”，最后是8个数字</span>(也就是中国的电话号码。当然，这个例子只能匹配区号为3位的情形)。</p>
<p>这里的<span class="part">\d</span>是个新的元字符，匹配<span class="desc">一位数字(0，或1，或2，或……)</span>。<span class="part">-</span>不是元字符，只匹配它本身——连字符(或者减号，或者中横线，或者随你怎么称呼它)。</p>
<p>为了避免那么多烦人的重复，我们也可以这样写这个表达式：<span class="regex">0\d{2}-\d{8}</span>。这里<span class="part">\d</span>后面的<span class="part">{2}</span>(<span class="part">{8}</span>)的意思是前面<span class="part">\d</span><span class="desc">必须连续重复匹配2次(8次)</span>。</p>

<h2 id="testing">测试正则表达式</h2>
<div class="note">
    <p>其它可用的测试工具:</p>
    <ul>
        <li><a href="http://www.regexbuddy.com/" target="_blank" rel="external">RegexBuddy</a></li>
        <li><a href="http://regexpal.com/" target="_blank" rel="external">Javascript正则表达式在线测试工具</a></li>
    </ul>
</div>
<p>如果你不觉得正则表达式很难读写的话，要么你是一个天才，要么，你不是地球人。正则表达式的语法很令人头疼，即使对经常使用它的人来说也是如此。由于难于读写，容易出错，所以找一种工具对正则表达式进行测试是很有必要的。</p>
<p>不同的环境下正则表达式的一些细节是不相同的，本教程介绍的是微软 .Net Framework 4.0 下正则表达式的行为，所以，我向你推荐我编写的.Net下的工具 <a title="转到RegexTester页面" href="../../tools/regex_tester/index.htm">正则表达式测试器</a>。请参考该页面的说明来安装和运行该软件。</p>
<p>下面是Regex Tester运行时的截图：</p>
<p><img src="http://qiniu.chenall.net/post/regex_tester.png" alt="正则表达式测试器运行截图"></p>

<h2 id="metacode">元字符</h2>
<p>现在你已经知道几个很有用的元字符了，如<span class="code">\b</span>,<span class="code">.</span>,<span class="code">*</span>，还有<span class="code">\d</span>.正则表达式里还有更多的元字符，比如<span class="code">\s</span>匹配<span class="desc">任意的空白符，包括空格，制表符(Tab)，换行符，中文全角空格等</span>。<span class="code">\w</span>匹配<span class="desc">字母或数字或下划线或汉字等</span>。</p>
<p class="note important">对中文/汉字的特殊处理是由.Net提供的正则表达式引擎支持的，其它环境下的具体情况请查看相关文档。</p>
<p>下面来看看更多的例子：</p>
<p><span class="regex">\ba\w*\b</span>匹配<span class="desc">以字母<span class="part">a</span>开头的单词——先是某个单词开始处(<span class="part">\b</span>)，然后是字母<span class="part">a</span>,然后是任意数量的字母或数字(<span class="part">\w*</span>)，最后是单词结束处(<span class="part">\b</span>)</span>。</p>
<p class="note">好吧，现在我们说说正则表达式里的单词是什么意思吧：就是不少于一个的连续的<span class="code">\w</span>。不错，这与学习英文时要背的成千上万个同名的东西的确关系不大 :)</p>
<p><span class="regex">\d+</span>匹配<span class="desc">1个或更多连续的数字</span>。这里的<span class="part">+</span>是和<span class="code">*</span>类似的元字符，不同的是<span class="code">*</span>匹配<span class="desc">重复任意次(可能是0次)</span>，而<span class="code">+</span>则匹配<span class="desc">重复1次或更多次</span>。</p>
<p><span class="regex">\b\w{6}\b</span> 匹配<span class="desc">刚好6个字符的单词</span>。</p>
<table cellspacing="0">
    <caption>表1.常用的元字符</caption>
    <thead>
        <tr>
            <th scope="col">代码</th>

            <th scope="col">说明</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><span class="code">.</span></td>
            <td><span class="desc">匹配除换行符以外的任意字符</span></td>

        </tr>
        <tr>
            <td><span class="code">\w</span></td>
            <td><span class="desc">匹配字母或数字或下划线或汉字</span></td>
        </tr>
        <tr>
            <td><span class="code">\s</span></td>

            <td><span class="desc">匹配任意的空白符</span></td>
        </tr>
        <tr>
            <td><span class="code">\d</span></td>
            <td><span class="desc">匹配数字</span></td>
        </tr>
        <tr>

            <td><span class="code">\b</span></td>
            <td><span class="desc">匹配单词的开始或结束</span></td>
        </tr>
        <tr>
            <td><span class="code">^</span></td>
            <td><span class="desc">匹配字符串的开始</span></td>
        </tr>

        <tr>
            <td><span class="code">$</span></td>
            <td><span class="desc">匹配字符串的结束</span></td>
        </tr>
    </tbody>
</table>
<p class="note">正则表达式引擎通常会提供一个“测试指定的字符串是否匹配一个正则表达式”的方法，如JavaScript里的RegExp.test()方法或.NET里的Regex.IsMatch()方法。这里的匹配是指是字符串里有没有符合表达式规则的部分。如果不使用<span class="code">^</span>和<span class="code">$</span>的话，对于<span class="regex">\d{5,12}</span>而言，使用这样的方法就只能保证字符串里<span class="desc">包含5到12连续位数字</span>，而不是整个字符串就是5到12位数字。</p>
<p>元字符<span class="code">^</span>（和数字6在同一个键位上的符号）和<span class="code">$</span>都匹配一个位置，这和<span class="code">\b</span>有点类似。<span class="code">^</span>匹配你要用来查找的字符串的开头，<span class="code">$</span>匹配结尾。这两个代码在验证输入的内容时非常有用，比如一个网站如果要求你填写的QQ号必须为5位到12位数字时，可以使用：<span class="regex">^\d{5,12}$</span>。</p>
<p>这里的<span class="part">{5,12}</span>和前面介绍过的<span class="part">{2}</span>是类似的，只不过<span class="part">{2}</span>匹配<span class="desc">只能不多不少重复2次</span>，<span class="part">{5,12}</span>则是<span class="desc">重复的次数不能少于5次，不能多于12次</span>，否则都不匹配。</p>
<p>因为使用了<span class="part">^</span>和<span class="part">$</span>，所以输入的整个字符串都要用来和<span class="part">\d{5,12}</span>来匹配，也就是说整个输入<span class="desc">必须是5到12个数字</span>，因此如果输入的QQ号能匹配这个正则表达式的话，那就符合要求了。</p>
<p>和忽略大小写的选项类似，有些正则表达式处理工具还有一个处理多行的选项。如果选中了这个选项，<span class="code">^</span>和<span class="code">$</span>的意义就变成了<span class="desc">匹配行的开始处和结束处</span>。</p>

<h2 id="escape">字符转义</h2>
<p>如果你想查找元字符本身的话，比如你查找<span class="desc">.</span>,或者<span class="desc">*</span>,就出现了问题：你没办法指定它们，因为它们会被解释成别的意思。这时你就得使用<span class="code">\</span>来取消这些字符的特殊意义。因此，你应该使用<span class="regex">\.</span>和<span class="regex">\*</span>。当然，要查找<span class="desc">\</span>本身，你也得用<span class="regex">\\</span>.</p>
<p>例如：<span class="regex">deerchao\.net</span>匹配<span class="desc">deerchao.net</span>，<span class="regex">C:\\Windows</span>匹配<span class="desc">C:\Windows</span>。</p>

<h2 id="repeat">重复</h2>
<p>你已经看过了前面的<span class="code">*</span>,<span class="code">+</span>,<span class="code">{2}</span>,<span class="code">{5,12}</span>这几个匹配重复的方式了。下面是正则表达式中所有的限定符(指定数量的代码，例如*,{5,12}等)：</p>
<table cellspacing="0">
    <caption>表2.常用的限定符</caption>
    <thead>
        <tr>
            <th scope="col">代码/语法</th>
            <th scope="col">说明</th>
        </tr>

    </thead>
    <tbody>
        <tr>
            <td><span class="code">*</span></td>
            <td><span class="desc">重复零次或更多次</span></td>
        </tr>
        <tr>
            <td><span class="code">+</span></td>

            <td><span class="desc">重复一次或更多次</span></td>
        </tr>
        <tr>
            <td><span class="code">?</span></td>
            <td><span class="desc">重复零次或一次</span></td>
        </tr>
        <tr>

            <td><span class="code">{n}</span></td>
            <td><span class="desc">重复n次</span></td>
        </tr>
        <tr>
            <td><span class="code">{n,}</span></td>
            <td><span class="desc">重复n次或更多次</span></td>
        </tr>

        <tr>
            <td><span class="code">{n,m}</span></td>
            <td><span class="desc">重复n到m次</span></td>
        </tr>
    </tbody>
</table>
<p>下面是一些使用重复的例子：</p>
<p><span class="regex">Windows\d+</span>匹配<span class="desc">Windows后面跟1个或更多数字</span></p>
<p><span class="regex">^\w+</span>匹配<span class="desc">一行的第一个单词(或整个字符串的第一个单词，具体匹配哪个意思得看选项设置)</span></p>

<h2 id="charclass">字符类</h2>
<p>要想查找数字，字母或数字，空白是很简单的，因为已经有了对应这些字符集合的元字符，但是如果你想匹配没有预定义元字符的字符集合(比如元音字母a,e,i,o,u),应该怎么办？</p>
<p>很简单，你只需要在方括号里列出它们就行了，像<span class="regex">[aeiou]</span>就匹配<span class="desc">任何一个英文元音字母</span>，<span class="regex">[.?!]</span>匹配<span class="desc">标点符号(.或?或!)</span>。</p>
<p>我们也可以轻松地指定一个字符<span class="name">范围</span>，像<span class="regex">[0-9]</span>代表的含意与<span class="regex">\d</span>就是完全一致的：<span class="desc">一位数字</span>；同理<span class="regex">[a-z0-9A-Z_]</span>也完全等同于<span class="code">\w</span>（如果只考虑英文的话）。</p>
<p>下面是一个更复杂的表达式：<span class="regex">\(?0\d{2}[) -]?\d{8}</span>。</p>
<p class="note">“(”和“)”也是元字符，后面的<a href="#grouping">分组节</a>里会提到，所以在这里需要使用<a href="#escape">转义</a>。</p>
<p>这个表达式可以匹配<span class="desc">几种格式的电话号码</span>，像<span class="string">(010)88886666</span>，或<span class="string">022-22334455</span>，或<span class="string">02912345678</span>等。我们对它进行一些分析吧：首先是一个转义字符<span class="part">\(</span>,它能出现0次或1次(<span class="part">?</span>),然后是一个<span class="part">0</span>，后面跟着2个数字(<span class="part">\d{2}</span>)，然后是<span class="part">)</span>或<span class="part">-</span>或<span class="part">空格</span>中的一个，它出现1次或不出现(<span class="part">?</span>)，最后是8个数字(<span class="part">\d{8}</span>)。</p>

<h2 id="alternative">分枝条件</h2>
<p>不幸的是，刚才那个表达式也能匹配<span class="string">010)12345678</span>或<span class="string">(022-87654321</span>这样的“不正确”的格式。要解决这个问题，我们需要用到<span class="name">分枝条件</span>。正则表达式里的<span class="name">分枝条件</span>指的是有几种规则，如果满足其中任意一种规则都应该当成匹配，具体方法是用<span class="code">|</span>把不同的规则分隔开。听不明白？没关系，看例子：</p>
<p><span class="regex">0\d{2}-\d{8}|0\d{3}-\d{7}</span>这个表达式能<span class="desc">匹配两种以连字号分隔的电话号码：一种是三位区号，8位本地号(如010-12345678)，一种是4位区号，7位本地号(0376-2233445)</span>。</p>
<p><span class="regex">\(?0\d{2}\)?[- ]?\d{8}|0\d{2}[- ]?\d{8}</span>这个表达式<span class="desc">匹配3位区号的电话号码，其中区号可以用小括号括起来，也可以不用，区号与本地号间可以用连字号或空格间隔，也可以没有间隔</span>。你可以试试用分枝条件把这个表达式扩展成也支持4位区号的。</p>
<p><span class="regex">\d{5}-\d{4}|\d{5}</span>这个表达式用于匹配美国的邮政编码。美国邮编的规则是5位数字，或者用连字号间隔的9位数字。之所以要给出这个例子是因为它能说明一个问题：<strong>使用分枝条件时，要注意各个条件的顺序</strong>。如果你把它改成<span class="regex">\d{5}|\d{5}-\d{4}</span>的话，那么就只会匹配5位的邮编(以及9位邮编的前5位)。原因是匹配分枝条件时，将会从左到右地测试每个条件，如果满足了某个分枝的话，就不会去再管其它的条件了。</p>

<h2 id="grouping">分组</h2>
<p>我们已经提到了怎么重复单个字符（直接在字符后面加上限定符就行了）；但如果想要重复多个字符又该怎么办？你可以用小括号来指定<span class="name">子表达式</span>(也叫做<span class="name">分组</span>)，然后你就可以指定这个子表达式的重复次数了，你也可以对子表达式进行其它一些操作(后面会有介绍)。</p>
<p><span class="regex">(\d{1,3}\.){3}\d{1,3}</span>是一个<span class="desc">简单的IP地址匹配</span>表达式。要理解这个表达式，请按下列顺序分析它：<span class="part">\d{1,3}</span>匹配<span class="desc">1到3位的数字</span>，<span class="part">(\d{1,3}\.){3}</span>匹配<span class="desc">三位数字加上一个英文句号(这个整体也就是这个<span class="name">分组</span>)重复3次</span>，最后再加上<span class="desc">一个一到三位的数字</span>(<span class="part">\d{1,3}</span>)。</p>
<p class="note">IP地址中每个数字都不能大于255. 经常有人问我, 01.02.03.04 这样前面带有0的数字, 是不是正确的IP地址呢? 答案是: 是的, IP 地址里的数字可以包含有前导 0 (leading zeroes).</p>
<p>不幸的是，它也将匹配<span class="string">256.300.888.999</span>这种不可能存在的IP地址。如果能使用算术比较的话，或许能简单地解决这个问题，但是正则表达式中并不提供关于数学的任何功能，所以只能使用冗长的分组，选择，字符类来描述一个正确的IP地址：<span class="regex">((2[0-4]\d|25[0-5]|[01]?\d\d?)\.){3}(2[0-4]\d|25[0-5]|[01]?\d\d?)</span>。</p>
<p>理解这个表达式的关键是理解<span class="part">2[0-4]\d|25[0-5]|[01]?\d\d?</span>，这里我就不细说了，你自己应该能分析得出来它的意义。</p>

<h2 id="negation">反义</h2>
<p>有时需要查找不属于某个能简单定义的字符类的字符。比如想查找除了数字以外，其它任意字符都行的情况，这时需要用到<span class="name">反义</span>：</p>
<table cellspacing="0">
    <caption>表3.常用的反义代码</caption>
    <thead>
        <tr>
            <th scope="col">代码/语法</th>

            <th scope="col">说明</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><span class="code">\W</span></td>
            <td><span class="desc">匹配任意不是字母，数字，下划线，汉字的字符</span></td>

        </tr>
        <tr>
            <td><span class="code">\S</span></td>
            <td><span class="desc">匹配任意不是空白符的字符</span></td>
        </tr>
        <tr>
            <td><span class="code">\D</span></td>

            <td><span class="desc">匹配任意非数字的字符</span></td>
        </tr>
        <tr>
            <td><span class="code">\B</span></td>
            <td><span class="desc">匹配不是单词开头或结束的位置</span></td>
        </tr>
        <tr>

            <td><span class="code">[^x]</span></td>
            <td><span class="desc">匹配除了x以外的任意字符</span></td>
        </tr>
        <tr>
            <td><span class="code">[^aeiou]</span></td>
            <td><span class="desc">匹配除了aeiou这几个字母以外的任意字符</span></td>
        </tr>

    </tbody>
</table>
<p>例子：<span class="regex">\S+</span>匹配<span class="desc">不包含空白符的字符串</span>。</p>
<p><span class="regex">&lt;a[^&gt;]+&gt;</span>匹配<span class="desc">用尖括号括起来的以a开头的字符串</span>。</p>

<h2 id="backreference">后向引用</h2>
<p>使用小括号指定一个子表达式后，<strong>匹配这个子表达式的文本</strong>(也就是此分组捕获的内容)可以在表达式或其它程序中作进一步的处理。默认情况下，每个分组会自动拥有一个<span class="name">组号</span>，规则是：从左向右，以分组的左括号为标志，第一个出现的分组的组号为1，第二个为2，以此类推。</p>
<div class="note">
    <p>呃……其实,组号分配还不像我刚说得那么简单：</p>
    <ul>
        <li>分组0对应整个正则表达式</li>
        <li>实际上组号分配过程是要从左向右扫描两遍的：第一遍只给未命名组分配，第二遍只给命名组分配－－因此所有命名组的组号都大于未命名的组号</li>
        <li>你可以使用<span class="code">(?:exp)</span>这样的语法来剥夺一个分组对组号分配的参与权．</li>
    </ul>
</div>
<p><span class="name">后向引用</span>用于重复搜索前面某个分组匹配的文本。例如，<span class="part">\1</span>代表<span class="desc">分组1匹配的文本</span>。难以理解？请看示例：</p>
<p><span class="regex">\b(\w+)\b\s+\1\b</span>可以用来匹配<span class="desc">重复的单词</span>，像<span class="string">go go</span>, 或者<span class="string">kitty kitty</span>。这个表达式首先是<span class="desc">一个单词</span>，也就是<span class="desc">单词开始处和结束处之间的多于一个的字母或数字</span>(<span class="part">\b(\w+)\b</span>)，这个单词会被捕获到编号为1的分组中，然后是<span class="desc">1个或几个空白符</span>(<span class="part">\s+</span>)，最后是<span class="desc">分组1中捕获的内容（也就是前面匹配的那个单词）</span>(<span class="part">\1</span>)。</p>
<p>你也可以自己指定子表达式的<span class="name">组名</span>。要指定一个子表达式的组名，请使用这样的语法：<span class="code">(?&lt;Word&gt;\w+)</span>(或者把尖括号换成<span class="code">'</span>也行：<span class="code">(?'Word'\w+)</span>),这样就把<span class="part">\w+</span>的组名指定为<span class="part">Word</span>了。要反向引用这个分组<span class="name">捕获</span>的内容，你可以使用<span class="code">\k&lt;Word&gt;</span>,所以上一个例子也可以写成这样：<span class="regex">\b(?&lt;Word&gt;\w+)\b\s+\k&lt;Word&gt;\b</span>。</p>
<p>使用小括号的时候，还有很多特定用途的语法。下面列出了最常用的一些：</p>
<table cellspacing="0">
    <caption>表4.常用分组语法</caption>
    <tbody>
        <tr>
            <th scope="col">分类</th>
            <th scope="col">代码/语法</th>

            <th scope="col">说明</th>
        </tr>
        <tr>
            <th rowspan="3">捕获</th>
            <td><span class="code">(exp)</span></td>
            <td><span class="desc">匹配exp,并捕获文本到自动命名的组里</span></td>
        </tr>

        <tr>
            <td><span class="code">(?&lt;name&gt;exp)</span></td>
            <td><span class="desc">匹配exp,并捕获文本到名称为name的组里，也可以写成(?'name'exp)</span></td>
        </tr>
        <tr>
            <td><span class="code">(?:exp)</span></td>

            <td><span class="desc">匹配exp,不捕获匹配的文本，也不给此分组分配组号</span></td>
        </tr>
        <tr>
            <th rowspan="4">零宽断言</th>
            <td><span class="code">(?=exp)</span></td>
            <td><span class="desc">匹配exp前面的位置</span></td>
        </tr>

        <tr>
            <td><span class="code">(?&lt;=exp)</span></td>
            <td><span class="desc">匹配exp后面的位置</span></td>
        </tr>
        <tr>
            <td><span class="code">(?!exp)</span></td>
            <td><span class="desc">匹配后面跟的不是exp的位置</span></td>

        </tr>
        <tr>
            <td><span class="code">(?&lt;!exp)</span></td>
            <td><span class="desc">匹配前面不是exp的位置</span></td>
        </tr>
        <tr>
            <th rowspan="1">注释</th>

            <td><span class="code">(?#comment)</span></td>
            <td><span class="desc">这种类型的分组不对正则表达式的处理产生任何影响，用于提供注释让人阅读</span></td>
        </tr>
    </tbody>
</table>
<p>我们已经讨论了前两种语法。第三个<span class="code">(?:exp)</span>不会改变正则表达式的处理方式，只是这样的组匹配的内容<span class="desc">不会像前两种那样被捕获到某个组里面，也不会拥有组号</span>。“我为什么会想要这样做？”——好问题，你觉得为什么呢？</p>

<h2 id="lookaround">零宽断言</h2>
<p class="note">地球人，是不是觉得这些术语名称太复杂，太难记了？我也有同感。知道有这么一种东西就行了，它叫什么，随它去吧！人若无名，便可专心练剑；物若无名，便可随意取舍……</p>
<p>接下来的四个用于查找在某些内容(但并不包括这些内容)之前或之后的东西，也就是说它们像<span class="code">\b</span>,<span class="code">^</span>,<span class="code">$</span>那样用于指定一个位置，这个位置应该满足一定的条件(即断言)，因此它们也被称为<span class="name">零宽断言</span>。最好还是拿例子来说明吧：</p>
<p class="note">断言用来声明一个应该为真的事实。正则表达式中只有当断言为真时才会继续进行匹配。</p>
<p><span class="code">(?=exp)</span>也叫<span class="name">零宽度正预测先行断言</span>，它<span class="desc">断言自身出现的位置的后面能匹配表达式exp</span>。比如<span class="regex">\b\w+(?=ing\b)</span>，匹配<span class="desc">以ing结尾的单词的前面部分(除了ing以外的部分)</span>，如查找<span class="string">I'm singing while you're dancing.</span>时，它会匹配<span class="desc">sing</span>和<span class="desc">danc</span>。</p>
<p><span class="code">(?&lt;=exp)</span>也叫<span class="name">零宽度正回顾后发断言</span>，它<span class="desc">断言自身出现的位置的前面能匹配表达式exp</span>。比如<span class="regex">(?&lt;=\bre)\w+\b</span>会匹配<span class="desc">以re开头的单词的后半部分(除了re以外的部分)</span>，例如在查找<span class="string">reading a book</span>时，它匹配<span class="desc">ading</span>。</p>
<p>假如你想要给一个很长的数字中每三位间加一个逗号(当然是从右边加起了)，你可以这样查找需要在前面和里面添加逗号的部分：<span class="regex">((?&lt;=\d)\d{3})+\b</span>，用它对<span class="string">1234567890</span>进行查找时结果是<span class="desc">234567890</span>。</p>
<p>下面这个例子同时使用了这两种断言：<span class="regex">(?&lt;=\s)\d+(?=\s)</span>匹配<span class="desc">以空白符间隔的数字(再次强调，不包括这些空白符)</span>。</p>

<h2 id="negativelookaround">负向零宽断言</h2>
<p>前面我们提到过怎么查找<strong>不是某个字符或不在某个字符类里</strong>的字符的方法(反义)。但是如果我们只是想要<strong>确保某个字符没有出现，但并不想去匹配它</strong>时怎么办？例如，如果我们想查找这样的单词--它里面出现了字母q,但是q后面跟的不是字母u,我们可以尝试这样：</p>
<p><span class="regex">\b\w*q[^u]\w*\b</span>匹配<span class="desc">包含<strong>后面不是字母u的字母q</strong>的单词</span>。但是如果多做测试(或者你思维足够敏锐，直接就观察出来了)，你会发现，如果q出现在单词的结尾的话，像<strong>Iraq</strong>,<strong>Benq</strong>，这个表达式就会出错。这是因为<span class="part">[^u]</span>总要匹配一个字符，所以如果q是单词的最后一个字符的话，后面的<span class="part">[^u]</span>将会匹配q后面的单词分隔符(可能是空格，或者是句号或其它的什么)，后面的<span class="part">\w*\b</span>将会匹配下一个单词，于是<span class="regex">\b\w*q[^u]\w*\b</span>就能匹配整个<span class="string">Iraq fighting</span>。<span class="name">负向零宽断言</span>能解决这样的问题，因为它只匹配一个位置，并不<strong>消费</strong>任何字符。现在，我们可以这样来解决这个问题：<span class="regex">\b\w*q(?!u)\w*\b</span>。</p>
<p><span class="name">零宽度负预测先行断言</span><span class="code">(?!exp)</span>，<span class="desc">断言此位置的后面不能匹配表达式exp</span>。例如：<span class="regex">\d{3}(?!\d)</span>匹配<span class="desc">三位数字，而且这三位数字的后面不能是数字</span>；<span class="regex">\b((?!abc)\w)+\b</span>匹配<span class="desc">不包含连续字符串abc的单词</span>。</p>
<p>同理，我们可以用<span class="code">(?&lt;!exp)</span>,<span class="name">零宽度负回顾后发断言</span>来<span class="desc">断言此位置的前面不能匹配表达式exp</span>：<span class="regex">(?&lt;![a-z])\d{7}</span>匹配<span class="desc">前面不是小写字母的七位数字</span>。</p>
<p class="note">请详细分析表达式<span class="regex">(?&lt;=&lt;(\w+)&gt;).*(?=&lt;\/\1&gt;)</span>，这个表达式最能表现零宽断言的真正用途。</p>
<p>一个更复杂的例子：<span class="regex">(?&lt;=&lt;(\w+)&gt;).*(?=&lt;\/\1&gt;)</span>匹配<span class="desc">不包含属性的简单HTML标签内里的内容</span>。<span class="code">(?&lt;=&lt;(\w+)&gt;)</span>指定了这样的<span class="name">前缀</span>：<span class="desc">被尖括号括起来的单词</span>(比如可能是&lt;b&gt;)，然后是<span class="part">.*</span>(任意的字符串),最后是一个<span class="name">后缀</span><span class="part">(?=&lt;\/\1&gt;)</span>。注意后缀里的<span class="part">\/</span>，它用到了前面提过的字符转义；<span class="part">\1</span>则是一个反向引用，引用的正是<span class="desc">捕获的第一组</span>，前面的<span class="part">(\w+)</span>匹配的内容，这样如果前缀实际上是&lt;b&gt;的话，后缀就是&lt;/b&gt;了。整个表达式匹配的是&lt;b&gt;和&lt;/b&gt;之间的内容(再次提醒，不包括前缀和后缀本身)。</p>

<h2 id="commenting">注释</h2>
<p>小括号的另一种用途是通过语法<span class="code">(?#comment)</span>来包含注释。例如：<span class="regex">2[0-4]\d(?#200-249)|25[0-5](?#250-255)|[01]?\d\d?(?#0-199)</span>。</p>
<p>要包含注释的话，最好是启用“忽略模式里的空白符”选项，这样在编写表达式时能任意的添加空格，Tab，换行，而实际使用时这些都将被忽略。启用这个选项后，在#后面到这一行结束的所有文本都将被当成注释忽略掉。例如，我们可以前面的一个表达式写成这样：</p>
<pre class="regex">      (?&lt;=    # 断言要匹配的文本的前缀
  &lt;(\w+)&gt; # 查找尖括号括起来的字母或数字(即HTML/XML标签)
  )       # 前缀结束
  .*      # 匹配任意文本
  (?=     # 断言要匹配的文本的后缀
  &lt;\/\1&gt;  # 查找尖括号括起来的内容：前面是一个"/"，后面是先前捕获的标签
  )       # 后缀结束</pre>

<h2 id="greedyandlazy">贪婪与懒惰</h2>
<p>当正则表达式中包含能接受重复的限定符时，通常的行为是（在使整个表达式能得到匹配的前提下）匹配<strong>尽可能多</strong>的字符。以这个表达式为例：<span class="regex">a.*b</span>，它将会匹配<span class="desc">最长的以a开始，以b结束的字符串</span>。如果用它来搜索<span class="string">aabab</span>的话，它会匹配整个字符串<span class="desc">aabab</span>。这被称为<span class="name">贪婪</span>匹配。</p>
<p>有时，我们更需要<span class="name">懒惰</span>匹配，也就是匹配<strong>尽可能少</strong>的字符。前面给出的限定符都可以被转化为懒惰匹配模式，只要在它后面加上一个问号<span class="code">?</span>。这样<span class="regex">.*?</span>就意味着<span class="desc">匹配任意数量的重复，但是在能使整个匹配成功的前提下使用最少的重复</span>。现在看看懒惰版的例子吧：</p>
<p><span class="regex">a.*?b</span>匹配<span class="desc">最短的，以a开始，以b结束的字符串</span>。如果把它应用于<span class="string">aabab</span>的话，它会匹配<span class="desc">aab（第一到第三个字符）</span>和<span class="desc">ab（第四到第五个字符）</span>。</p>
<p class="note">为什么第一个匹配是aab（第一到第三个字符）而不是ab（第二到第三个字符）？简单地说，因为正则表达式有另一条规则，比懒惰／贪婪规则的优先级更高：最先开始的匹配拥有最高的优先权——The match that begins earliest wins。</p>
<table cellspacing="0">
    <caption>表5.懒惰限定符</caption>
    <thead>
        <tr>
            <th scope="col">代码/语法</th>
            <th scope="col">说明</th>

        </tr>
    </thead>
    <tbody>
        <tr>
            <td><span class="code">*?</span></td>
            <td><span class="desc">重复任意次，但尽可能少重复</span></td>
        </tr>
        <tr>

            <td><span class="code">+?</span></td>
            <td><span class="desc">重复1次或更多次，但尽可能少重复</span></td>
        </tr>
        <tr>
            <td><span class="code">??</span></td>
            <td><span class="desc">重复0次或1次，但尽可能少重复</span></td>
        </tr>

        <tr>
            <td><span class="code">{n,m}?</span></td>
            <td><span class="desc">重复n到m次，但尽可能少重复</span></td>
        </tr>
        <tr>
            <td><span class="code">{n,}?</span></td>
            <td><span class="desc">重复n次以上，但尽可能少重复</span></td>

        </tr>
    </tbody>
</table>

<h2 id="regexoptions">处理选项</h2>
<p class="note">在C#中，你可以使用<a href="http://msdn2.microsoft.com/zh-cn/library/h5845fdz.aspx" title="MSDN 相关文档" target="_blank" rel="external">Regex(String, RegexOptions)构造函数</a>来设置正则表达式的处理选项。如：Regex regex = new Regex(@"\ba\w{6}\b", RegexOptions.IgnoreCase);</p>
<p>上面介绍了几个选项如忽略大小写，处理多行等，这些选项能用来改变处理正则表达式的方式。下面是.Net中常用的正则表达式选项：</p>
<table cellspacing="0">
    <caption>表6.常用的处理选项</caption>
    <thead>
        <tr>
            <th scope="col">名称</th>
            <th scope="col">说明</th>
        </tr>

    </thead>
    <tbody>
        <tr>
            <td>IgnoreCase(忽略大小写)</td>
            <td>匹配时不区分大小写。</td>
        </tr>
        <tr>
            <td>Multiline(多行模式)</td>

            <td>更改<span class="code">^</span>和<span class="code">$</span>的含义，使它们分别在任意一行的行首和行尾匹配，而不仅仅在整个字符串的开头和结尾匹配。(在此模式下,<span class="code">$</span>的精确含意是:匹配\n之前的位置以及字符串结束前的位置.) </td>
        </tr>
        <tr>
            <td>Singleline(单行模式)</td>
            <td>更改<span class="code">.</span>的含义，使它与每一个字符匹配（包括换行符\n）。 </td>

        </tr>
        <tr>
            <td>IgnorePatternWhitespace(忽略空白)</td>
            <td>忽略表达式中的非转义空白并启用由<span class="code">#</span>标记的注释。</td>
        </tr>
        <tr>
            <td>ExplicitCapture(显式捕获)</td>
            <td>仅捕获已被显式命名的组。</td>
        </tr>
    </tbody>
</table>
<p>一个经常被问到的问题是：是不是只能同时使用多行模式和单行模式中的一种？答案是：不是。这两个选项之间没有任何关系，除了它们的名字比较相似（以至于让人感到疑惑）以外。</p>

<h2 id="balancedgroup">平衡组/递归匹配</h2>
<p class="important note">这里介绍的平衡组语法是由.Net Framework支持的；其它语言／库不一定支持这种功能，或者支持此功能但需要使用不同的语法。</p>
<p>有时我们需要匹配像<span class="desc">( 100 * ( 50 + 15 ) )这样的可嵌套的层次性结构</span>，这时简单地使用<span class="code">\(.+\)</span>则只会匹配到最左边的左括号和最右边的右括号之间的内容(这里我们讨论的是贪婪模式，懒惰模式也有下面的问题)。假如原来的字符串里的左括号和右括号出现的次数不相等，比如<span class="string">( 5 / ( 3 + 2 ) ) )</span>，那我们的匹配结果里两者的个数也不会相等。有没有办法在这样的字符串里匹配到最长的，配对的括号之间的内容呢？</p>
<p>为了避免<span class="code">(</span>和<span class="code">\(</span>把你的大脑彻底搞糊涂，我们还是用尖括号代替圆括号吧。现在我们的问题变成了如何把<span class="string">xx &lt;aa &lt;bbb&gt; &lt;bbb&gt; aa&gt; yy</span>这样的字符串里，最长的配对的尖括号内的内容捕获出来？</p>
<p>这里需要用到以下的语法构造：</p>
<ul>
    <li><span class="code">(?'group')</span> 把捕获的内容命名为group,并压入<span class="name">堆栈(Stack)</span></li>
    <li><span class="code">(?'-group')</span> 从堆栈上弹出最后压入堆栈的名为group的捕获内容，如果堆栈本来为空，则本分组的匹配失败</li>
    <li><span class="code">(?(group)yes|no)</span> 如果堆栈上存在以名为group的捕获内容的话，继续匹配yes部分的表达式，否则继续匹配no部分</li>

    <li><span class="code">(?!)</span> 零宽负向先行断言，由于没有后缀表达式，试图匹配总是失败</li>
</ul>
<p class="note">如果你不是一个程序员（或者你自称程序员但是不知道堆栈是什么东西），你就这样理解上面的三种语法吧：第一个就是在黑板上写一个"group"，第二个就是从黑板上擦掉一个"group"，第三个就是看黑板上写的还有没有"group"，如果有就继续匹配yes部分，否则就匹配no部分。</p>
<p>我们需要做的是每碰到了左括号，就在压入一个"Open",每碰到一个右括号，就弹出一个，到了最后就看看堆栈是否为空－－如果不为空那就证明左括号比右括号多，那匹配就应该失败。正则表达式引擎会进行回溯(放弃最前面或最后面的一些字符)，尽量使整个表达式得到匹配。</p>
<pre class="regex">&lt;                         #最外层的左括号
[^&lt;&gt;]*                #最外层的左括号后面的不是括号的内容
(
    (
        (?'Open'&lt;)    #碰到了左括号，在黑板上写一个"Open"
        [^&lt;&gt;]*       #匹配左括号后面的不是括号的内容
    )+
    (
        (?'-Open'&gt;)   #碰到了右括号，擦掉一个"Open"
        [^&lt;&gt;]*        #匹配右括号后面不是括号的内容
    )+
)*
(?(Open)(?!))         #在遇到最外层的右括号前面，判断黑板上还有没有没擦掉的"Open"；如果还有，则匹配失败

&gt;                         #最外层的右括号</pre>
<p>平衡组的一个最常见的应用就是匹配HTML,下面这个例子可以匹配<span class="desc">嵌套的&lt;div&gt;标签</span>：<span class="regex">&lt;div[^&gt;]*&gt;[^&lt;&gt;]*(((?'Open'&lt;div[^&gt;]*&gt;)[^&lt;&gt;]*)+((?'-Open'&lt;/div&gt;)[^&lt;&gt;]*)+)*(?(Open)(?!))&lt;/div&gt;</span>.</p>

<h2 id="more">还有些什么东西没提到</h2>
<p>上边已经描述了构造正则表达式的大量元素，但是还有很多没有提到的东西。下面是一些未提到的元素的列表，包含语法和简单的说明。你可以在网上找到更详细的参考资料来学习它们--当你需要用到它们的时候。如果你安装了MSDN Library,你也可以在里面找到.net下正则表达式详细的文档。这里的介绍很简略，如果你需要更详细的信息，而又没有在电脑上安装MSDN Library,可以查看<a href="http://msdn.microsoft.com/zh-cn/library/az24scfc.aspx" target="_blank" rel="external">关于正则表达式语言元素的MSDN在线文档</a>。</p>
<table cellspacing="0">
    <caption>表7.尚未详细讨论的语法</caption>
    <thead>
        <tr>
            <th scope="col">代码/语法</th>

            <th scope="col">说明</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><span class="code">\a</span></td>
            <td><span class="desc">报警字符(打印它的效果是电脑嘀一声)</span></td>

        </tr>
        <tr>
            <td><span class="code">\b</span></td>
            <td><span class="desc">通常是单词分界位置，但如果在字符类里使用代表退格</span></td>
        </tr>
        <tr>
            <td><span class="code">\t</span></td>

            <td><span class="desc">制表符，Tab</span></td>
        </tr>
        <tr>
            <td><span class="code">\r</span></td>
            <td><span class="desc">回车</span></td>
        </tr>
        <tr>

            <td><span class="code">\v</span></td>
            <td><span class="desc">竖向制表符</span></td>
        </tr>
        <tr>
            <td><span class="code">\f</span></td>
            <td><span class="desc">换页符</span></td>
        </tr>

        <tr>
            <td><span class="code">\n</span></td>
            <td><span class="desc">换行符</span></td>
        </tr>
        <tr>
            <td><span class="code">\e</span></td>
            <td><span class="desc">Escape</span></td>

        </tr>
        <tr>
            <td><span class="code">\0nn</span></td>
            <td><span class="desc">ASCII代码中八进制代码为nn的字符</span></td>
        </tr>
        <tr>
            <td><span class="code">\xnn</span></td>

            <td><span class="desc">ASCII代码中十六进制代码为nn的字符</span></td>
        </tr>
        <tr>
            <td><span class="code">\unnnn</span></td>
            <td><span class="desc">Unicode代码中十六进制代码为nnnn的字符</span></td>
        </tr>
        <tr>

            <td><span class="code">\cN</span></td>
            <td><span class="desc">ASCII控制字符。比如\cC代表Ctrl+C</span></td>
        </tr>
        <tr>
            <td><span class="code">\A</span></td>
            <td><span class="desc">字符串开头(类似^，但不受处理多行选项的影响)</span></td>
        </tr>

        <tr>
            <td><span class="code">\Z</span></td>
            <td><span class="desc">字符串结尾或行尾(不受处理多行选项的影响)</span></td>
        </tr>
        <tr>
            <td><span class="code">\z</span></td>
            <td><span class="desc">字符串结尾(类似$，但不受处理多行选项的影响)</span></td>

        </tr>
        <tr>
            <td><span class="code">\G</span></td>
            <td><span class="desc">当前搜索的开头</span></td>
        </tr>
        <tr>
            <td><span class="code">\p{name}</span></td>

            <td><span class="desc">Unicode中命名为name的字符类，例如\p{IsGreek}</span></td>
        </tr>
        <tr>
            <td><span class="code">(?&gt;exp)</span></td>
            <td><span class="desc">贪婪子表达式</span></td>
        </tr>
        <tr>

            <td><span class="code">(?&lt;x&gt;-&lt;y&gt;exp)</span></td>
            <td><span class="desc">平衡组</span></td>
        </tr>
        <tr>
            <td><span class="code">(?im-nsx:exp)</span></td>

            <td><span class="desc">在子表达式exp中改变处理选项</span></td>
        </tr>
        <tr>
            <td><span class="code">(?im-nsx)</span></td>
            <td><span class="desc">为表达式后面的部分改变处理选项</span></td>
        </tr>
        <tr>

            <td><span class="code">(?(exp)yes|no)</span></td>
            <td><span class="desc">把exp当作零宽正向先行断言，如果在这个位置能匹配，使用yes作为此组的表达式；否则使用no</span></td>
        </tr>
        <tr>
            <td><span class="code">(?(exp)yes)</span></td>
            <td><span class="desc">同上，只是使用空表达式作为no</span></td>
        </tr>

        <tr>
            <td><span class="code">(?(name)yes|no)</span></td>
            <td><span class="desc">如果命名为name的组捕获到了内容，使用yes作为表达式；否则使用no</span></td>
        </tr>
        <tr>
            <td><span class="code">(?(name)yes)</span></td>
            <td><span class="desc">同上，只是使用空表达式作为no</span></td>

        </tr>
    </tbody>
</table>

<h2 id="contact">联系作者</h2>
<p>好吧,我承认,我骗了你,读到这里你肯定花了不止30分钟.相信我,这是我的错,而不是因为你太笨.我之所以说"30分钟",是为了让你有信心,有耐心继续下去.既然你看到了这里,那证明我的阴谋成功了.被忽悠的感觉很爽吧？</p>
<p>要投诉我,或者觉得我其实可以忽悠得更高明,欢迎来<a href="http://weibo.com/deerchao/" target="_blank" rel="external"><img src="http://deerchao.net/images/weibo.png" alt="">我的微博</a>让我知道. 如果你有关于正则表达式的问题, 可以到 <a href="http://www.stackoverflow.com" target="_blank" rel="external"><img src="../../images/stackoverflow.png" alt="">stackoverflow</a> 网站上提问, 记得要添加 regex 标签. 如果你更习惯于用中文交流, 可以到微博上用 #正则# 标签提出问题.</p>

<h2 id="resources">网上的资源及本文参考文献</h2>
<ul>
    <li><a href="http://book.360buy.com/11070361.html?sid=deerchao&amp;t=1" target="_blank" rel="external">精通正则表达式（第3版）</a></li>
    <li><a href="http://msdn.microsoft.com/library/chs/default.asp?url=/library/CHS/jscript7/html/jsreconintroductiontoregularexpressions.asp" target="_blank" rel="external">微软的正则表达式教程</a></li>
    <li><a href="http://msdn2.microsoft.com/zh-cn/library/system.text.regularexpressions.regex.aspx" target="_blank" rel="external">System.Text.RegularExpressions.Regex类(MSDN)</a></li>
    <li><a href="http://www.regular-expressions.info/" target="_blank" rel="external">专业的正则表达式教学网站(英文)</a></li>
    <li><a href="http://weblogs.asp.net/whaggard/archive/2005/02/20/377025.aspx" target="_blank" rel="external">关于.Net下的平衡组的详细讨论（英文）</a></li>
</ul>

<h2 id="updatelog">更新纪录</h2>
<ol>
    <li>2006-3-27 第一版</li>
    <li>2006-10-12 第二版
        <ul>
            <li>修正了几个细节上的错误和不准确的地方</li>
            <li>增加了对处理中文时的一些说明</li>
            <li>更改了几个术语的翻译（采用了MSDN的翻译方式）</li>
            <li>增加了平衡组的介绍</li>
            <li>放弃了对The Regulator的介绍，改用Regex Tester</li>
        </ul>
    </li>
    <li>2007-3-12 V2.1
        <ul>
            <li>修正了几个小的错误</li>

            <li>增加了对处理选项(RegexOptions)的介绍</li>
        </ul>
    </li>
    <li>2007-5-28 V2.2
        <ul>
            <li>重新组织了对零宽断言的介绍</li>
            <li>删除了几个不太合适的示例，添加了几个实用的示例</li>
            <li>其它一些微小的更改</li>

        </ul>
    </li>
    <li>2007-8-3 V2.21
        <ul>
            <li>修改了几处文字错误</li>
            <li>修改/添加了对$,\b的精确说明</li>
            <li>承认了作者是个骗子</li>
            <li>给RegexTester添加了Singleline选项的相关功能</li>

        </ul>
    </li>
    <li>2008-4-13 v2.3
        <ul>
            <li>调整了部分章节的次序</li>
            <li>修改了页面布局，删除了专门的参考节</li>
            <li>针对读者的反馈，调整了部分内容</li>
        </ul>
    </li>
    <li>2009-4-11 v2.31
        <ul>
            <li>修改了几处文字错误</li>
            <li>添加了一些注释说明</li>
            <li>调整了一些措词</li>
        </ul>
    </li>
    <li>2011-8-17 v2.32
        <ul>
            <li>更改了工具介绍，换用自行开发的正则表达式测试器</li>
        </ul>
    </li>
    <li>2013-1-10 v2.33
        <ul>
            <li>说明包含前导0的IP地址是合法的</li>
        </ul>
    </li>
</ol>
</div>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <div class="categories"style="display:inline">归类<span class="breadcrumb fa fa-folder"><li><a href="/categories/实用文集/" itemprop="url"><span itemprop="title" >实用文集</span></a></li></span><span class="breadcrumb"><li><a href="/categories/程序设计/" itemprop="url"><span itemprop="title" >程序设计</span></a></li><li><a href="/categories/程序设计/资料/" itemprop="url">资料</a></li></span></div> | <span class="tags">标签 <a href="/tags/正则/" class="label label-primary" itemprop="url"><span itemprop="title">正则</span></a></span> | <span class="time">最近更新:<time title="2014-02-26 19:52:59"datetime="2014-02-26 19:52:59"> 2014-02-26</time></span> | <span class="comment-link">
<a href="http://chenall.net/post/post43/#comments" class="ds-thread-count comment-link" data-thread-key="43" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/post/post41/">[GRUB4DOS] 未公开特性：扇区序列文件的长度指定，精确到字节</a></h1>
      
        <span>发表于<time datetime="2009-01-16T14:12:50.000Z"> <a href="/post/post41/">2009-01-16</a></time></span>      
    </header>
    
    
    <div class="entry" >
      
        <blockquote>


<p>我觉得这是一个未公开的特性，因为我从未在其它地方见到过有关这一特性的描述。</p>
<p>在 grub 中，我们可以用 <em>(hd0)12345+8</em> 或者 <em>(hd0,0)2+20,33+5,87+300</em> 之类的表达法来表示一个磁盘文件。这种表示法，就是扇区序列表示法。既然是扇区序列，那么这样的文件，就只能以扇区对齐（也即必须为 <code>512</code> 的整数倍），也就是说，不可能表示一个<code>256</code> 字节的文件，也不可能表示一个 <code>513</code> 字节的文件。</p>
<p>对于内存文件来讲，也是如此，<em>(md)xxxxx+yyyyy</em> 和 <em>(rd)xxxxx+yyyyy</em> 这类表达法都是表示扇区的整数倍，这样大小的文件。</p>
<p>然而有时候，我们确实需要精确到字节的扇区序列文件。比如在硬盘上（或内存中）有一个 <strong>image.gz</strong> 文件，如果你不指定这个文件的精确大小，那么<code>grub</code> 就不能正常解压这个文件，这是因为解压程序依赖于这个 gz 的精确长度，你多一个字节或少一个字节，都可能会失败的。</p>
<p>怎样指定扇区序列的精确长度呢？这可能是 <code>GNU GRUB</code> 早期的开发者早就开发的功能了，只是没有公开，也许是因为开发者觉得这个功能的实现方法以后说不定会改变，就不适合公开了。扇区序列的精确长度（以字节计），是直接加在扇区序列表达法之后的，用逗号与扇区序列隔开。例如，你想打印出 MBR 中开头的 <code>466</code> 个字节，就可以这样：</p>
<pre><code>cat --hex (hd0)+1,466
</code></pre><p>其中 <em>(hd0)+1</em> 是扇区序列，<code>466</code> 表示只从扇区序列中取出 <code>466</code> 字节作为文件的长度。</p>
<p>再举一例：</p>
<pre><code>cat --hex (hd0)+63,800+63,64400
</code></pre><p>如果没有结尾的&ldquo;<code>,64400</code>&rdquo;，那么，&ldquo;<code>(hd0)+63,800+63</code>&rdquo;就表示不连续的两个扇区序列所组成的文件，每个连续的序列都有 <code>63</code> 个扇区，所以文件总共有 <code>126</code> 个扇区。文件的长度就是 <em>126x512=64512</em> 字节。加上了结尾的&ldquo;<code>,64400</code>&rdquo;之后，文件变小了，它表示的文件长度为 <code>64400</code>。当然你不应该指定一个长度，使得它比扇区序列的总长度还要大。</p>
<p>但是，如果你想只访问 MBR 中的分区表，那是不行的，这种表达法不支持从扇区序列的中间截取文件，只支持从扇区序列的最开头截取一定长度的文件。</p>
<p>由于这种表达法也是有缺点的，因此我们也仍然不公开这一特性。今后说不定会出现一种更合理的表达方式。</p>
<footer><strong>不点</strong><cite><a href="http://bbs.znpc.net/viewthread.php?tid=4532" target="_blank" rel="external">时空论坛</a></cite></footer></blockquote>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <div class="categories"style="display:inline">归类<span class="breadcrumb fa fa-folder"><li><a href="/categories/GRUB4DOS/" itemprop="url"><span itemprop="title" >GRUB4DOS</span></a></li><li><a href="/categories/GRUB4DOS/资料/" itemprop="url">资料</a></li></span></div> | <span class="tags">标签 <a href="/tags/GRUB4DOS/" class="label label-primary" itemprop="url"><span itemprop="title">GRUB4DOS</span></a><a href="/tags/资料/" class="label label-success" itemprop="url"><span itemprop="title">资料</span></a></span> | <span class="time">最近更新:<time title="2014-02-26 19:52:59"datetime="2014-02-26 19:52:59"> 2014-02-26</time></span> | <span class="comment-link">
<a href="http://chenall.net/post/post41/#comments" class="ds-thread-count comment-link" data-thread-key="41" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/post/post40/">GRUB4DOS一个比较变态的用法(利用GRUB4DOS作为文件中转站)</a></h1>
      
        <span>发表于<time datetime="2009-01-15T04:56:42.000Z"> <a href="/post/post40/">2009-01-15</a></time></span>      
    </header>
    
    
    <div class="entry" >
      
        <p>利用GRUB4DOS的map功能来中转文件.使得DOS下可以访问<br>例子:  </p>
<pre><code>map --mem /minipe/system.wim (hd1)
map --hook
</code></pre><p>说明: 把/MINIPE.SYSTEM.WIM文件映射为(hd1)硬盘.<code>GRUB4DOS</code>会把这个文件的内容作为一个磁盘分区(hd1,0).</p>
<p>也就是把一个文件虚拟成一个分区.</p>
<p>然后进到入DOS后,利用一个磁盘工具把上面的(hd1,0)分区保存为一个文件.<br>例子:用todisk</p>
<pre><code>todisk 2:1=q to (c:\system.wim)
</code></pre><p>把第二磁盘的第一分区保存为system.wim(即还原过程).</p>
<p>这个方法在某些情况下很有用处.由于1个磁盘扇区是512字节,所以最后得到的文件会是512字节的倍数(不足补00),所以只适用于对文件内容长度要求不是很严格的地方.</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <div class="categories"style="display:inline">归类<span class="breadcrumb fa fa-folder"><li><a href="/categories/GRUB4DOS/" itemprop="url"><span itemprop="title" >GRUB4DOS</span></a></li><li><a href="/categories/GRUB4DOS/综合/" itemprop="url">综合</a></li></span><span class="breadcrumb"><li><a href="/categories/实用文集/" itemprop="url"><span itemprop="title" >实用文集</span></a></li></span></div> | <span class="tags">标签 <a href="/tags/GRUB4DOS/" class="label label-primary" itemprop="url"><span itemprop="title">GRUB4DOS</span></a></span> | <span class="time">最近更新:<time title="2014-02-26 19:52:59"datetime="2014-02-26 19:52:59"> 2014-02-26</time></span> | <span class="comment-link">
<a href="http://chenall.net/post/post40/#comments" class="ds-thread-count comment-link" data-thread-key="40" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/post/post38/">解决电脑远程登陆出现 “远程计算机已结束连接”</a></h1>
      
        <span>发表于<time datetime="2008-12-30T07:22:10.000Z"> <a href="/post/post38/">2008-12-30</a></time></span>      
    </header>
    
    
    <div class="entry" >
      
        <h2 id="此贴转自时空论坛_原贴:_http://bbs-znpc-net/viewthread-php?tid=3304">此贴转自时空论坛 原贴: <a href="http://bbs.znpc.net/viewthread.php?tid=3304" target="_blank" rel="external">http://bbs.znpc.net/viewthread.php?tid=3304</a></h2>
<p>   转到这里留个备份,以后再碰到这个问题比较好找.^_^</p>
<h2 id="解决电脑远程登陆出现_远程计算机已结束连接">解决电脑远程登陆出现 <strong>远程计算机已结束连接</strong></h2>
<p>   此问题在远程系统是GHOST版的windowsxp时出现的比较普遍。</p>
<h2 id="_现象描述："><strong> 现象描述：</strong></h2>
<p>用windowsxp自带的<strong>远程桌面</strong>功能连接到另外一台windowsxp电脑时，在连接的瞬间便<br>弹出<em>远程计算机已结束连接</em>的出错窗口。</p>
<h2 id="解决方法："><strong>解决方法：</strong></h2>
<p>打开注册表<br>找到[HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Enum\Root\RDPDR\<br>在左侧的 RDPDR 上右键-<strong>权限</strong>，选上<strong>完全控制</strong>,把以下注册表内容.复制到记事本保存为reg文件.<br>再导入注册表:</p>
<pre><code>Windows Registry Editor Version 5.00

[HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Enum\Root\RDPDR\0000]
&quot;ClassGUID&quot;=&quot;{4D36E97D-E325-11CE-BFC1-08002BE10318}&quot;
&quot;Class&quot;=&quot;System&quot;
&quot;HardwareID&quot;=hex(7):52,00,4f,00,4f,00,54,00,5c,00,52,00,44,00,50,00,44,00,52,00,00,00,00,00
&quot;Driver&quot;=&quot;{4D36E97D-E325-11CE-BFC1-08002BE10318}\0030&quot;
&quot;Mfg&quot;=&quot;(标准系统设备)&quot;
&quot;Service&quot;=&quot;rdpdr&quot;
&quot;DeviceDesc&quot;=&quot;终端服务器设备重定向器&quot;
&quot;ConfigFlags&quot;=dword:00000000
&quot;Capabilities&quot;=dword:00000000
</code></pre><p>最后，把控制面板－管理工具－服务中的 <strong>Remote Desktop Help Session Manager</strong> 和 <strong>Telnet</strong> 服务开启，<br>将电脑重启，远程桌面管理就可以恢复正常了。</p>
<p>注:可能是因为做GHOST系统时,为了省事在删除硬件时直接使用了devcon remove *,所以才会出现这个问题.</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <div class="categories"style="display:inline">归类<span class="breadcrumb fa fa-folder"><li><a href="/categories/杂七杂八/" itemprop="url"><span itemprop="title" >杂七杂八</span></a></li></span><span class="breadcrumb"><li><a href="/categories/系统相关/" itemprop="url"><span itemprop="title" >系统相关</span></a></li></span></div> | <span class="tags">标签 <a href="/tags/远程桌面/" class="label label-primary" itemprop="url"><span itemprop="title">远程桌面</span></a><a href="/tags/转载/" class="label label-success" itemprop="url"><span itemprop="title">转载</span></a><a href="/tags/实用技术/" class="label label-info" itemprop="url"><span itemprop="title">实用技术</span></a><a href="/tags/解决/" class="label label-warning" itemprop="url"><span itemprop="title">解决</span></a></span> | <span class="time">最近更新:<time title="2014-02-26 19:52:59"datetime="2014-02-26 19:52:59"> 2014-02-26</time></span> | <span class="comment-link">
<a href="http://chenall.net/post/post38/#comments" class="ds-thread-count comment-link" data-thread-key="38" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/post/post37/">[分享]成功利用GPXE启动无盘WINDOWS 2003.</a></h1>
      
        <span>发表于<time datetime="2008-12-23T08:32:23.000Z"> <a href="/post/post37/">2008-12-23</a></time></span>      
    </header>
    
    
    <div class="entry" >
      
        <p>留个贴子纪念下,(具体实现方法网上有许多介绍,我就不再写了^_^).</p>
<p>使用STARWIND作为ISCSI服务端,在DHCP上设定使用GPXE启动,并设定好ROOT-PATH目录(DHCP 017选项)为iscsi:192.168.0.2::::win2003,启动成功了,</p>
<p>顺便制了一个专门作为系统维护专用的ISCSI磁盘,以后哪台电脑出问题要重装之类的可就方便了,我以前是在每台电脑上都安装一个维护工具箱,现在用ISCSI就不用了,</p>
<p>只要PXE启动选择用这个启动就会在客户端虚拟出一个磁盘来,也方便更新,,</p>
<p>而且用这个磁盘里面的GHO文件来安装系统可比以前用网络映射方式快多了,</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <div class="categories"style="display:inline">归类<span class="breadcrumb fa fa-folder"><li><a href="/categories/个人日记/" itemprop="url"><span itemprop="title" >个人日记</span></a></li></span></div> | <span class="tags">标签 <a href="/tags/GPXE/" class="label label-primary" itemprop="url"><span itemprop="title">GPXE</span></a><a href="/tags/ISCSI/" class="label label-success" itemprop="url"><span itemprop="title">ISCSI</span></a><a href="/tags/SCSI/" class="label label-info" itemprop="url"><span itemprop="title">SCSI</span></a><a href="/tags/WIN2003/" class="label label-warning" itemprop="url"><span itemprop="title">WIN2003</span></a><a href="/tags/无盘2003/" class="label label-primary" itemprop="url"><span itemprop="title">无盘2003</span></a></span> | <span class="time">最近更新:<time title="2014-02-26 19:52:59"datetime="2014-02-26 19:52:59"> 2014-02-26</time></span> | <span class="comment-link">
<a href="http://chenall.net/post/post37/#comments" class="ds-thread-count comment-link" data-thread-key="37" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>





<ul id="pagination" class="pagination pagination-lg">
  <li><a class="extend prev" rel="prev" href="/page/12/">&laquo;</a></li><li><a class="page-number" href="/">1</a></li><li><a class="page-number" href="/page/2/">2</a></li><li><span class="space">&hellip;</span></li><li><a class="page-number" href="/page/10/">10</a></li><li><a class="page-number" href="/page/11/">11</a></li><li><a class="page-number" href="/page/12/">12</a></li><li class="active"><li><span class="page-number current">13</span></li></li><li><a class="page-number" href="/page/14/">14</a></li><li><a class="page-number" href="/page/14/">14</a></li><li><a class="page-number" href="/page/15/">15</a></li><li><a class="extend next" rel="next" href="/page/14/">&raquo;</a></li>
  <div class="clearfix"></div>
</ul></div><!--wapper-->
       </div><!-- ID main-col END -->
       <aside id="sidebar" class="alignright col-sx-6 col-sm-4 col-md-3 col-lg-3">
<div id="widget_swiftype" class="widget panel panel-primary">
    
<form class="input-group">
<input type="text" id="st-search-input" class="form-control" placeholder="搜索" autocomplete="off" autocorrect="off" autocapitalize="off" style="outline: none;">
<span class="input-group-btn"><button class="btn btn-default" type="search"><i class="fa fa-search"></i></button></span>
</form></div>

<div id="widget_google_cse" class="widget panel panel-primary">
    
<gcse:searchbox-only defaultToRefinement="chenall.net" resultsUrl="/search/" newWindow="false"></gcse:searchbox-only>
</div>

<div id="widget_category" class="widget panel panel-primary">
  <div class="panel-heading">分类</div>  <div data-src='category' class='ajax_widgets'>正在加载...</div>
</div>

<div id="widget_latest_update_posts" class="widget panel panel-primary">
  <div class="panel-heading">最近更新</div>  <div data-src='latest_update_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_random_posts" class="widget panel panel-primary">
  <div class="panel-heading">随机文章</div>  <div class='hexo_random_posts' data-count=8></div></div>

<div id="widget_google_sidebar" class="widget panel panel-primary">
  <div class="panel-heading">赞助商</div>  
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0028617410393728"
     data-ad-slot="2577551260"
     data-ad-format="rectangle"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>

<div id="widget_tagcloud" class="widget panel panel-primary">
  <div class="panel-heading">标签云</div>  <div data-src='tagcloud' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_sina_weiboshow" class="widget panel panel-primary">
  <div class="panel-heading">新浪微搏秀</div>  <iframe width="100%" height="600" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=600&fansRow=0&ptype=0&speed=0&skin=5&isTitle=0&noborder=1&isWeibo=1&isFans=0&uid=1082888172&verifier=1a4946c5&dpc=1"></iframe>
</div>

<div id="widget_recent_comments" class="widget panel panel-primary">
  <div class="panel-heading">最近评论</div>  

<div class="list-group-item ds-recent-comments" data-num-items="6" data-show-avatars="1" data-show-time="1" data-show-title="1" data-show-admin="1" data-excerpt-length="50"></div>



</div>

</aside>
       <div class="clearfix"></div>
     </div><!-- row END -->
  </div>
  <footer id="footer" class="container">
  <div class="panel panel-info">
  <section id='footer_widget'></section>  <div class="panel-footer">
  <div id="site-info">
    <span class='author'>
  
  &copy; 2008-2015 chenall
  
    &nbsp;&nbsp;</span>
  <a href='http://www.miibeian.gov.cn/'>闽ICP备14002519号-1</a></span>
  <span id='analytics-51la'>
<script language="javascript" type="text/javascript" src="http://js.users.51.la/3214078.js"></script>
<noscript><a href="http://www.51.la/?3214078" target="_blank"><img alt="&#x6211;&#x8981;&#x5566;&#x514D;&#x8D39;&#x7EDF;&#x8BA1;" src="http://img.users.51.la/3214078.asp" style="border:none" /></a></noscript>
</span><span id='analytics-google'>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-30310093-1']);
  _gaq.push(['_trackPageview']);
  _js2load.push({src:('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'});
</script></span><span id='analytics-baidu'>
<script>
var _hmt = _hmt || [];
_js2load.push({src:"//hm.baidu.com/hm.js?41a3a9225fc0df0d53086baea0f90d96"});
</script>
</span>  </div>
  <div id="copyright">Blog powered by <a href='http://hexo.io/'  title="本站由hexo V2.8.3 生成"><strong>hexo</strong></a> Theme <strong><a href='https://github.com/chenall/hexo-theme-chenall'>chenall V2.2</a></strong><span class="pull-right"> 更新时间: <em>2015-05-10 17:32:18</em></span></div>
</div>
<div class="clearfix"></div>
  </div>
  </footer>
  
        <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>        
        <script src="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/js/bootstrap.min.js"></script>        
            <script type="text/javascript"> (function(win,doc){ var s = doc.createElement("script"), h = doc.getElementsByTagName("head")[0]; if (!win.alimamatk_show) { s.charset = "gbk"; s.async = true; s.src = "http://a.alimama.cn/tkapi.js"; h.insertBefore(s, h.firstChild); }; var o = { pid: "mm_14266497_2425855_13670245",}; win.alimamatk_onload = win.alimamatk_onload || []; win.alimamatk_onload.push(o); })(window,document);</script>    
                
            
<div id='swiftype-searchinfo' style='display: none;'><div class="alert alert-info"> 正在搜索中，稍后将在这里显示结果。。。。</div></div>
<script type="text/javascript">
var Swiftype = window.Swiftype || {key:'P473Cjp95e3bFhiCP88w',renderStyle: 'inline' };
_js2load.push({src:"//s.swiftypecdn.com/embed.js"});
$(function(){$('#main-col').prepend('<div id="st-results-container"></div>');$('form').has('#st-search-input').submit(function(){$('#st-results-container').html($('#swiftype-searchinfo').html());})});
</script>
    
            <script>_js2load.push({src:(document.location.protocol == 'https:' ? 'https:' : 'http:') + '//www.google.com/cse/cse.js?cx=013748367689400048621:dmsqkhtcvbm'});</script>
    
            <script type="text/javascript">
var duoshuoQuery = {short_name:"chenall"};
_js2load.push({src:'http://static.duoshuo.com/embed.js',charset:'UTF-8'});
</script>
    
        <script src="http://cdn.bootcss.com/prettify/r298/prettify.min.js"></script>    <script type="text/javascript">
   var lang=["bsh", "c", "cc", "cpp", "cs", "csh", "cyc", "cv", "htm", "html",
    "java", "js", "m", "mxml", "perl", "pl", "pm", "py", "rb", "sh",
    "xhtml", "xml", "xsl"];
   var pretty_base='';
   $('script').each(function(){
	var c = $(this).attr('src');
	if (!c)
	    return;
	if (c.match(/(\/)?prettify(\.min)?\.js/i))
	{
	    var index = c.lastIndexOf('/');
	    if (index != -1)
		pretty_base = c.substr(0,index + 1);
	    return false;
	}
   })
   $('pre code').each(function(){
	var c = $(this).attr('class')
	if (!c)
	    return;
	c = c.match(/\s?(lang\-\w+)/i);
	if (c && lang.indexOf(c[1]) == -1)
	{
	    lang.push(c[1]);
	    $.getScript(pretty_base + c[1] + '.min.js');
	}
   })

    $(window).load(function(){
       $("pre").addClass("prettyprint");
       prettyPrint();
    })
</script>    
        <script src="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js"></script>    <script type="text/javascript">
(function($){
  $('.entry').each(function(i){
    $(this).find('img').each(function(){
      var alt = this.alt;
      var imgsrc = /^.+?(png|bmp|jpeg)/.exec(this.src);

      $(this).wrap('<a href="' + (imgsrc?imgsrc[0]:this.src) + '" title="' + alt + '" class="fancybox" rel="fancybox' + i + '" />').wrap('<div class="img_block"></div>');
     
      if(alt){$(this).after('<span class="caption">' + alt + '</span>')};
    });
  });

  $('.fancybox').fancybox();
})(jQuery);
</script>    
<script src="/js/chenall.js" type="text/javascript"></script>

  <!--addons at end of body-->
</body>
</html>
