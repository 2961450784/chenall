<!DOCTYPE HTML>
<html><head>
<meta http-equiv="Cache-Control" content="max-age=7200" />

<!--addons at start of head-->
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>第 5 页 | chenall&#39;s Blog</title>
<meta name="author" content="chenall">

<meta name="description" content="chenall 的搏客,技术,分享,开源.">


<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta property="og:site_name" content="chenall&#39;s Blog"/>

<!--[if IE]><style>.testIE.IE{display:inline;}</style><![endif]-->
<!--[if lte IE 7]><link rel="stylesheet" href="/css/ie7.css" type="text/css">
<![endif]-->
<!--[if (lt IE 9)&(gt IE 7)]><style>.testIE.IE8{display:inline;}</style><![endif]-->
<!--[if gt IE 8]><style>.testIE.IE9{display:inline;}</style><![endif]-->

<link rel="author" href="https://plus.google.com/100700322385676715564" />
<link href="/favicon.png" rel="icon">
<link rel="alternate" href="/atom.xml" title="chenall&#39;s Blog Feed" type="application/atom+xml">

<link rel="stylesheet" href="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/css/bootstrap.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/font-awesome/4.0.3/css/font-awesome.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/prettify/r298/prettify.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" type="text/css">

<link rel="stylesheet" href="/css/style.css" type="text/css">

<!--[if lt IE 9]>
   <style>article,aside,dialog,footer,header,section,footer,nav,figure,menu{display:block}</style>
   <script src="http://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
   <script src="http://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
<link href="http://cdn.staticfile.org/respond.js/1.4.2/respond-proxy.html" id="respond-proxy" rel="respond-proxy" />
<link href="/js/respond.proxy.gif" id="respond-redirect" rel="respond-redirect" />
<script src="/js/respond.proxy.js"></script>
   <script src="http://cdn.bootcss.com/selectivizr/1.0.2/selectivizr-min.js"></script>
<![endif]-->
<script type="text/javascript">var site = {BASE_URI: '/'};var _js2load = [];</script>

<!--addons at end of head-->
</head>
<body>
  <!--addons at start of body-->
    <header id="header" class="container"><nav id="main-nav" class="navbar navbar-default navbar-fixed-top " role="navigation">
  <div class="container">
    <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="/">chenall's Blog</a>
    </div>
    <div class="collapse navbar-collapse">
      <ul class="nav navbar-nav dropdown-hover">
  
        <li item='page/5/' ><a href="/about/" title="关于">关于</a></li>      
        <li item='page/5/' ><a href="/archives/" title="归档">归档</a></li>      
        <li item='page/5/' ><a href="/qzgb-fm/" title="泉州广播">泉州广播</a></li>      
      <li class='dropdown'>
        <a class='dropdown-toggle' data-toggle='dropdown' href='#'>在线电视<b class='caret'></b></a>
        <ul class='dropdown-menu'>
    
          <li><a href="/tv/" title="在线直播">在线直播</a></li>    
          <li><a href="http://tv1.chenall.tk" title="直播线路1">直播线路1</a></li>    
          <li><a href="http://tv2.chenall.tk" title="直播线路2">直播线路2</a></li>    
        </ul>
      </li>
    
        <li item='page/5/' ><a href="/guestbook/" title="留言板">留言板</a></li>      
        <li item='page/5/' ><a href="http://grub4dos.chenall.net" title="GRUB4DOS">GRUB4DOS</a></li>      
        <li item='page/5/' ><a href="http://almrun.chenall.net" title="ALMRUN">ALMRUN</a></li>      
      </ul>
      <ul class="nav navbar-nav navbar-right">
      
        <li><a href="/atom.xml">RSS</a></li>
      
      
        <li><a href="https://twitter.com/chenall">twitter</a></li>
      
      
      
      
        <li><a href="https://github.com/chenall">github</a></li>
      
      </ul>
    </div>
  </div>
</nav>
<div class="clearfix"></div></header>
  <div id='content' class="container">
     <div class="page-header-wrapper">
      <!--[if lt IE 9]><div class="alert alert-warning alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button><strong>提示:</strong>您的浏览器版本太低了,建议升级到 <strong><a href="http://windows.microsoft.com/zh-cn/internet-explorer/download-ie" title="IE9">IE9</a></strong> 以上,本站使用<a href="https://www.google.com/intl/zh-CN/chrome/">Chrome浏览器</a>可以获得最好的显示效果.</div><![endif]-->
      <div class="page-header"><h1>chenall's Blog <small>走自己的路,让别人说去吧</small></h1></div>
     </div>
     <div class="row">
       <div id="main-col" class="alignleft col-sx-12 col-sm-8 col-md-9 col-lg-9">
      <section id='header_widget'></section>
          <div id="wrapper"><article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/post/ntboot/">[分享] Windows NT 系列通用启动盘[204-08-31]</a></h1>
      
        <span>发表于<time datetime="2012-02-13T02:40:00.000Z"> <a href="/post/ntboot/">2012-02-13</a></time></span>      
    </header>
    
    
    <div class="entry" >
      
        <h2 id="【说明】">【说明】</h2>
<ul>
<li>本启动盘可以用于直接启动硬盘上的NT系统.可以从任意地方加载这个镜像文件进行启动。</li>
<li>可以通过本镜像启动硬盘上的Windows系统,不依赖硬盘上的系统引导文件.</li>
<li>也可以用于U盘或光盘启动时,直接启动硬盘上的其它系统.</li>
<li>一盘在手,启动无优.</li>
</ul>

      
    </div>
    
    
      
      <div id='more-link'>
        <div align="left">
          <a href="/post/ntboot/#more" class="more-link fa fa-play">阅读全文</a>
        </div>
      </div>
      
    
    
        <footer id="post-meta">
        <div class="categories"style="display:inline">归类<span class="breadcrumb fa fa-folder"><li><a href="/categories/系统相关/" itemprop="url"><span itemprop="title" >系统相关</span></a></li></span></div> | <span class="tags">标签 <a href="/tags/GRUB4DOS/" class="label label-primary" itemprop="url"><span itemprop="title">GRUB4DOS</span></a><a href="/tags/ntboot/" class="label label-success" itemprop="url"><span itemprop="title">ntboot</span></a><a href="/tags/原创/" class="label label-info" itemprop="url"><span itemprop="title">原创</span></a></span> | <span class="time">最近更新:<time title="2014-08-31 18:40:12"datetime="2014-08-31 18:40:12"> 2014-08-31</time></span> | <span class="comment-link">
<a href="http://chenall.net/post/ntboot/#comments" class="ds-thread-count comment-link" data-thread-key="117" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/post/grub4dos_dev/">[分享] 自己动手，在WINDOWS系统中搭建GRUB4DOS编译环境[2014-06-25]</a></h1>
      
        <span>发表于<time datetime="2012-01-19T00:00:35.000Z"> <a href="/post/grub4dos_dev/">2012-01-19</a></time></span>      
    </header>
    
    
    <div class="entry" >
      
        <p>因为经常使用WINDOWS系统，为了方便直接在WINDOWS下搭建。</p>
<p>使用Colinux可以很方便的在WINDOWS中运行一直真实的Linux环境。</p>
<p>好了，废话不多说了，直接开始了。如果想偷懒的话，有提供了可以直接使用的成品下载。</p>
<p>说明: <strong>内容比较乱,只是记录一下整这个的过程(从文件大小也从最初的几个G到整最后的<code>50MB</code>,偷懒的直接下载最新版本就行了,想自己折腾的可以继续看下去(按日期顺序从后往前看)</strong></p>
<p>===========2014-06-25=============</p>
<p>修正使用git下载源码时出现的问题.</p>
<pre><code>cofuse: unsuppored request 6
fatal: cannot symlink &#39;/tmp/tcloop/git-1.6/usr/share/git-core/templates/info/exc
lude&#39; &#39;/mnt/cofs/grub4dos/.git/info/exclude&#39;: Function not implemented
</code></pre><p>下载地址: <a href="http://dl.grub4dos.chenall.net/grub4dos_dev_2014-06-25.7z" target="_blank" rel="external">grub4dos_dev_2014-06-25.7z</a></p>
<p>===========2013-03-02=============</p>
<p>由于gcc4.7编译出来的和版本启动memtest86有问题,<br>gcc换成4.8版.<br>git 换成1.6版.<br>下载地址1:  <a href="http://code.google.com/p/grub4dos-chenall/downloads/detail?name=grub4dos_dev_2013-02-03.zip" target="_blank" rel="external">grub4dos_dev-gcc-4.8</a></p>
<p>===========2013-01-14=============<br>更新了一下,使用最新的tinycolinux内核 4.7.3<br>svn 1.7.5<br>git 1.8.0<br>gcc 4.7.2</p>
<p>下载地址1:  <a href="http://code.google.com/p/grub4dos-chenall/downloads/detail?name=grub4dos_dev_2013-01-14.zip" target="_blank" rel="external">grub4dos_dev</a><br>MD5: F41AF644B3DA6C133A35C45278047C24<br>===========2012-02-27 ====================<br>今天roy修正了gcc4.6下编译的问题 ，重新做了一个gcc4.6的版本。<br>linux核心tinycore4.3<br>gcc4.6+git1.6+svn1.6+7z+grub4dos-dev<br><a href="http://www.ctdisk.com/file/4946481" target="_blank" rel="external">Colinux_TinyCoreLinux_grub4dos_dev.7z</a><br>MD5: FA11D60B45FEF4282DD9E0B640F39CF0</p>
<h2 id="===========2012-02-13_====================">===========2012-02-13 ====================</h2>
<p>With the new version, you only need three steps to get started.<br>(1) Download file <a href="http://www.ctdisk.com/file/4551969" target="_blank" rel="external">Colinux_tinyslat_grub4dos_Dev.7z</a><br>(2) use 7-ZIP  extract to the location you want to install.<br>(3) after decompression files run quick start.cmd in TinyDev directory</p>
<p>Node: /mnt/cofs ——&gt; e:\colinux</p>
<ol>
<li><p>Default cofs directory is e:\colinux so you must create this directory first for use cofs.</p>
<p>To use a different location you can modifying the file TinyDev\tinyslat\tinyslat.ini and then restart <code>quick start.cmd</code></p>
</li>
<li><p>You can add a virtual disk for colinux use below steps</p>
<pre><code>::create new file sda_1g.fs with 1Gb

fsutil file createnew sda_1g.fs 1073741824

modify tinyslat.ini file add line

sda=tinyslat\sda_1g.fs

and change home=ram0 to home=sda
</code></pre><p>Restart Colinux and enter</p>
<p> mke2fs -j /dev/sda</p>
<p>Restart Colinux again</p>
<p>Now<br> /mnt/sda —&gt; sda_1g.fs</p>
</li>
</ol>
<p>==================2012-02-07==================<br>结合Tinycore和slatiz优点的版本。使用了tinycore的核心+slatiz软件包管理器。相对完美版本，有以下优点</p>
<ul>
<li>小巧（解开后才70MB不到，使用MSYS/CYGWIN等至少也得100MB以上吧）。</li>
<li>方便，移动性，直接解压到电脑上就可以运行了（不要放在中文目录下）。</li>
<li>默认开启多终端支持（可以按Alt+Fn切换）。</li>
<li>可以自由添加安装软件（基于tinycore的软件包可自动保存）。使用slatiz的软件包目前不能保存。但是有提供了一个工具可以把tazpkg转为tcz。</li>
<li>可选保存用户配置（默认不保存）</li>
<li>自带的软件包gcc 4.5+svn1.6+git1.7+7z+……。总之下载后就可以直接编译GRUB4DOS相关程序。当然了也可以作为一个桌面linux来使用。</li>
</ul>
<p>使用方法：</p>
<p>只要三步就可以开始启动 下载－〉解压-&gt;执行。<br>  下载<br>  2012-02-08更新cofs权限问题<br>  2012-02-09因为git新的版本不可以在COFS上用git下载源码,所以GIT换成1.6版.<br>  <a href="http://www.ctdisk.com/file/4551969" target="_blank" rel="external">Colinux_tinyslat_grub4dos_Dev.7z</a><br>  增加软件方法：</p>
<ol>
<li>tinycore方案（推荐）<br>  tce-load -wi packname<br>  默认使用了163的镜像，可以通过修改opt目录下的tcemirror文件改成使用其它镜像。</li>
<li>slatiz方案（备用）<br>  tczpkg get-install packname<br>  这个只是作为备用。下载安装的软件不会被保存。</li>
<li><p>slatiz方案+tinycore<br>为了解决有时tinycore的软件源没有提供相应软件，而slatiz有提供时，可以使用该方法。<br>首先通过taz2tcz下载slatiz软件并转换为tcz格式。<br>taz2tcz packname<br>软件安装<br>tce-load -i packname<br>注意：</p>
<ol>
<li>你需要自己处理软件包的依赖关系（depends），可以使用tazpkg depends packname 查看。然后依次下载并转换所有包。</li>
<li>执行tce-load 时请注意查看上一步最终的软件包名。比如以下是下载xz程序的输出,注意看我们要安装的是xz，最终的名字是xz-4.999.9beta</li>
</ol>
<pre><code>tc@box:~$ taz2tcz xz
xz-4.999.9beta
Connecting to mirror.slitaz.org (94.23.209.91:80)
xz-4.999.9beta.tazpk 100% |*******************************| 21096   0:00:00 ETA
tazpkg(slatiz) to tcz (tinycorelinux) packages convert by chenall
Please wait....
42 blocks
91 blocks
xz-4.999.9beta converted. you can type tce-load -i xz-4.999.9beta to install.
tc@box:~$ tce-load -i xz-4.999.9beta
/etc/sysconfig/tcedir/optional/xz-4.999.9beta.tcz: OK
</code></pre></li>
</ol>
<p>==================2012-02-05==================<br>因为目前用GCC4.6编译出来的GRLDR无法启动，所以重新整了一个GCC4.4的。</p>
<p>相关下载：</p>
<p>Colinux 主程序 ：<a href="http://www.ctdisk.com/file/4499842" target="_blank" rel="external">colinux_mini.7z</a></p>
<p>系统镜像包： <a href="http://www.ctdisk.com/file/4499927" target="_blank" rel="external">tinycore_colinux_60M_GCC4.4.7z</a></p>
<h2 id="==================2012-02-04==================">==================2012-02-04==================</h2>
<p>整合了02-03版tinycore的两个版本优点，完善了一下。新的版本有以下优点</p>
<ul>
<li>占用空间小。</li>
<li>需要的内存也小。</li>
<li><p>配置灵活，可以选择保存数据。</p>
<p>目前提供了以下配置文件</p>
</li>
</ul>
<ol>
<li>tinydev.ini  相当于之前的60M版本，不保存数据。</li>
<li><p>tinydev_tce_cofs.ini  用户数据保存到tinycore.gz同目录的home目录下使用该配置文件需要先把grubdev.iso解开到同目录下。把配置文件名改为tinydev.ini 之后再启动，会自动建立HOME目录。需要的文件列表如下：tce 目录</p>
<p>tinycore.gz 文件</p>
<p>tinydev.ini 配置文件</p>
<p>启动之后可以使用tce-load命令下载新的软件并且可以保存。如果你对tinycore比较了解，直接添加软件到TCE目录就行了。<br>下载地址： tinycore_colinux_60M.7z</p>
</li>
</ol>
<p>==================2012-02-03==================</p>
<p>之前的版本使用了比较完整的Linux来搭建，占用空间比较大，我用<a href="http://distro.ibiblio.org" target="_blank" rel="external">tinycorelinux</a>重新定制了一个比较小巧的版本，有兴趣的可以下载试用</p>
<p>使用方法：</p>
<ol>
<li><p>先下载Colinux主程序和系统包。</p>
</li>
<li><p>在E:新建一个Colinux目录，用于和Linux共享，或方便存放文件。</p>
</li>
<li><p>Colinux解压到非中文目录下，系统包直接解压到Colinux目录中。</p>
</li>
<li><p>使用Colinux目录下的“快速启动.cmd”来直接启动。</p>
</li>
<li><p>你也可以安装为服务使用“安装服务.cmd”就行了。</p>
</li>
</ol>
<h1 id="相关文件下载：">相关文件下载：</h1>
<ol>
<li>Colinux 主程序  <a href="http://code.google.com/p/grubutils/downloads/detail?name=colinux_mini.7z&amp;can=1&amp;q=" target="_blank" rel="external">colinux_mini</a>直接解压到非中文的目录即可使用</li>
<li><p>定制好的系统包（选择其中一个就行了），解压到Colinux安装目录下。1.最小巧只需要60MB空间，缺点：不可保存用户配置完全在内存中运行。tinycore_colinux_dev.7z2.中等，需要160MB，缺点：占用空间比较大，但是可以保存用户配置。</p>
<p>tinycore_colinux_fs.7z</p>
<p>3.之前的版本重新打包的文件需要2G+128MB空间</p>
<p><a href="http://code.google.com/p/grubutils/downloads/detail?name=Debian_colinux.7z&amp;can=1&amp;q=" target="_blank" rel="external">Debian_colinux.7</a></p>
<p>基于tinycore的两个版本所安装的程序都是一样的包含以下主要和相关联的程序。</p>
<p>GCC 4.6 + GIT + SVN</p>
<p>区别是，一个是RAM版本，一个非RAM版本。</p>
<p>建议使用非RAM版本，这样可以保存你的配置文件。默认的COFS目录是E:\COLINUX，你需要先在WINDOWS中建立以上目录。然后就开始操作了</p>
<p>在linux中使用以下命令就可以编译一个GRUB4DOS</p>
<pre><code>cd /mnt/cofs

svn co http://grub4dos-chenall.googlecode.com/svn/trunk grub4dos-src

cd grub4dos-src

make
</code></pre><p>如果你习惯用git也可以用git来下载源码<br>``<br>git clone git://github.com/chenall/GRUB4DOS.git<br>cd GRUB4DOS<br>make<br>```<br>其它说明：tinycore默认是超级用户，可以用exit命令退出。用sudo su进入超级用户模式。要增加软件可以使用tce-load命令比如以下命令就可以下载并安装xterm</p>
</li>
</ol>
<p>tce-load -wi xterm</p>
<p>另外已经重定向X的显示到主机。只要主机有安装X SERVER在LINUX下启动X程序就会在主机上显示。</p>
<h2 id="2012-01-19">2012-01-19</h2>
<p>首先要准备的文件列表</p>
<p>以下软件都在这里<a href="http://sourceforge.net/projects/colinux/files/" target="_blank" rel="external">http://sourceforge.net/projects/colinux/files/</a> 可以自己选择其它版本下载</p>
<ol>
<li>Colinux我选用最新的版本  <a href="http://sourceforge.net/projects/colinux/files/Snapshots/devel-20110807-Snapshot/devel-coLinux-20110807.exe/download" target="_blank" rel="external">devel-coLinux-20110807.exe</a></li>
<li>用于colinux的linux镜像     <a href="http://sourceforge.net/projects/colinux/files/Images%202.6.x%20Debian/Debian%206.0%20Squeeze/Debian-6.0.1-squeeze.7z/download" target="_blank" rel="external">Debian-6.0.1-squeeze</a><br>安装Colinux，直接默认安装就行了。</li>
</ol>
<p>安装完之后，解压Debian-6.0.1的压缩包到Colinux安装目录下。会多出几个文件。</p>
<p>直接运行解压出来的squeeze.bat就可以启动一个debian了。</p>
<p>启动后直接输入用户名root登录</p>
<p>wee需要在gcc 4.5的环境中编译，否则生成的文件太大超过了32KB。如果你不需要编译wee可以略过以下内容。</p>
<p>目前debian的gcc 4.5软件包需要用测试版才能直接安装。所以需要修改软件源，增加一个测试版的源。</p>
<p>============分隔线，增加debian软件源开始======================</p>
<p>修改源列表文件</p>
<p>vi /etc/apt/sources.list</p>
<p>看看里面有没有包含 testing的行，如果有就不用改了。</p>
<p>像这个只有一行</p>
<p>deb <a href="http://ftp.debian.org/debian" target="_blank" rel="external">http://ftp.debian.org/debian</a> squeeze main</p>
<p>要增加一个testing的源。</p>
<p>懂得VI的可以略过以下内容.开始修改。</p>
<p>首先复制当前行（直输入’yy’即连按两次’y’）</p>
<p>然后直接粘贴（直接按’p’键）现在有两行了</p>
<p>修改其中一行的”squeeze”为”testing”（光标移到’s’处输入’dw’，再按’I’输入”testing “。)</p>
<p>最终就是</p>
<p>deb <a href="http://ftp.debian.org/debian" target="_blank" rel="external">http://ftp.debian.org/debian</a> squeeze main</p>
<p>deb <a href="http://ftp.debian.org/debian" target="_blank" rel="external">http://ftp.debian.org/debian</a> testing main</p>
<p>保存并退出（先按一下”Esc”键再输入”:x”回车即可）</p>
<p>好了现在更新一下源信息。</p>
<p>apt-get update</p>
<p>============分隔线，增加debian软件源完成======================</p>
<p>安装GRUB4DOS编译需要的软件包。</p>
<p>注：如果不需要编译wee可以安装gcc-4.3或gcc-4.4会比较稳定。</p>
<p>apt-get install gcc-4.5 autoconf automake make patch git subversion</p>
<p>注：git和subversion是源码管理工具，用于下载源码的，可以安装其中一个就行了。</p>
<p>所有的提示直接按’Y’或回车确认。坐着泡一杯茶再过来，差不多装好了。</p>
<p>如果网络环境很给力的话，几分钟就行了。否则可能得等上半个小时吧。</p>
<p>电脑：俺正在努力下载安装软件，没空陪你了，你自己玩去吧。</p>
<p>………………………………………..</p>
<p>半个小时后。</p>
<p>好像差不多了。。继续工作。</p>
<p>等等，还少了压缩软件，如果你只是玩玩，不要也罢。</p>
<p>apt-get install p7zip-full zip</p>
<p>现在已经万事具备，只欠东风了。</p>
<p>只要下载源码然后就可以编译了。新手请最好看完后面内容再下载编译测试。</p>
<p>下载源码方法:</p>
<p>svn co <a href="http://grub4dos-chenall.googlecode.com/svn/trunk" target="_blank" rel="external">http://grub4dos-chenall.googlecode.com/svn/trunk</a> grub4dos-src</p>
<p>或</p>
<p>git clone git://github.com/chenall/grub4dos.git grub4dos-src</p>
<p>编译：</p>
<p>cd grub4dos-src</p>
<p>make</p>
<p>如果你对linux的操作不熟悉，你可以在WINDOWS中修改源码，改完之后再进入LINUX去编译。</p>
<p>colinux支持cofs文件系统，可以和WINDOWS进行文件夹共享。</p>
<p>添加cofs文件系统方法.</p>
<p>在d:新建一个文件夹名字就叫做cofs,用记事本打开squeeze.conf</p>
<p>添加一行</p>
<p>cofs0=d:\cofs</p>
<p>先关闭linux，输入halt就行了。</p>
<p>再次双击squeeze.bat启动debian，登录</p>
<p>输入以下命令挂载cofs</p>
<p>mkdir /mnt/cofs</p>
<p>mount -t cofs cofs0 /mnt/cofs</p>
<p>cd /mnt/cofs</p>
<p>mkdir test</p>
<p>要让它启动时自动挂载可以添加一行内容到/etc/fstab文件中</p>
<p>/dev/cofs0 /mnt/cofs cofs</p>
<p>直接用echo添加就行了，也可以用VI修改</p>
<p>echo /dev/cofs0 /mnt/cofs cofs &gt;&gt; /etc/fstab</p>
<p>如果电脑d:\cofs目录下有生成一个test文件夹，则证明成功挂载</p>
<p>cd /mnt/cofs</p>
<p>svn co <a href="http://grub4dos-chenall.googlecode.com/svn/trunk" target="_blank" rel="external">http://grub4dos-chenall.googlecode.com/svn/trunk</a> grub4dos-src</p>
<p>cd grub4dos-src</p>
<p>make</p>
<p>以后你就可以在WINDOWS中打开d:\cofs这个目录，修改里面的源码，然后再到linux里面去编译就行了。</p>
<p>懒人可以直接下载绿色包，解压后就可以直接使用。</p>
<p><a href="http://grubutils.googlecode.com/files/grub4dos_colinux_debian.7z" target="_blank" rel="external">grub4dos_colinux_debian.7z</a></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <div class="categories"style="display:inline">归类<span class="breadcrumb fa fa-folder"><li><a href="/categories/程序设计/" itemprop="url"><span itemprop="title" >程序设计</span></a></li><li><a href="/categories/程序设计/综合/" itemprop="url">综合</a></li></span><span class="breadcrumb"><li><a href="/categories/GRUB4DOS/" itemprop="url"><span itemprop="title" >GRUB4DOS</span></a></li><li><a href="/categories/GRUB4DOS/实用/" itemprop="url">实用</a></li></span></div> | <span class="tags">标签 <a href="/tags/colinux/" class="label label-primary" itemprop="url"><span itemprop="title">colinux</span></a><a href="/tags/debian/" class="label label-success" itemprop="url"><span itemprop="title">debian</span></a><a href="/tags/GRUB4DOS/" class="label label-info" itemprop="url"><span itemprop="title">GRUB4DOS</span></a></span> | <span class="time">最近更新:<time title="2014-07-25 16:47:29"datetime="2014-07-25 16:47:29"> 2014-07-25</time></span> | <span class="comment-link">
<a href="http://chenall.net/post/grub4dos_dev/#comments" class="ds-thread-count comment-link" data-thread-key="804" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/post/newext/">[分享]电脑防毒小技巧一则</a></h1>
      
        <span>发表于<time datetime="2012-01-11T13:36:32.000Z"> <a href="/post/newext/">2012-01-11</a></time></span>      
    </header>
    
    
    <div class="entry" >
      
        <p>现在的电脑病毒越来越多，也越来越厉害，有时真的有点防不胜防。</p>
<p>并且它特别喜欢感染可执行程序文件，因为这样就可以一传十，十传百，快速传播。</p>
<p>这里分享一个小技巧，可以让你的应用程序免受感染（当然只是大部份情况下免疫）</p>
<p>一般情况下病毒都是根据文件的扩展名来确定这个文件是否应用程序。所以可以通过修改扩展名的方式来避免感染。</p>
<p>这个技巧就是通过修改可执行文件的扩展名来避免感染。</p>
<p>缺点是必须添加新的文件关联才可以双击启动这个程序。</p>
<p>附件的批处理文件默认添加了一个exa的扩展名，你可以改成其它的。</p>
<p>执行了这个批处理文件之后，你就可以把你的一些比较重要的应用程序的扩展名改变一下。程序还是可以启动，只是扩展名变了，万一哪天又中毒的，病毒就不会自动找上门来了。</p>
<p>注：可能得重新启动才有效果。</p>
<p>因为系统默认情况下是隐藏应用程序的扩展名的，你可以通过以下方法打开显示。</p>
<p>取消文件夹选项中的隐藏已知文件类型的扩展名就行了。</p>
<p>如果不知道在哪里改的可以直接下载附件，里面有隐藏和显示的注册表。</p>
<p>直接双陆对应的注册表文件就可以了。</p>
<pre><code class="`">@ech off
::添加自定义可执行程序扩展名批处理 by chenall
::http://chenall.net
call :add_ext .exa
goto :eof
:add_ext
if &quot;%1&quot;==&quot;&quot; goto :eof
assoc %1=exefile
reg add &quot;HKCR\%1\PersistentHandler&quot; /ve /d {098f2470-bae0-11cd-b579-08002b30bfeb} /f
reg add HKCR\%1 /v &quot;Content Type&quot; /d &quot;application/x-msdownload&quot; /f
shift
goto :add_ext
</code></pre>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <div class="categories"style="display:inline">归类<span class="breadcrumb fa fa-folder"><li><a href="/categories/个人日记/" itemprop="url"><span itemprop="title" >个人日记</span></a></li></span><span class="breadcrumb"><li><a href="/categories/系统相关/" itemprop="url"><span itemprop="title" >系统相关</span></a></li></span></div> | <span class="tags">标签 <a href="/tags/技巧/" class="label label-primary" itemprop="url"><span itemprop="title">技巧</span></a><a href="/tags/病毒/" class="label label-success" itemprop="url"><span itemprop="title">病毒</span></a><a href="/tags/批处理/" class="label label-info" itemprop="url"><span itemprop="title">批处理</span></a></span> | <span class="time">最近更新:<time title="2014-02-26 19:52:59"datetime="2014-02-26 19:52:59"> 2014-02-26</time></span> | <span class="comment-link">
<a href="http://chenall.net/post/newext/#comments" class="ds-thread-count comment-link" data-thread-key="802" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/post/cardrom/">卡蝶机</a></h1>
      
        <span>发表于<time datetime="2012-01-11T12:22:10.000Z"> <a href="/post/cardrom/">2012-01-11</a></time></span>      
    </header>
    
    
    <div class="entry" >
      
        <blockquote>
<p> 卡碟機 是一項很具創意的發明。它可以讓你把光碟 ISO 映像檔「燒」到 MicroSD 卡中， 而電腦就會從媒體身份（Media Type）的層面把 MicroSD 卡辨認為一部傳統的 DVD/CD 光碟機。<br> 系統管理員可以把操作系統的安裝光碟內容寫到卡碟機裡的 MicroSD 卡裡，就可以免卻使用外置式光碟機和燒碟的麻煩，方便又環保。</p>
</blockquote>
<h2 id="[相关介绍]">[相关介绍]</h2>
<p>●光碟機/讀卡器二合一</p>
<p>●可燒錄ISO 映像檔,模擬USB 光碟機</p>
<p>●隨插即用,免驅動程式</p>
<p>●無光碟機蕊,低耗電,使用壽命長.免用光碟片,無耗材,省錢又環保</p>
<p>更详细的介绍可以点这里查看。</p>
<p><a href="https://docs.google.com/viewer?url=http%3A%2F%2Fjlanlingtech.web-maker.com.tw%2Fupload%2F20111004173405.pdf" target="_blank" rel="external">https://docs.google.com/viewer?url=http%3A%2F%2Fjlanlingtech.web-maker.com.tw%2Fupload%2F20111004173405.pdf</a></p>
<p>&nbsp;</p>
<p>或这里下载PDF格式</p>
<p><a href="http://hinet.dyndns.org/cardrom_manual.pdf" target="_blank" rel="external">http://hinet.dyndns.org/cardrom_manual.pdf</a></p>
<h2 id="[一些截图]_注:_图片已失效">[一些截图] 注: 图片已失效</h2>
<ul>
<li>初始，还没有烧录ISO的状态</li>
<li>已经烧录好的装态</li>
<li>烧录ISO的界面</li>
<li>烧录时的确认，使用第一种方式时每次都要重新格式化。所以建议选择固定大小。</li>
<li>启动测试界面，注：新的电脑一般按F8或F10都会有选择启动设备的界面，类似如下的。</li>
</ul>
<p>后记：经过一段时间的测试，效果不错。比如应急时，可以直接写入一个系统安装盘的ISO文件，然后用它来安装系统。使用了固定格式的模式之后可以随意更新ISO文件来改变光驱里面的内容而不影响SD卡里面的内容。</p>
<ol>
<li>这个SD卡还可以放到其它读卡器上正常使用，只要不重新分区格式化对虚拟光驱没有影响。</li>
<li>可以使用多个SD卡，通过更换SD卡来更换光驱内容相当于（换光盘）体积比光盘小多了，呵呵。还是挺方便的。</li>
<li>以后可能还支持在一张SD卡上写入多个ISO文件。</li>
<li>虽然是虚拟的，但是对于系统来说这是真实存在的设备，不需要其它设置就可以直接使用。</li>
</ol>
<a data-type="0" data-tmpl="628x100" data-tmplid="7" data-rd="2" data-border="1" data-style="2" biz-itemid="14191084868" target="_blank" rel="external" title="点此链接购买" href="http://item.taobao.com/item.htm?id=14191084868">http://item.taobao.com/item.htm?id=14191084868</a>




      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <div class="categories"style="display:inline">归类<span class="breadcrumb fa fa-folder"><li><a href="/categories/个人日记/" itemprop="url"><span itemprop="title" >个人日记</span></a></li></span></div> | <span class="tags">标签 <a href="/tags/GRUB4DOS/" class="label label-primary" itemprop="url"><span itemprop="title">GRUB4DOS</span></a><a href="/tags/卡蝶机/" class="label label-success" itemprop="url"><span itemprop="title">卡蝶机</span></a></span> | <span class="time">最近更新:<time title="2014-02-26 19:52:59"datetime="2014-02-26 19:52:59"> 2014-02-26</time></span> | <span class="comment-link">
<a href="http://chenall.net/post/cardrom/#comments" class="ds-thread-count comment-link" data-thread-key="797" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/post/datatoexcel/">将数据输出到Excel的方法</a></h1>
      
        <span>发表于<time datetime="2011-11-09T06:35:20.000Z"> <a href="/post/datatoexcel/">2011-11-09</a></time></span>      
    </header>
    
    
    <div class="entry" >
      
        <p>日常工作中经常需要把某一部份数据导出到EXCEL,通常情况都有软件提供类似方案.</p>
<p>但是这需要手工去打开软件然后导出,不能实现自动化.所以就编写了这个脚本方便实现自动化.</p>
<p>本脚本采用VBSCRIPT语言编写.可以在VB或VBS脚本中使用.</p>
<p>提供了两个过程调用方法rsToExcel,和sqltoexcel.</p>
<p>以下例子就可以把一个文本文档(CSV格式),转为EXCEL</p>
<pre><code>sqlToExcel &quot;TEXT;c:\test.txt&quot;,&quot;c:\test.xls&quot;,null
</code></pre><p>以下可以从一个SQL数据库中提取数据并输出到excel文件中</p>
<pre><code>sqlToExcel &quot;OLEDB;Provider=SQLOLEDB;data source=SQLSERVER;Initial Catalog=DB;User ID=sa;Password=pass&quot;,&quot;c:\test.xls&quot;,&quot;select * from mytable&quot;
</code></pre><p>注:rstoexcel和sqltoexcel都可以生成EXCEL文件,可以看情况使用.一般情况下使用sqltoexcel就可以了,比较简单.</p>
<p>以下是使用rstoexcel的方法,会麻烦一些</p>
<pre><code>Dim Conn, StrConn, RS, SQL
set Conn = CreateObject(&quot;ADODB.Connection&quot;)
set RS = CreateObject(&quot;ADODB.Recordset&quot;)
StrConn = &quot;Provider=SQLOLEDB;data source=SQLSERVER;Initial Catalog=DB;User ID=sa;Password=passwd&quot;
SQL = &quot;select * from mytable&quot;
Conn.Open StrConn
RS.Open SQL,conn,1,1
rstoexcel(RS,&quot;c:\sql.xls&quot;)
</code></pre><p>参考资料: <a href="http://support.microsoft.com/kb/247412/zh-cn" target="_blank" rel="external">http://support.microsoft.com/kb/247412/zh-cn</a></p>
<pre><code class="VB">
Dim Conn, StrConn, RS, SQL
set Conn = CreateObject(&quot;ADODB.Connection&quot;)
set RS = CreateObject(&quot;ADODB.Recordset&quot;)
StrConn = &quot;Provider=SQLOLEDB;data source=SQLSERVER;Initial Catalog=DB;User ID=sa;Password=passwd&quot;
SQL = &quot;select * from mytable&quot;
Conn.Open StrConn
RS.Open SQL,conn,1,1
rstoexcel(RS,&quot;c:\sql.xls&quot;)

&#39;sqltoexcel &quot;TEXT;c:\11.txt&quot;,&quot;c:\test.xls&quot;,null
&#39;sqltoexcel &quot;URL;http://amupdate.nxt.ru/&quot;,&quot;c:\url.xls&quot;,null
sqltoexcel &quot;OLEDB;&quot; &amp; StrConn ,&quot;c:\sql.xls&quot;,SQL

&#39;RS记录导出到EXCEL文件 by chenall http://chenall.net
&#39;使用方法
&#39;rsToExcel Recordset,ExcelFileName
&#39;rsToExcel rs,&quot;c:\test.xls&quot;
sub rsToExcel(rs,file)
    &#39;on error resume next
    dim n,x
    dim xlApp,xlBook,xlSheet
    Set xlApp = CreateObject(&quot;Excel.Application&quot;)&#39;创建EXCEL对象
    with xlApp.Workbooks.Add().Worksheets(1)&#39;创建新的工作表对像
        n = 0
        for each x in rs.Fields
            n=n+1
            .Cells(1,n) = x.name 
            .Cells(1,n).Font.Bold   =   True &#39;加粗
            .Cells(1,n).HorizontalAlignment=3 &#39;居中
        next
        .Range(&quot;A2&quot;).CopyFromRecordset rs
        .Range(&quot;A1:&quot; &amp; chr(asc(&quot;A&quot;)+n-1) &amp; rs.recordcount+1).Borders.LineStyle = 1&#39;画表框
        .Range(&quot;A1:&quot; &amp; chr(asc(&quot;A&quot;)+n-1) &amp; rs.recordcount+1).EntireColumn.AutoFit() &#39;自动调整列宽
        xlApp.displayalerts=false&#39;不显示覆盖文件的提示
        .SaveAs file&#39;另存为新的文件名
        xlApp.displayalerts=true&#39;恢复显示
    end with
    xlApp.Quit&#39;退出excel
    set xlApp=nothing
end sub

&#39;任意数据源导出到EXCEL文件 by chenall http://chenall.net
&#39;使用方法,sql参数可以为null
&#39;sqlToExcel conn,ExcelFileName,sql
&#39;sqlToExcel conn,&quot;c:\test.xls&quot;,sql
sub sqlToExcel(conn,file,sql)
&#39;    on error resume next
    dim xlApp,xlBook,xlSheet,QryTable
    Set xlApp = CreateObject(&quot;Excel.Application&quot;)&#39;创建EXCEL对象
    with xlApp.Workbooks.Add().Worksheets(1)&#39;创建新的工作表对像
        if isnull(sql) then
            set QryTable = .QueryTables.add(conn,.Range(&quot;A1&quot;)) &#39;导入数据
        else
            set QryTable = .QueryTables.add(conn,.Range(&quot;A1&quot;),sql) &#39;导入数据
        end if
        QryTable.Refresh false
        xlApp.displayalerts=false&#39;不显示覆盖文件的提示
        .SaveAs file&#39;另存为新的文件名
        xlApp.displayalerts=true&#39;恢复显示
    end with
    xlApp.Quit&#39;退出excel
    set xlApp=nothing
end sub
</code></pre>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <div class="categories"style="display:inline">归类<span class="breadcrumb fa fa-folder"><li><a href="/categories/程序设计/" itemprop="url"><span itemprop="title" >程序设计</span></a></li><li><a href="/categories/程序设计/VB/" itemprop="url">VB</a></li><li><a href="/categories/程序设计/VB/VBScript/" itemprop="url">VBScript</a></li></span></div> | <span class="tags">标签 <a href="/tags/EXCEL/" class="label label-primary" itemprop="url"><span itemprop="title">EXCEL</span></a><a href="/tags/VBScript/" class="label label-success" itemprop="url"><span itemprop="title">VBScript</span></a><a href="/tags/原创/" class="label label-info" itemprop="url"><span itemprop="title">原创</span></a></span> | <span class="time">最近更新:<time title="2014-02-26 19:52:59"datetime="2014-02-26 19:52:59"> 2014-02-26</time></span> | <span class="comment-link">
<a href="http://chenall.net/post/datatoexcel/#comments" class="ds-thread-count comment-link" data-thread-key="787" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/post/grub4dos_biosint/">可以在GRUB4DOS下调用BIOS中断的外部命令</a></h1>
      
        <span>发表于<time datetime="2011-10-17T15:36:28.000Z"> <a href="/post/grub4dos_biosint/">2011-10-17</a></time></span>      
    </header>
    
    
    <div class="entry" >
      
        <p>本程序可以在GRUB4DOS中直接调用BIOS中断和读写指定端口，从而获取一些功能和需要的数据。</p>
<p>可以方便开发人员临时调试某个功能时使用。</p>
<p>当然你对中断资料比较熟悉的话，就可以利用GRUB4DOS配合本程序作出非常酷的效果（比如移动的文字）</p>
<p>使用方法，直接下载程序在GRUB4DOS中执行</p>
<h2 id="参数">参数</h2>
<ul>
<li>写数据到指定端口<br>  bios outb/outw/outl PORT VALUE</li>
<li>从指定端口读数据<br>  bios inb/inw/inl </li>
<li>中断调用<br>  bios int=INT eax=EAX ebx=EBX […]</li>
</ul>
<p>可使用的所以参数在下面的列表中</p>
<pre><code>unsigned long edi; // as input and output
unsigned long esi; // as input and output
unsigned long ebp; // as input and output
unsigned long esp; // stack pointer, as input
unsigned long ebx; // as input and output
unsigned long edx; // as input and output
unsigned long ecx; // as input and output
unsigned long eax;// as input and output
unsigned long gs; // as input and output
unsigned long fs; // as input and output
unsigned long es; // as input and output
unsigned long ds; // as input and output
unsigned long ss; // stack segment, as input
unsigned long eip; // instruction pointer, as input, 
unsigned long cs; // code segment, as input
unsigned long eflags; // as input and output
</code></pre><p>效果图在这里(之前的图片放在盛大的服务器上,已经失效)</p>
<ol>
<li><p>直接读写端口演示，分别使用<code>outl</code>和<code>inl</code>  </p>
<p>说明：chkpci就是主要使用<code>outl</code>和<code>inl</code>获取PCI信息的（具体的在本站文章上面的搜索中输入CHKPCI查看更多介绍）<br>结果自己看，后面使用bios调用得到的是第一条PCI的记录。。</p>
<p><img src="http://qiniu.chenall.net/post/grub4dos_biosint_01.png" alt="获取pci信息"></p>
</li>
<li><p>调用BIOS中断演示</p>
<p><img src="http://qiniu.chenall.net/post/grub4dos_biosint_02.png" alt="未执行前的界面"></p>
<pre><code> 这是调用了`INT 10`后的界面，这里稍微介绍一下这个语句的作用
 调用`BIOS`的`int10`中断第6号功能。`AX=0X0601` 即AH=06H,AL=01
 CX=0x050d 即CH=5,CL=0xD(13)
 DX=0X0E20 CH=0xe(14),cl=0x20(32)
 意思就是把屏幕从第5行第13个字符开始到第14行第32个字符结尾的柜形上移一行。
 功能号：06H和07H
 功能：初始化屏幕或滚屏
 入口参数：AH＝06H—向上滚屏，07H—向下滚屏
          AL＝滚动行数(0—清窗口)
          BH＝空白区域的缺省属性
         (CH、CL)＝窗口的左上角位置(Y坐标，X坐标)
         (DH、DL)＝窗口的右下角位置(Y坐标，X坐标)
 出口参数： 无
</code></pre><p><img src="http://qiniu.chenall.net/post/grub4dos_biosint_03.png" alt="调用结果"></p>
</li>
</ol>
<p>这个程序只是为了方便测试而编写,使用者需自己注意。</p>
<p>下载地址（带源码）：</p>
<p><a href="http://code.google.com/p/grubutils/downloads/list" target="_blank" rel="external">http://code.google.com/p/grubutils/downloads/list</a></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <div class="categories"style="display:inline">归类<span class="breadcrumb fa fa-folder"><li><a href="/categories/GRUB4DOS/" itemprop="url"><span itemprop="title" >GRUB4DOS</span></a></li><li><a href="/categories/GRUB4DOS/扩展/" itemprop="url">扩展</a></li></span></div> | <span class="tags">标签 <a href="/tags/chkpci/" class="label label-primary" itemprop="url"><span itemprop="title">chkpci</span></a><a href="/tags/GRUB4DOS/" class="label label-success" itemprop="url"><span itemprop="title">GRUB4DOS</span></a><a href="/tags/原创/" class="label label-info" itemprop="url"><span itemprop="title">原创</span></a></span> | <span class="time">最近更新:<time title="2014-02-26 19:52:59"datetime="2014-02-26 19:52:59"> 2014-02-26</time></span> | <span class="comment-link">
<a href="http://chenall.net/post/grub4dos_biosint/#comments" class="ds-thread-count comment-link" data-thread-key="785" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/post/grub4dos_date_bat/">[分享] 直接在GRUB4DOS环境中修改系统时间</a></h1>
      
        <span>发表于<time datetime="2011-10-08T09:12:07.000Z"> <a href="/post/grub4dos_date_bat/">2011-10-08</a></time></span>      
    </header>
    
    
    <div class="entry" >
      
        <p>修改系统日期有很多种方法，比如直接进入BIOS修改，或者进入系统后修改。</p>
<p>如果我想每次开机都改成一个固定的时间，进入系统后自动更新为正确的时间（一般用于过期软件破解）</p>
<p>现在可以直接使用GRUB4DOS来实现自动修改了。</p>
<p>本批处理属于GRUB4DOS高级编程，直接调用BIOS中断来实现修改日期的目的。</p>
<p>BIOS中断调用的实现例子。</p>
<p>用法:</p>
<p>把批处理直接保存为DATE然后使用以下命令就可以了或直接使用C语言编译的版本</p>
<p>  显示当前日期</p>
<pre><code>date
</code></pre><p>  修改日期</p>
<pre><code>date 2011-01-01
</code></pre><h3 id="相关资料:">相关资料:</h3>
<pre><code>时钟服务(Clock Service——INT 1AH) 
00H —读取时钟“滴答”计数06H —设置闹钟
01H —设置时钟“滴答”计数07H —闹钟复位
02H —读取时间0AH —读取天数计数
03H —设置时间0BH —设置天数计数
04H —读取日期 80H —设置声音源信息 
05H —设置日期
(1)、功能00H
功能描述：读取时钟“滴答”计数
入口参数：AH=00H
出口参数：AL=00H——未过午夜，否则，表示已过午夜
CX:DX=时钟“滴答”计数
(2)、功能01H
功能描述：设置时钟“滴答”计数
入口参数：AH=01H
CX:DX=时钟“滴答”计数
出口参数：无
(3)、功能02H
功能描述：读取时间
入口参数：AH=02H
出口参数：CH=BCD码格式的小时
CL=BCD码格式的分钟
DH=BCD码格式的秒
DL=00H——标准时间，否则，夏令时
CF=0——时钟在走，否则，时钟停止
(4)、功能03H
功能描述：设置时间
入口参数：AH=03H
CH=BCD码格式的小时
CL=BCD码格式的分钟
DH=BCD码格式的秒
DL=00H——标准时间，否则，夏令时
出口参数：无
(5)、功能04H
功能描述：读取日期
入口参数：AH=04H
出口参数：CH=BCD码格式的世纪
CL=BCD码格式的年
DH=BCD码格式的月
DL=BCD码格式的日
CF=0——时钟在走，否则，时钟停止
(6)、功能05H
功能描述：设置日期
入口参数：AH=05H
CH=BCD码格式的世纪
CL=BCD码格式的年
DH=BCD码格式的月
DL=BCD码格式的日
出口参数：无
(7)、功能06H
功能描述：设置闹钟
入口参数：AH=06H
CH=BCD码格式的小时
CL=BCD码格式的分钟
DH=BCD码格式的秒
出口参数：CF=０——操作成功，否则，闹钟已设置或时钟已停止
(8)、功能07H
功能描述：闹钟复位
入口参数：AH=07H
出口参数：无
(9)、功能0AH
功能描述：读取天数计数，仅在PS/2有效，在此从略
(10)、功能0BH
功能描述：设置天数计数，仅在PS/2有效，在此从略
(11)、功能80H
功能描述：设置声音源信息
入口参数：AH=80H
AL=声音源
=00H——8253可编程计时器，通道2
=01H——盒式磁带输入
=02H——I/O通道上的&quot;Audio In&quot;
=03H——声音产生芯片
出口参数：无
</code></pre><p>C语言版的代码在这里</p>
<p><a href="http://code.google.com/p/grubutils/source/browse/trunk/src/date.c" target="_blank" rel="external">http://code.google.com/p/grubutils/source/browse/trunk/src/date.c</a></p>
<p>批处理版源码:</p>
<pre><code>!BAT
::datefunc for grub4dos by chenall 2011-10-08
setlocal
debug off
set edi=0x60000
set esi=0x60004
set ebp=0x60008
set esp=0x6000C
set ebx=0x60010
set bx=0x60010
set edx=0x60014
set dx=0x60014
set ecx=0x60018
set cx=0x60018
set eax=0x6001C
set ax=0x6001C
set gs=0x60020
set fs=0x60024
set es=0x60028
set ds=0x6002c
set ss=0x60030
set eip=0x60034
set cs=0x60038
set eflags=0x6003c
::时钟服务(Clock Service——INT 1AH) 
::04H —读取日期
call :BIOS_INT 1A ax=0x400
set date=%*
if exist date &amp;&amp; goto :SET_DATE
call Fn.0 0 &quot;%%04X%%04X&quot; *%cx% *%dx% | set date=
echo -n The current date is: %date:~0,4%-%date:~4,2%-%date:~6%
set /p date=Enter the new date: (yyyy-mm-dd)

:SET_DATE  调用BIOS中断修改日期
::05H —设置日期
call :BIOS_INT 1A ax=0x500 cx=0x%date:~0,4% dx=0x%date:~5,2%%%date:~8,2%
exit

:BIOS_INT
::初始化系统参数
echo -n &gt; (md)0x300+1
write %cs% -1
write %ss% -1
write %esp% -1
write %eflags% -1
write %ds% -1
write %es% -1
write %fs% -1
write %gs% -1
write %eip% 0xFFFF%1CD
shift 1

::设置参数
:参数
if &quot;%2&quot;==&quot;&quot; goto :realmode_run
write %%%1% %2
shift 1
shift 1
goto :参数
:realmode_run
call Fn.53 0x60000
exit
</code></pre>
      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <div class="categories"style="display:inline">归类<span class="breadcrumb fa fa-folder"><li><a href="/categories/GRUB4DOS/" itemprop="url"><span itemprop="title" >GRUB4DOS</span></a></li><li><a href="/categories/GRUB4DOS/批处理/" itemprop="url">批处理</a></li></span></div> | <span class="tags">标签 <a href="/tags/date/" class="label label-primary" itemprop="url"><span itemprop="title">date</span></a><a href="/tags/GRUB4DOS/" class="label label-success" itemprop="url"><span itemprop="title">GRUB4DOS</span></a><a href="/tags/time/" class="label label-info" itemprop="url"><span itemprop="title">time</span></a><a href="/tags/批处理/" class="label label-warning" itemprop="url"><span itemprop="title">批处理</span></a></span> | <span class="time">最近更新:<time title="2015-03-24 11:13:49"datetime="2015-03-24 11:13:49"> 2015-03-24</time></span> | <span class="comment-link">
<a href="http://chenall.net/post/grub4dos_date_bat/#comments" class="ds-thread-count comment-link" data-thread-key="782" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/post/g4d_filelist/">[原创] GRUB4DOS 通用模块之文件选择模块[2011-10-01 更新]</a></h1>
      
        <span>发表于<time datetime="2011-08-22T05:16:17.000Z"> <a href="/post/g4d_filelist/">2011-08-22</a></time></span>      
    </header>
    
    
    <div class="entry" >
      
        <p>本模块是一个GRUB4DOS的批处理</p>
<p>可用于搜索N级目录下的指定类型文件,并显示于菜单上</p>
<p>这是一个通用模块,可以通过参数直接调用或者通过预先设置变量的方法再调用,</p>
<p>使用方法请参考本站另一贴子</p>
<p><a href="/post/grub4dos_hdpart/">[原创] GRUB4DOS 通用模块之分区选择</a></p>
<h3 id="2011-08-22_(最终版）">2011-08-22 (最终版）</h3>
<ol>
<li>优化了检测代码．</li>
<li>filpre支持子目录的检测．</li>
</ol>
<h3 id="2011-08-21_(变化比较大，请注意看更新说明，新的版本使用起来更加灵活．）">2011-08-21 (变化比较大，请注意看更新说明，新的版本使用起来更加灵活．）</h3>
<ol>
<li>菜单标题自动居中显示</li>
<li><p>cmd的语法改变</p>
<p>旧的版本<code>cmd=echo</code>要改成<code>cmd=&quot;echo %1&quot;</code></p>
<p>在批处理中调用需要使用<code>%%1</code><br>即，需要多一个<code>%1</code>的参数，这个参数用于接收文件参数．可以放在cmd参数的任意位置．<br>并且支持类拟<code>%~dpnx1</code>的格式．</p>
</li>
<li><p>新增<code>filpre</code>参数,指定文件名前辍.</p>
<p><del>注意:使用该参数时,<code>subdir</code>参数将不起作用,为了不影响其它情况下的检测速度,该参数只支持单级目录.</del></p>
</li>
</ol>
<h3 id="2011-08-16_更新:(新的版本处理的速度会慢一些,但精确度比较高,之前的版本会把带扩展名的目录当成文件显示在菜单上)">2011-08-16 更新:(新的版本处理的速度会慢一些,但精确度比较高,之前的版本会把带扩展名的目录当成文件显示在菜单上)</h3>
<ol>
<li><p>添加了一个参数root,指定要从哪个目录开始找.例子:</p>
<p>root=()/boot</p>
<p>从只找/BOOT目录下的文件,注:前面的()是必须的,你也可以指定一个磁盘,代表从这个磁盘的这个目录开始查找比如</p>
<p>root=(hd0,4)/boot</p>
<p>则先从(hd0,4)/boot目录下查找文件,</p>
<p>注:如果有带devs参数,必须确保上面的(hd0,4)磁盘有在在devs列表中.</p>
</li>
<li><p>支持查找无扩展名的文件(之前的版本无扩展名的全部被当成一个子目录对待)</p>
</li>
<li>新的ext参数只查找无扩展名的文件.<code>ext=.</code>会查找无扩展名的文件.</li>
<li>菜单的注释新增了文件大小的提示(因为新的版本使用cat —locate=0来检测是否一个文件,就顺便把这个也利用上了.)</li>
</ol>
<p>本模块支持的参数如下</p>
<ul>
<li><code>m.cmd</code>    指定每个菜单要执行的命令 ( 必须的其它的都是可选参数.)</li>
<li><code>m.title</code>     指定菜单标题</li>
<li><code>m.return</code>    指定返回命令</li>
<li><code>m.menu</code>    指定菜单位置(默认使用(md)0x210+16来存放菜单)</li>
<li><code>m.subdir</code>    指定要查找的目录级数,默认1</li>
<li><code>m.devs</code>    指定要查找的设备(find的参数)</li>
<li><code>m.init</code>     指定菜单的初始化命令</li>
<li><code>m.ext</code>    指定扩展名(用于过滤),多个扩展名用双引号每个扩展名之间用空格分隔<pre><code> 例: ext=&quot;.gho .txt&quot;
</code></pre></li>
<li><code>m.root</code>    指定根目录.(第一个被检查的目录)比如(hd0,4)/boot/或(hd0,5)<pre><code> 注：该参数和m.devs参数配合使用时，将会只查找以上路径下的文件．例子:
 指定m.root=(hd0,4)/boot 或/boot
 只会查找符合条件的磁盘/BOOT目录下的文件．
</code></pre></li>
<li><code>m.dirext</code>       是否检测带扩展名的目录,设为任意值即启用,默认禁用,<pre><code>  除非有必要,否则不建议使用,启动这个参数会使得检测的速度变得很慢.
</code></pre></li>
<li><code>m.filpre</code>　  指定文件名前辍,过滤非以filpre参数开头的文件.(测试)</li>
</ul>
<p>以下是使用的效果截图,欢迎反馈BUG或建议.(图片原链接已失效,以后再抽空重新弄)</p>
<ol>
<li><h3 id="当前分区,根目录">当前分区,根目录</h3>
</li>
<li><h3 id="当前分区,3级目录">当前分区,3级目录</h3>
</li>
<li><h3 id="当前分区,二级目录,">当前分区,二级目录,</h3>
</li>
<li><h3 id="二级目录,所有硬盘分区">二级目录,所有硬盘分区</h3>
</li>
<li><h3 id="2011-08-16更新的版本效果图-">2011-08-16更新的版本效果图.</h3>
</li>
</ol>
<pre><code class="bat">!BAT
setlocal
debug off
checkrange 20110918:-1 read 0x8278 || echo Please use grub4dos-0.4.5b-2011-09-18 or above! &amp;&amp; exit 1
if &quot;%1&quot;==&quot;&quot; goto :参数检测
set *
:获取参数
if /i &quot;%1&quot;==&quot;&quot; &amp;&amp; goto :参数检测
set m.%~1=%~2
shift 1
shift 1
goto :获取参数

:help
echo Usage: %0 cmd=&quot;cmd for each file&quot; OPTIONS..
echo OPTIONS:
echo -e \t title=&quot;the main menu title&quot;
echo -e \t menu=&quot;pre_set menu file&quot;
echo -e \t subdir=n
echo -e \t devs=&quot;find parameters&quot;
echo -e \t return=&quot;return cmd&quot;
echo -e \t init=&quot;init cmd&quot;
echo -e \t filpre=filepre
echo -e \t ext=fileext
echo -e \t root=&quot;root dir. e.g. ()/boot/&quot;
echo -e \n\t for more please visit http://chenall.net
exit

:菜单居中
set title=屯屯屯屯屯屯屯屯屯屯屯屯屯屯屯屯屯屯屯屯
set title=%title:~0,%1%%
exit

:参数检测
if not exist m.cmd &amp;&amp; goto :help
if not exist m.title &amp;&amp; set m.title=Please select a file
if not exist m.menu &amp;&amp; set m.menu=(md)0x210+16 &amp;&amp; echo -e default 1\ndebug off &gt; (md)0x210+16
if not exist m.subdir &amp;&amp; set m.subdir=1
if not exist m.devs &amp;&amp; set m.devs=--set-root
if not exist m.root &amp;&amp; set m.root=()
echo -e !BAT\necho %m.cmd% \&gt;\&gt; %m.menu% &gt; (md)0x260+4
::获取标题字符数量用于标题居中
set title=%m.title%
set /a title=68-*0x4CB00&gt;&gt;1
call :菜单居中 %title%
::自动生成菜单
set ?_n=1
set m.info=File list menu for grub4dos by chenall.\n\t\t for more information please visit http://chenall.net
if exist m.init &amp;&amp; echo %m.init% &gt;&gt; %m.menu%
echo title %title% %m.title% %title%\n\n\t%m.info% &gt;&gt; %m.menu%
echo pause %m.info% &gt;&gt; %m.menu%
echo -e $[0106] %m.info%
echo $[0102] Please wait ...
echo $[1105] Working......
root %m.root%
if exist m.debug echo %@time%
find %m.devs% call :生成文件列表 || echo Unknow Error.
if exist m.debug pause %@time%
echo title 屯屯屯屯屯屯屯屯屯屯屯屯屯屯屯屯屯 http://chenall.net 屯 2011-08-22 屯\n\n\t%m.info% &gt;&gt; %m.menu%
echo pause %m.info% &gt;&gt; %m.menu%
set ?_n=
if not exist m.return &amp;&amp; configfile %m.menu%
echo title   0. Return &gt;&gt;  %m.menu%
echo %m.return%  &gt;&gt; %m.menu%
echo boot &gt;&gt; %m.menu%
configfile %m.menu%
exit

:文件过滤
if &quot;%~1&quot;==&quot;&quot; exit
set tmp=%1
shift
if &quot;%tmp:~-2,1%&quot;==&quot;~&quot; &amp;&amp; goto :文件过滤
if &quot;%tmp:~0,1%&quot;==&quot;$&quot; &amp;&amp; goto :文件过滤
call :检测文件 %0
goto :文件过滤

:获取文件大小
calc *0x8290&gt;&gt;30 &amp;&amp; set size=30GB &amp;&amp; exit
calc *0x8290&gt;&gt;20 &amp;&amp; set size=20MB &amp;&amp; exit
calc *0x8290&gt;&gt;10 &amp;&amp; set size=10KB &amp;&amp; exit
set size=00B
exit

:检测文件
if exist m.debug1 &amp;&amp; echo %~f1
::检测前辍
call Fn.10 &quot;%m.filpre%&quot; &quot;%~n1&quot;
if &quot;%@retval%&quot;==&quot;1&quot; &amp;&amp; goto :检测目录
::检测后辍
if exist m.ext || goto :添加菜单
set f.type=%~x1
if not exist f.type set f.type=.
call :过滤 %m.ext% &amp;&amp; goto :添加菜单

:检测目录
if %m.subdir%==0 &amp;&amp; exit
if exist m.dirext || if &quot;%~x1&quot;==&quot;&quot; || exit
cat --length=0 /%1 &amp;&amp; exit
if exist m.debug2 &amp;&amp; echo $[0101] %~f1
goto :生成文件列表

:过滤
if &quot;%1&quot;==&quot;&quot; &amp;&amp; exit 1
shift
if /i &quot;%0&quot;==&quot;%f.type%&quot; || goto :过滤
exit

:添加菜单
cat --length=0 /%1 || goto :检测目录
call :获取文件大小
if exist m.debug3 &amp;&amp; echo $[0102] %~f1
calc *0x8290=*0x8290&gt;&gt;%size:~0,2%
set size=%@retval% %size:~2%
set m=1    %?_n%
echo title %m:~-3%. %~f1\n\n\t~%size% %~f1  &gt;&gt; %m.menu%
(md)0x260+4 %~f1
echo boot &gt;&gt; %m.menu%
set /a ?_n=%?_n%+1
exit

:生成文件列表
setlocal
if &quot;%~1&quot;==&quot;&quot; || root %~f1
set /a m.subdir=%m.subdir%-1
ls | call :文件过滤= || echo
endlocal
exit
</code></pre>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <div class="categories"style="display:inline">归类<span class="breadcrumb fa fa-folder"><li><a href="/categories/GRUB4DOS/" itemprop="url"><span itemprop="title" >GRUB4DOS</span></a></li><li><a href="/categories/GRUB4DOS/批处理/" itemprop="url">批处理</a></li></span></div> | <span class="tags">标签 <a href="/tags/GRUB4DOS/" class="label label-primary" itemprop="url"><span itemprop="title">GRUB4DOS</span></a><a href="/tags/批处理/" class="label label-success" itemprop="url"><span itemprop="title">批处理</span></a><a href="/tags/文件列表/" class="label label-info" itemprop="url"><span itemprop="title">文件列表</span></a><a href="/tags/模块/" class="label label-warning" itemprop="url"><span itemprop="title">模块</span></a><a href="/tags/原创/" class="label label-primary" itemprop="url"><span itemprop="title">原创</span></a></span> | <span class="time">最近更新:<time title="2014-02-26 19:52:59"datetime="2014-02-26 19:52:59"> 2014-02-26</time></span> | <span class="comment-link">
<a href="http://chenall.net/post/g4d_filelist/#comments" class="ds-thread-count comment-link" data-thread-key="754" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/post/grub4dos_replace/">[GRUB4DOS] 通用模块之字符串替换</a></h1>
      
        <span>发表于<time datetime="2011-08-17T05:12:30.000Z"> <a href="/post/grub4dos_replace/">2011-08-17</a></time></span>      
    </header>
    
    
    <div class="entry" >
      
        <p>本程序使用GRUB4DOS批处理编写.</p>
<p>实现了以下功能.</p>
<ol>
<li>替换某个变量中指定的字符串.</li>
<li>删除某个变量中指定的字符串.</li>
</ol>
<p>使用方法:</p>
<p>把脚本另存为REPLACE</p>
<p>然后直接调用</p>
<p>replace 变量名 字符串1 字符串2 [起始位置]</p>
<p>变量名是GRUB4DOS的一个变量,必须已经存在.因为替换的是这个变量的内容.</p>
<p>字符串1 查找指定字符串</p>
<p>字符串2 找到之后要替换的字符串.</p>
<pre><code>    起始位置是可选的,可以选择从指定字符开始进行替换.起始位置之前的字符不会被改变.默认是0.
</code></pre><p>如果需要的话可以直接集成到你的批处理中.只要把:replace标签(包含)之后的代码复制过去然后使用</p>
<p>call :replace 来调用就行了.</p>
<p>复制代码请点这里:</p>
<pre><code>!BAT
setlocal
debug off
if exist %1 goto :replace
echo $[0101] Replace module for grub4dos by chenall 2011-08-17
echo $[0101] replace the string $[0103]find $[0101]with string $[0103]replacewith$[0101] in VARIABLE name VAR
echo $[0102] usage:
echo $[0106]     replace VAR find replacewith [start]
echo $[0106]             VAR           a valid VARIABLE name(must defined).
echo $[0106]             find          the string that will be replaced.
echo $[0106]             replacewith   The replacement substring
echo $[0106]             start         Specifies the start. Default is 0.
echo
echo $[0104]  for more please visit $[0105]http://chenall.net/post/grub4dos_replace/
exit

:replace
if not exist %1 exit
echo %%%1%% &gt; (md)0x266+2
set skip=%2
set skip_l=%@retval%
set /a skip=%4
if %skip%==0 || cat (md)0x266+1,%skip% &gt;&gt; (md)0x267+1
:replace_loop
cat --locate=%2 --number=1 --skip=%skip% (md)0x266+1 | set n=
if not exist n goto :replace_ok
if %n%==0 || cat --skip=%skip% (md)0x266+1,%?% &gt;&gt; (md)0x267+1
set /a skip=0x%n%+%skip_l%
echo -n %~3 &gt;&gt; (md)0x267+1
goto :replace_loop
:replace_ok
cat --skip=%skip% (md)0x266+1 &gt;&gt; (md)0x267+1
cat (md)0x267+1 | set %1=
endlocal &amp;&amp; set %1=%%%1%%
</code></pre>
      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <div class="categories"style="display:inline">归类<span class="breadcrumb fa fa-folder"><li><a href="/categories/GRUB4DOS/" itemprop="url"><span itemprop="title" >GRUB4DOS</span></a></li><li><a href="/categories/GRUB4DOS/编程/" itemprop="url">编程</a></li></span></div> | <span class="tags">标签 <a href="/tags/GRUB4DOS/" class="label label-primary" itemprop="url"><span itemprop="title">GRUB4DOS</span></a><a href="/tags/批处理/" class="label label-success" itemprop="url"><span itemprop="title">批处理</span></a><a href="/tags/原创/" class="label label-info" itemprop="url"><span itemprop="title">原创</span></a></span> | <span class="time">最近更新:<time title="2014-02-26 19:52:59"datetime="2014-02-26 19:52:59"> 2014-02-26</time></span> | <span class="comment-link">
<a href="http://chenall.net/post/grub4dos_replace/#comments" class="ds-thread-count comment-link" data-thread-key="767" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/post/grub4dos_hdpart/">[GRUB4DOS] 通用模块之分区选择</a></h1>
      
        <span>发表于<time datetime="2011-08-09T08:07:36.000Z"> <a href="/post/grub4dos_hdpart/">2011-08-09</a></time></span>      
    </header>
    
    
    <div class="entry" >
      
        <p>通用Grub4dos硬盘分区选择接口模块,</p>
<p>供有需要的朋友使用.</p>
<p>可以在你的菜单中简单的加入一个分区选择模块.</p>
<p>要求:  必须使用2011-08-09以后发布的GRUB4DOS</p>
<p>使用方法:</p>
<p>首先复制代码另存为hd_part.lst<br>然后在你的批处理或菜单中直接调用.调用的方法有两种.</p>
<p>1.简单调用,直接在执行模块的时候加参数例子:<br><img src="http://photo.staticsdo.com/a1/486/458/0/60809-49499083-8.png" alt=""><br>效果图.根据你硬盘的分区情况列出菜单.</p>
<p><img src="http://photo.staticsdo.com/a1/422/278/391/60810-49499083-8.png" alt=""></p>
<p>2.如果你需要多次调用,建议使用此方法(先设置好需要的变量后再执行模块)<br>如实现上面的例子:</p>
<pre><code>set m.cmd=&quot;pause test cmd&quot;
set m.return=&quot;pause test return&quot;
hd_part.lst
</code></pre><p>注:使用方法1时,将不会使用变量参数即1,2不能混用.</p>
<pre><code class="bat">!BAT
::::通用Grub4dos硬盘分区选择接口模块.
::1.程序占用内存地址(md)0x20A+22
::2.首先设置好参数,然后直接执行本批处理调用.
::3.参数设置.(变量)m.cmd必须设置,其它的可选
::  m.cmd    选择指定分区时要执行的命令接口执行是附加参数分区号例 set m.cmd=echo时,执行(hd0,0)的菜单就相当于执行echo (hd0,0).
::  m.title  菜单主标题
::  m.return 返回菜单时要执行的命令(如果没有设置,则不会出现返回菜单)
::  m.init   菜单初始化脚本(自动生成的菜单title命令之前的内容)
::4.使用方法.两种方式,自己根据情况选择.
::    1.直接通过批处理传递以上参数(用批处理传递参数时不要加前面的m.)例:
::      hd_part.lst cmd=&quot;echo&quot; return=&quot;configfile (md)4+8&quot;
::    2.先设置变量再调用
::      set m.cmd=echo
::      set m.return=&quot;configfile (md)4+8&quot;
::      hd_part.lst
::
::    chenall 编写于 2011-08-09. http://chenall.net 
setlocal
debug off
checkrange 20110809:-1 read 0x8278 || echo Please use grub4dos-0.4.5b-2011-08-09 or above! &amp;&amp; exit 1
if &quot;%1&quot;==&quot;&quot; goto :参数检测
set *
::set m.cmd=
::set m.title=
::set m.init=
::set m.return=
:获取参数
if /i &quot;%1&quot;==&quot;&quot; &amp;&amp; goto :参数检测
set m.%~1=%~2
shift 1
shift 1
goto :获取参数

:参数检测
if not exist m.cmd exit 1
if not exist m.title set m.title=屯屯屯屯屯屯屯屯 Please select a partition 屯屯屯屯屯屯屯屯
set m.menu=(md)0x210+16
::自动生成菜单
echo default 1 &gt; %m.menu%
echo -e debug off\n%m.init% &gt;&gt; %m.menu%
echo title %m.title% &gt;&gt; %m.menu%
echo pause Partition list menu for grub4dos by chenall . http://chenall.net &gt;&gt; %m.menu%
set n=1
set skip=0
find --devices=h root &gt; (md)0x20A+6
call :分区信息
echo -e clear\ntitle 屯屯屯屯屯屯屯屯屯屯屯屯屯屯屯屯屯屯屯屯屯屯屯屯屯屯屯屯屯屯\npause Partition list menu for grub4dos by chenall . http://chenall.net  &gt;&gt; %m.menu%
if not exist m.return &amp;&amp; configfile %m.menu%
echo title  0. Return &gt;&gt;  %m.menu%
echo %m.return%  &gt;&gt;  %m.menu%
echo boot &gt;&gt; %m.menu%
configfile %m.menu%
exit

:分区信息
cat --locate=\xa --number=1 --skip=%skip% (md)0x20A+6 || exit
set /a length=%?%-%skip%
cat --skip=%skip% --length=%length% (md)0x20A+6 | call :add_list=
set /a skip=%length%+%skip%+1
goto :分区信息
:add_list
set m=1   %n%
echo title %m:~-2%. %* &gt;&gt; %m.menu%
echo %m.cmd% %1 &gt;&gt; %m.menu%
echo boot &gt;&gt; %m.menu%
set /a n=%n%+1
exit
</code></pre>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <div class="categories"style="display:inline">归类<span class="breadcrumb fa fa-folder"><li><a href="/categories/GRUB4DOS/" itemprop="url"><span itemprop="title" >GRUB4DOS</span></a></li><li><a href="/categories/GRUB4DOS/批处理/" itemprop="url">批处理</a></li></span></div> | <span class="tags">标签 <a href="/tags/GRUB4DOS/" class="label label-primary" itemprop="url"><span itemprop="title">GRUB4DOS</span></a><a href="/tags/批处理/" class="label label-success" itemprop="url"><span itemprop="title">批处理</span></a><a href="/tags/模块/" class="label label-info" itemprop="url"><span itemprop="title">模块</span></a><a href="/tags/原创/" class="label label-warning" itemprop="url"><span itemprop="title">原创</span></a></span> | <span class="time">最近更新:<time title="2014-02-26 19:52:59"datetime="2014-02-26 19:52:59"> 2014-02-26</time></span> | <span class="comment-link">
<a href="http://chenall.net/post/grub4dos_hdpart/#comments" class="ds-thread-count comment-link" data-thread-key="738" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>





<ul id="pagination" class="pagination pagination-lg">
  <li><a class="extend prev" rel="prev" href="/page/4/">&laquo;</a></li><li><a class="page-number" href="/">1</a></li><li><a class="page-number" href="/page/2/">2</a></li><li><a class="page-number" href="/page/4/">4</a></li><li class="active"><li><span class="page-number current">5</span></li></li><li><a class="page-number" href="/page/6/">6</a></li><li><a class="page-number" href="/page/7/">7</a></li><li><a class="page-number" href="/page/8/">8</a></li><li><span class="space">&hellip;</span></li><li><a class="page-number" href="/page/14/">14</a></li><li><a class="page-number" href="/page/15/">15</a></li><li><a class="extend next" rel="next" href="/page/6/">&raquo;</a></li>
  <div class="clearfix"></div>
</ul></div><!--wapper-->
       </div><!-- ID main-col END -->
       <aside id="sidebar" class="alignright col-sx-6 col-sm-4 col-md-3 col-lg-3">
<div id="widget_swiftype" class="widget panel panel-primary">
    
<form class="input-group">
<input type="text" id="st-search-input" class="form-control" placeholder="搜索" autocomplete="off" autocorrect="off" autocapitalize="off" style="outline: none;">
<span class="input-group-btn"><button class="btn btn-default" type="search"><i class="fa fa-search"></i></button></span>
</form></div>

<div id="widget_google_cse" class="widget panel panel-primary">
    
<gcse:searchbox-only defaultToRefinement="chenall.net" resultsUrl="/search/" newWindow="false"></gcse:searchbox-only>
</div>

<div id="widget_category" class="widget panel panel-primary">
  <div class="panel-heading">分类</div>  <div data-src='category' class='ajax_widgets'>正在加载...</div>
</div>

<div id="widget_latest_update_posts" class="widget panel panel-primary">
  <div class="panel-heading">最近更新</div>  <div data-src='latest_update_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_random_posts" class="widget panel panel-primary">
  <div class="panel-heading">随机文章</div>  <div class='hexo_random_posts' data-count=8></div></div>

<div id="widget_google_sidebar" class="widget panel panel-primary">
  <div class="panel-heading">赞助商</div>  
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0028617410393728"
     data-ad-slot="2577551260"
     data-ad-format="rectangle"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>

<div id="widget_tagcloud" class="widget panel panel-primary">
  <div class="panel-heading">标签云</div>  <div data-src='tagcloud' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_sina_weiboshow" class="widget panel panel-primary">
  <div class="panel-heading">新浪微搏秀</div>  <iframe width="100%" height="600" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=600&fansRow=0&ptype=0&speed=0&skin=5&isTitle=0&noborder=1&isWeibo=1&isFans=0&uid=1082888172&verifier=1a4946c5&dpc=1"></iframe>
</div>

<div id="widget_recent_comments" class="widget panel panel-primary">
  <div class="panel-heading">最近评论</div>  

<div class="list-group-item ds-recent-comments" data-num-items="6" data-show-avatars="1" data-show-time="1" data-show-title="1" data-show-admin="1" data-excerpt-length="50"></div>



</div>

</aside>
       <div class="clearfix"></div>
     </div><!-- row END -->
  </div>
  <footer id="footer" class="container">
  <div class="panel panel-info">
  <section id='footer_widget'></section>  <div class="panel-footer">
  <div id="site-info">
    <span class='author'>
  
  &copy; 2008-2015 chenall
  
    &nbsp;&nbsp;</span>
  <a href='http://www.miibeian.gov.cn/'>闽ICP备14002519号-1</a></span>
  <span id='analytics-51la'>
<script language="javascript" type="text/javascript" src="http://js.users.51.la/3214078.js"></script>
<noscript><a href="http://www.51.la/?3214078" target="_blank"><img alt="&#x6211;&#x8981;&#x5566;&#x514D;&#x8D39;&#x7EDF;&#x8BA1;" src="http://img.users.51.la/3214078.asp" style="border:none" /></a></noscript>
</span><span id='analytics-google'>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-30310093-1']);
  _gaq.push(['_trackPageview']);
  _js2load.push({src:('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'});
</script></span><span id='analytics-baidu'>
<script>
var _hmt = _hmt || [];
_js2load.push({src:"//hm.baidu.com/hm.js?41a3a9225fc0df0d53086baea0f90d96"});
</script>
</span>  </div>
  <div id="copyright">Blog powered by <a href='http://hexo.io/'  title="本站由hexo V2.8.3 生成"><strong>hexo</strong></a> Theme <strong><a href='https://github.com/chenall/hexo-theme-chenall'>chenall V2.2</a></strong><span class="pull-right"> 更新时间: <em>2015-06-28 17:20:54</em></span></div>
</div>
<div class="clearfix"></div>
  </div>
  </footer>
  
        <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>        
        <script src="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/js/bootstrap.min.js"></script>        
            <script type="text/javascript"> (function(win,doc){ var s = doc.createElement("script"), h = doc.getElementsByTagName("head")[0]; if (!win.alimamatk_show) { s.charset = "gbk"; s.async = true; s.src = "http://a.alimama.cn/tkapi.js"; h.insertBefore(s, h.firstChild); }; var o = { pid: "mm_14266497_2425855_13670245",}; win.alimamatk_onload = win.alimamatk_onload || []; win.alimamatk_onload.push(o); })(window,document);</script>    
                
            
<div id='swiftype-searchinfo' style='display: none;'><div class="alert alert-info"> 正在搜索中，稍后将在这里显示结果。。。。</div></div>
<script type="text/javascript">
var Swiftype = window.Swiftype || {key:'P473Cjp95e3bFhiCP88w',renderStyle: 'inline' };
_js2load.push({src:"//s.swiftypecdn.com/embed.js"});
$(function(){$('#main-col').prepend('<div id="st-results-container"></div>');$('form').has('#st-search-input').submit(function(){$('#st-results-container').html($('#swiftype-searchinfo').html());})});
</script>
    
            <script>_js2load.push({src:(document.location.protocol == 'https:' ? 'https:' : 'http:') + '//www.google.com/cse/cse.js?cx=013748367689400048621:dmsqkhtcvbm'});</script>
    
            <script type="text/javascript">
var duoshuoQuery = {short_name:"chenall"};
_js2load.push({src:'http://static.duoshuo.com/embed.js',charset:'UTF-8'});
</script>
    
        <script src="http://cdn.bootcss.com/prettify/r298/prettify.min.js"></script>    <script type="text/javascript">
   var lang=["bsh", "c", "cc", "cpp", "cs", "csh", "cyc", "cv", "htm", "html",
    "java", "js", "m", "mxml", "perl", "pl", "pm", "py", "rb", "sh",
    "xhtml", "xml", "xsl"];
   var pretty_base='';
   $('script').each(function(){
	var c = $(this).attr('src');
	if (!c)
	    return;
	if (c.match(/(\/)?prettify(\.min)?\.js/i))
	{
	    var index = c.lastIndexOf('/');
	    if (index != -1)
		pretty_base = c.substr(0,index + 1);
	    return false;
	}
   })
   $('pre code').each(function(){
	var c = $(this).attr('class')
	if (!c)
	    return;
	c = c.match(/\s?(lang\-\w+)/i);
	if (c && lang.indexOf(c[1]) == -1)
	{
	    lang.push(c[1]);
	    $.getScript(pretty_base + c[1] + '.min.js');
	}
   })

    $(window).load(function(){
       $("pre").addClass("prettyprint");
       prettyPrint();
    })
</script>    
        <script src="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js"></script>    <script type="text/javascript">
(function($){
  $('.entry').each(function(i){
    $(this).find('img').each(function(){
      var alt = this.alt;
      var imgsrc = /^.+?(png|bmp|jpeg)/.exec(this.src);

      $(this).wrap('<a href="' + (imgsrc?imgsrc[0]:this.src) + '" title="' + alt + '" class="fancybox" rel="fancybox' + i + '" />').wrap('<div class="img_block"></div>');
     
      if(alt){$(this).after('<span class="caption">' + alt + '</span>')};
    });
  });

  $('.fancybox').fancybox();
})(jQuery);
</script>    
<script src="/js/chenall.js" type="text/javascript"></script>

  <!--addons at end of body-->
</body>
</html>
